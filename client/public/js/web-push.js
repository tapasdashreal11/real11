"use strict";$(function(){function e(e){return"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?void console.log("The user has blocked notifications."):"PushManager"in window?void($("#account-id").val()&&(console.log("#account-id"),e.pushManager.getSubscription().then(function(o){console.log(o),o?i(o):t(e)})["catch"](function(e){console.warn("Error during getSubscription()",e)}))):void console.log("Push messaging isn't supported."):void console.log("Notifications aren't supported.")}function o(e){for(var o="=".repeat((4-e.length%4)%4),n=(e+o).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(n),t=new Uint8Array(i.length),r=0;r<i.length;++r)t[r]=i.charCodeAt(r);return t}function n(e,n){e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o(n||r)}).then(function(e){return console.log("subscribe"),console.log(e),i(e)})["catch"](function(e){console.log(e)})}function i(e){$.ajax({url:"/registerDevice",method:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({device_type:"web-browser",deviceData:e}),dataType:"json"})}function t(e){$.ajax({url:"/notification/getVapidpublickey",method:"GET",contentType:"application/json; charset=utf-8",dataType:"json"}).then(function(o){console.log("getPublicVapidKey"),console.log(o),o.publicVapidKey&&n(e,o.publicVapidKey)})}"serviceWorker"in navigator?navigator.serviceWorker.register("/js/service-worker.js").then(e)["catch"](function(e){console.log(e)}):console.log("Service workers aren't supported in this browser.");var r="BNSrScg_E1hM7rhwlD-CJJT-VzDMhy3f4Y29VUSyitR8L2usjlBJIJwne_Bu4NhiuC9nhYHQ4JHUXnRnOrTUk2A"});
//# sourceMappingURL=web-push.js.map
