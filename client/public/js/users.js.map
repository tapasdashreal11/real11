{"version":3,"sources":["users.js"],"names":["validateEmail","email","re","test","validatePhone","phone","regexUSPhoneNumber","RegExp","$","document","ready","on","html","submit","event","trim","val","error","focus","preventDefault","hide","find","value","this","length","prop","userId","code","linkReset","ajax","url","method","dataType","contentType","data","JSON","stringify","success","link","window","location","href","show","message","console","registration","toastr"],"mappings":"AAAA,YA4GA,SAASA,eAAcC,GACnB,GAAIC,GAAK,wJACT,OAAOA,GAAGC,KAAKF,GAGnB,QAASG,eAAcC,GACnB,GAAIC,GAAqB,GAAIC,QAAO,8DACpC,OAAOD,GAAmBH,KAAKE,GAnHnCG,EAAEC,UAAUC,MAAM,WACdF,EAAE,UAAUG,GAAG,QAAS,WACpBH,EAAE,gBAAgBI,KAAK,MAE3BJ,EAAE,UAAUG,GAAG,QAAS,WACpBH,EAAE,gBAAgBI,KAAK,MAG3BJ,EAAE,sBAAuBK,OAAO,SAAUC,GACtC,GAAMb,GAAQO,EAAEO,KAAKP,EAAE,UAAUQ,OAC3BX,EAAQG,EAAEO,KAAKP,EAAE,UAAUQ,OAC7BC,GAAQ,CACRhB,IAAUI,IACVY,GAAQ,EACRT,EAAE,UAAUU,SAEbjB,IACKD,cAAcC,KAClBgB,GAAQ,EACRT,EAAE,gBAAgBI,KAAK,2BAGxBP,IACKD,cAAcC,KAClBY,GAAQ,EACRT,EAAE,gBAAgBI,KAAK,0BAGxBK,GACCH,EAAMK,mBAGdX,EAAE,iBAAiBG,GAAG,QAAS,WAC3BH,EAAE,qBAAqBY,OAAOC,KAAK,KAAKT,KAAK,GAC7C,IAAMU,GAAQd,EAAEe,MAAMP,KACnBM,IAA0B,IAAjBA,EAAME,OACdhB,EAAE,gBAAgBiB,KAAK,YAAa,GAEpCjB,EAAE,gBAAgBiB,KAAK,YAAa,KAI5CjB,EAAE,gBAAgBG,GAAG,QAAS,WAC1B,GAAMN,GAAQG,EAAE,mBAAmBQ,MAC7BU,EAASlB,EAAE,gBAAgBQ,MAC3BW,EAAOnB,EAAE,iBAAiBQ,MAC1BY,EAAYpB,EAAE,eAAeQ,KACnCR,GAAE,gBAAgBiB,KAAK,YAAY,GAChCE,GAAwB,IAAhBA,EAAKH,OACZhB,EAAEqB,MACEC,IAAK,sBACLC,OAAQ,OACRC,SAAU,OACVC,YAAa,kCACbC,KAAMC,KAAKC,WAAYT,KAAMA,EAAMtB,MAAOA,EAAOqB,OAAQA,IACzDW,QAAU,SAASH,GACZA,GAAQA,EAAKG,SAAWH,EAAKI,KACzBV,EACCW,OAAOC,SAASC,KAAOb,EAEvBW,OAAOC,SAASC,KAAOP,EAAKI,KAGhC9B,EAAE,qBAAqBkC,OAAOrB,KAAK,KAAKT,KAAKsB,EAAKS,SAAW,oBAEjEnC,EAAE,gBAAgBiB,KAAK,YAAY,IAEvCR,MAAO,SAASA,GACZ2B,QAAQ3B,MAAMA,OAItBT,EAAE,gBAAgBiB,KAAK,YAAY,GACnCjB,EAAE,qBAAqBkC,OAAOrB,KAAK,KAAKT,KAAK,sBAIrDJ,EAAE,gBAAgBG,GAAG,QAAS,WAC1BH,EAAE,gBAAgBI,KAAK,+CACvBJ,EAAE,gBAAgBiB,KAAK,YAAY,EACnC,IAAMG,KAAYpB,EAAE,eAAeQ,OAAe,GAC5CX,EAAQG,EAAE,mBAAmBQ,KAChCX,IACCG,EAAEqB,MACEC,IAAK,uBACLC,OAAQ,OACRC,SAAU,OACVC,YAAa,kCACbC,KAAMC,KAAKC,WAAY/B,MAAOA,EAAOwC,aAAcjB,IACnDS,QAAU,SAASH,GACZA,GAAQA,EAAKG,QACZS,OAAOT,QAAQH,EAAKS,SAEpBG,OAAO7B,MAAMiB,EAAKS,SAAL,sCAAsDtC,GAEvEG,EAAE,gBAAgBI,KAAK,cACvBJ,EAAE,gBAAgBiB,KAAK,YAAY,IAEvCR,MAAO,SAASA,GACZ2B,QAAQ3B,MAAMA,GACdT,EAAE,gBAAgBI,KAAK,cACvBJ,EAAE,gBAAgBiB,KAAK,YAAY,GACnCqB,OAAO7B,MAAM","file":"users.js","sourcesContent":["$(document).ready(function () {\n    $('#email').on('keyup', function() {\n        $('#error-email').html('');\n    })\n    $('#phone').on('keyup', function() {\n        $('#error-phone').html('');\n    })\n\n    $(\"#form-registration\" ).submit(function( event ) {\n        const email = $.trim($('#email').val());\n        const phone = $.trim($('#phone').val());\n        let error = false;\n        if(!email && !phone) {\n            error = true;\n            $('#email').focus();\n        }\n        if(email) {\n            if(!validateEmail(email)) {\n            error = true;\n            $('#error-email').html('Invalid email address');\n            }\n        }\n        if(phone) {\n            if(!validatePhone(phone)) {\n            error = true;\n            $('#error-phone').html('Invalid phone number');\n            }\n        }\n        if(error) {\n            event.preventDefault();\n        }\n    });\n    $('#code-confirm').on('keyup', function() {\n        $('#alert-valid-code').hide().find('p').html('');\n        const value = $(this).val();\n        if(value && value.length === 4) {\n            $('#btn-confirm').prop('disabled',  false);\n        } else {\n            $('#btn-confirm').prop('disabled',  true);\n        }\n    })\n\n    $('#btn-confirm').on('click', function() {\n        const phone = $('#phone-register').val();\n        const userId = $('#id-register').val();\n        const code = $('#code-confirm').val();\n        const linkReset = $('#link-reset').val();\n        $('#btn-confirm').prop('disabled', true);\n        if(code && code.length === 4) {\n            $.ajax({\n                url: '/users/confirm/code',\n                method: 'POST',\n                dataType: 'json',\n                contentType: \"application/json; charset=utf-8\",\n                data: JSON.stringify({ code: code, phone: phone, userId: userId }),\n                success : function(data) {\n                    if(data && data.success && data.link) {\n                        if(linkReset) {\n                            window.location.href = linkReset;\n                        } else {\n                            window.location.href = data.link; \n                        }\n                    } else {\n                        $('#alert-valid-code').show().find('p').html(data.message || 'Code not corret!');\n                    }\n                    $('#btn-confirm').prop('disabled', false);\n                },\n                error: function(error){\n                    console.error(error)\n                }\n            })\n        } else {\n            $('#btn-confirm').prop('disabled', false);\n            $('#alert-valid-code').show().find('p').html('Code not exists');\n        }\n    })\n\n    $('#btn-send-to').on('click', function() {\n        $('#btn-send-to').html('<i class=\"fa fa-spinner fa-spin fa-fw\"></i>');\n        $('#btn-send-to').prop('disabled', true);\n        const linkReset = $('#link-reset').val() ? true : '';\n        const phone = $('#phone-register').val();\n        if(phone) {\n            $.ajax({\n                url: '/users/confirm/reset',\n                method: 'POST',\n                dataType: 'json',\n                contentType: \"application/json; charset=utf-8\",\n                data: JSON.stringify({ phone: phone, registration: linkReset }),\n                success : function(data) {\n                    if(data && data.success) {\n                        toastr.success(data.message);\n                    } else {\n                        toastr.error(data.message || `We cannot send sms to phone number ${phone}`);\n                    }\n                    $('#btn-send-to').html('send again');\n                    $('#btn-send-to').prop('disabled', false);\n                },\n                error: function(error){\n                    console.error(error)\n                    $('#btn-send-to').html('send again');\n                    $('#btn-send-to').prop('disabled', false);\n                    toastr.error(\"We couldn't send to the server!\");\n                }\n            })\n        }\n    })\n})\nfunction validateEmail(email) {\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n}\n\nfunction validatePhone(phone) {\n    let regexUSPhoneNumber = new RegExp(/^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/im);\n    return regexUSPhoneNumber.test(phone)\n}"]}