{"version":3,"sources":["summernote.js"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","global","factory","exports","module","require","define","amd","jQuery","undefined","$$1","eq","itemA","itemB","eq2","peq2","propName","ok","fail","not","f","apply","arguments","and","fA","fB","item","self","a","invoke","method","uniqueId","prefix","id","idCounter","rect2bnd","rect","$document","$","document","top","scrollTop","left","scrollLeft","width","right","height","bottom","invertObject","inverted","key","hasOwnProperty","namespaceToCamel","namespace","split","map","name","substring","toUpperCase","join","debounce","func","wait","immediate","timeout","_this","this","context","args","later","callNow","clearTimeout","setTimeout","head","array","last","length","initial","slice","tail","find","pred","idx","len","all","indexOf","inArray","contains","sum","fn","reduce","memo","v","from","collection","result","isEmpty$1","clusterBy","aTail","aLast","compact","aResult","push","unique","results","next","prev","isFontInstalled","fontName","testFontName","$tester","css","position","fontSize","text","appendTo","body","originalWidth","remove","isEditable","node","hasClass","isControlSizing","makePredByNodeName","nodeName","isText","nodeType","isElement","isVoid","test","isPara","isHeading","isPurePara","isLi","isInline","isBodyContainer","isList","isHr","isTable","isBlockquote","isData","isCell","isParaInline","ancestor","isBodyInline","isClosestSibling","nodeA","nodeB","nextSibling","previousSibling","withClosestSiblings","siblings","nodeLength","nodeValue","childNodes","isEmpty","innerHTML","blankHTML","lists","paddingBlankHTML","parentNode","singleChildAncestor","listAncestor","ancestors","el","lastAncestor","filter","commonAncestor","n","listPrev","nodes","listNext","listDescendant","descendants","fnWalk","current","wrap","wrapperName","parent","wrapper","insertBefore","appendChild","insertAfter","preceding","appendChildNodes","aChild","each","child","isLeftEdgePoint","point","offset","isRightEdgePoint","isEdgePoint","isLeftEdgeOf","isRightEdgeOf","isLeftEdgePointOf","isRightEdgePointOf","hasChildren","prevPoint","isSkipInnerOffset","nextPoint","isSamePoint","pointA","pointB","isVisiblePoint","leftNode","rightNode","prevPointUntil","nextPointUntil","isCharPoint","ch","charAt","NBSP_CHAR","walkPoint","startPoint","endPoint","handler","isSkipOffset","makeOffsetPath","reverse","fromOffsetPath","offsets","i","splitNode","options","isSkipPaddingBlankHTML","isNotSplitEdgePoint","splitText","childNode","clone","cloneNode","splitTree","root","splitPoint","splitRoot","container","topAncestor","pivot","create","createElement","createText","createTextNode","isRemoveChild","removeNode","removeChild","removeWhile","replace","newNode","style","cssText","value","$node","stripLinebreaks","val","isTextarea","html","isNewlineOnBlock","markup","regexTag","match","endSlash","isEndOfInlineContainer","isBlockNode","trim","posFromPlaceholder","placeholder","$placeholder","pos","outerHeight","attachEvents","events","Object","keys","forEach","on","detachEvents","off","isCustomStyleTag","classList","textRangeToPoint","textRange","isStart","prevContainer","parentElement","tester","createTextRange","dom","moveToElementText","compareEndPoints","textRangeStart","curTextNode","collapse","firstChild","pointTester","duplicate","setEndPoint","textCount","cont","pointToTextRange","textRangeInfo","isCollapseToStart","prevTextNodes","collapseToStart","info","moveStart","readFileAsDataURL","file","Deferred","deferred","extend","FileReader","onload","e","dataURL","target","resolve","onerror","err","reject","readAsDataURL","promise","createImage","url","$img","one","detach","display","attr","browserVersion","Renderer","children","callback","render","$parent","contents","className","addClass","data","k","click","$container_1","append","renderer","isArray","editor","toolbar","editingArea","codable","editable","statusbar","airEditor","airEditable","buttonGroup","dropdown","items","content","template","option","dataValue","dataOption","dropdownButtonContents","icon","icons","caret","dropdownCheck","checkClassName","palette","row","rowSize","colors","eventName","buttons","col","colSize","color","tooltip","trigger","placement","dialog","fade","title","footer","popover","direction","hideArrow","hide","checkbox","checked","iconClassName","tagName","ui","button","toggleBtn","$btn","isEnable","toggleClass","toggleBtnActive","isActive","onDialogShown","$dialog","onDialogHidden","showDialog","modal","hideDialog","createLayout","$note","$editor","airMode","note","removeLayout","layoutInfo","show","isSupportAmd","userAgent","navigator","isMSIE","matches","exec","parseFloat","isEdge","hasCodeMirror","window","CodeMirror","__webpack_require__","specified","isSupportTouch","MaxTouchPoints","msMaxTouchPoints","inputEventName","env","isMac","appVersion","isFF","isPhantom","isWebkit","isChrome","isSafari","jqueryVersion","jquery","isW3CRangeSupport","createRange","String","fromCharCode","ZERO_WIDTH_NBSP_CHAR","isPre","isAnchor","isBody","blank","emptyPara","isBlock","isDiv","isBR","isSpan","isB","isU","isS","isI","isImg","isEmptyAnchor","summernote","lang","en-US","font","bold","italic","underline","clear","strikethrough","subscript","superscript","size","image","insert","resizeFull","resizeHalf","resizeQuarter","floatLeft","floatRight","floatNone","shapeRounded","shapeCircle","shapeThumbnail","shapeNone","dragImageHere","dropImage","selectFromFiles","maximumFileSize","maximumFileSizeError","original","video","videoLink","providers","link","unlink","edit","textToDisplay","openInNewWindow","table","addRowAbove","addRowBelow","addColLeft","addColRight","delRow","delCol","delTable","hr","p","blockquote","pre","h1","h2","h3","h4","h5","h6","unordered","ordered","help","fullscreen","codeview","paragraph","outdent","indent","center","justify","recent","more","background","foreground","transparent","setTransparent","reset","resetToDefault","shortcut","shortcuts","close","textFormatting","action","paragraphFormatting","documentStyle","extraKeys","insertParagraph","undo","redo","tab","untab","removeFormat","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","formatPara","formatH1","formatH2","formatH3","formatH4","formatH5","formatH6","insertHorizontalRule","linkDialog.show","history","specialChar","select","KEY_MAP","BACKSPACE","TAB","ENTER","SPACE","DELETE","LEFT","UP","RIGHT","DOWN","NUM0","NUM1","NUM2","NUM3","NUM4","NUM5","NUM6","NUM7","NUM8","B","E","I","J","K","L","R","S","U","V","Y","Z","SLASH","LEFTBRACKET","BACKSLASH","RIGHTBRACKET","isEdit","keyCode","isMove","nameFromCode","code","WrappedRange","sc","so","ec","eo","isOnEditable","makeIsOn","isOnList","isOnAnchor","isOnCell","isOnData","nativeRange","w3cRange","setStart","setEnd","getPoints","getStartPoint","getEndPoint","nativeRng","selection","getSelection","rangeCount","removeAllRanges","addRange","scrollIntoView","offsetTop","Math","abs","normalize","getVisiblePoint","isLeftToRight","block","isCollapsed","includeAncestor","fullyContains","leftEdgeNodes","expand","startAncestor","endAncestor","boundaryPoints","isSameContainer","deleteContents","rng","emptyParents","wrapBodyInlineWithPara","inlineSiblings","concat","para","insertNode","pasteHTML","contentsContainer","toString","getWordRange","findAfter","bookmark","s","path","paraBookmark","paras","getClientRects","range","wrappedRange","createFromSelection","createFromNode","anchorNode","getRangeAt","startContainer","startOffset","endContainer","endOffset","textRangeEnd","isTextNode","createFromNodeBefore","createFromNodeAfter","createFromBookmark","createFromParaBookmark","History","$editable","stack","stackOffset","makeSnapshot","emptyBookmark","applySnapshot","snapshot","rewind","recordUndo","Style","jQueryCSS","$obj","propertyNames","result_1","propertyName","fromNode","properties","styleInfo","parseInt","stylePara","styleNodes","expandClosestSibling","onlyPartialContains","nodesInRange_1","tails","elem","$cont","font-bold","queryCommandState","font-italic","font-underline","font-subscript","font-superscript","font-strikethrough","font-family","queryCommandValue","orderedTypes","isUnordered","lineHeight","toFixed","anchor","Bullet","toggleList","clustereds","wrapList","releaseList","listName","wrappedParas_1","diffLists","listNode","prevList","nextList","isEscapseToBody","releasedParas","headList","lastList","middleList","rootLists","rootList","listNodes","Typing","bullet","insertTab","tabsize","Array","nextPara","emptyAnchors","TableResultAction","where","domTable","setStartPoint","toLowerCase","console","error","_startPoint","colPos","cellIndex","rowPos","rowIndex","setVirtualTablePosition","baseRow","baseCell","isRowSpan","isColSpan","isVirtualCell","objPosition","isVirtual","_virtualTable","getActionCell","virtualTableCellObj","resultAction","virtualRowPosition","virtualColPosition","virtualTable","recoverCellIndex","newCellIndex","addCellInfoToVirtual","cell","cellHasColspan","colSpan","cellHasRowspan","rowSpan","isThisSelectedCell","rowspanNumber","attributes","rp","rowspanIndex","adjustStartPoint","colspanNumber","cp","cellspanIndex","isSelectedCell","createVirtualTable","rows","cells","getDeleteResultActionToCell","Column","SubtractSpanCount","Row","AddCell","RemoveCell","getAddResultActionToCell","SumSpanCount","Ignore","init","_actionCellList","getActionList","fixedRow","fixedCol","actualPosition","canContinue","rowPosition","colPosition","requestAction","Add","Delete","Table","isShift","nextCell","addRow","currentTr","closest","trAttributes","recoverAttributes","vTable","actions","idCell","currentCell","tdAttributes","baseCellTr","isTopFromRowSpan","newTd","removeAttr","setAttribute","before","lastTrIndex","after","addCol","rowsGroup","actionIndex","resultStr","attrList","deleteRow","cellPos","index","virtualPosition","hasRowspan","nextRow","cloneRow","removeAttribute","deleteCol","hasColspan","createTable","colCount","rowCount","tdHTML","tds","idxCol","trHTML","trs","idxRow","$table","tableClassName","deleteTable","KEY_BOGUS","Editor","langInfo","lastRange","typing","commands","sCmd","beforeCommand","execCommand","afterCommand","wrapCommand","fontStyling","formatBlock","isLimited","insertText","textNode","$target","onApplyCustomStyle","callbacks","call","onFormatBlock","hrNode","createLink","linkInfo","linkUrl","linkText","isNewWindow","isTextChanged","onCreateLink","anchors","startRange","endRange","colorInfo","foreColor","backColor","insertTable","dim","dimension","removeMedia","restoreTarget","triggerEvent","floatMe","resize","initialize","event","isDefaultPrevented","handleKeyMap","preventDefaultEditableShortCuts","outerWidth","maxHeight","minHeight","destroy","keyMap","metaKey","ctrlKey","altKey","shiftKey","keyName","preventDefault","pad","maxTextLength","focus","saveRange","thenCollapse","restoreRange","saveTarget","clearTarget","removeData","currentStyle","styleFromNode","isPreventTrigger","tabSize","insertImage","src","param","then","$image","min","insertImages","files","filename","maximumImageFileSize","insertImagesOrCallback","onImageUpload","getSelectedText","currentRange","spans","firstSpan","getLinkInfo","$anchor","resizeTo","bKeepRatio","imageSize","newRatio","y","x","ratio","hasFocus","is","empty","Clipboard","pasteByEvent","bind","clipboardData","originalEvent","kind","type","getAsFile","Dropzone","$eventListener","documentEventHandlers","$dropzone","prependTo","disableDragAndDrop","onDrop","attachDragAndDropEvent","$dropzoneMessage","onDragenter","isCodeview","hasEditorSize","add","onDragleave","removeClass","dataTransfer","types","getData","substr","cm","CodeView","$codable","sync","isActivated","save","toggle","deactivate","activate","prettifyHtml","cmEditor_1","fromTextArea","codemirror","tern","server_1","TernServer","ternServer","updateArgHints","getValue","setSize","cmEditor","toTextArea","isChange","EDITABLE_PADDING","Statusbar","$statusbar","disableResizeEditor","stopPropagation","editableTop","onMouseMove","clientY","minheight","max","Fullscreen","$toolbar","$window","$scrollbar","onResize","h","setsize","isFullscreen","Handle","$editingArea","summernote.mousedown","we","update","summernote.keyup summernote.scroll summernote.change summernote.dialog.shown","summernote.disable","summernote.codeview.toggled","$handle","disableResizeImage","$target_1","posStart_1","scrollTop_1","onMouseMove_1","clientX","isDisabled","isImage","$selection","w","origImageObj","Image","sizingText","defaultScheme","linkPattern","AutoLink","summernote.keyup","handleKeyup","summernote.keydown","handleKeydown","lastWordRange","keyword","wordRange","AutoSync","summernote.change","shouldInitialize","Placeholder","summernote.init summernote.change","isShow","Buttons","invertedKeyMap","representShortcut","editorMethod","o","addToolbarButtons","addImagePopoverButtons","addLinkPopoverButtons","addTablePopoverButtons","fontInstalledMap","fontNamesIgnoreCheck","isFontDeservedToAdd","genericFamilies","magic","styleTags","tag","createInvokeHandler","_loop_1","styleIdx","styleLen","this_1","createInvokeHandlerAndUpdateState","eraser","fontname","fontNames","menuCheck","fontSizes","$button","currentTarget","$recentColor","$dropdown","$holder","$color","$currentButton","unorderedlist","orderedlist","alignLeft","alignCenter","alignRight","alignJustify","textHeight","lineHeights","$catcher","insertTableMaxSize","mousedown","tableMoveHandler","picture","minus","arrowsAlt","question","trash","rowAbove","rowBelow","colBefore","colAfter","rowRemove","colRemove","build","$container","groups","groupIdx","groupLen","group","groupName","$group","btn","updateCurrentStyle","updateBtnStates",".note-btn-bold",".note-btn-italic",".note-btn-underline",".note-btn-subscript",".note-btn-superscript",".note-btn-strikethrough","fontName_1","$item","isChecked","fontSize_1","lineHeight_1","infos","selector","posOffset","PX_PER_EM","$picker","$dimensionDisplay","$highlighted","$unhighlighted","offsetX","posCatcher","pageX","pageY","offsetY","c","ceil","r","Toolbar","followScroll","toolbarContainer","changeContainer","followingToolbar","$toolbarWrapper","editorHeight","editorWidth","toolbarHeight","otherBarHeight","otherStaticBar","currentOffset","editorOffsetTop","editorOffsetBottom","activateOffset","deactivateOffsetBottom","updateFullscreen","updateCodeview","isIncludeCodeview","LinkDialog","$body","dialogsInBody","disableLinkTarget","buttonClass","dialogsFade","bindEnterKey","$input","toggleLinkBtn","$linkBtn","$linkText","$linkUrl","showLinkDialog","$openInNewWindow","handleLinkTextUpdate","handleLinkUrlUpdate","linkTargetBlank","prop","state","LinkPopover","summernote.keyup summernote.mouseup summernote.change summernote.scroll","summernote.disable summernote.dialog.shown","$popover","$content","prepend","href","ImageDialog","imageLimitation","unit","floor","log","readableSize","pow","showImageDialog","$imageInput","$imageUrl","$imageBtn","replaceWith","ImagePopover","posEditor","popatmouse","TablePopover","summernote.keyup summernote.scroll summernote.change","VideoDialog","createVideoNode","$video","ytRegExp","ytMatch","igRegExp","igMatch","vRegExp","vMatch","vimRegExp","vimMatch","dmRegExp","dmMatch","youkuRegExp","youkuMatch","qqRegExp","qqMatch","qqRegExp2","qqMatch2","mp4RegExp","mp4Match","oggRegExp","oggMatch","webmRegExp","webmMatch","youtubeId","vid","showVideoDialog","$videoUrl","$videoBtn","HelpDialog","createShortcutList","max-height","overflow","command","$row","margin-right","showHelpDialog","AIR_MODE_POPOVER_X_OFFSET","AirPopover","summernote.keyup summernote.mouseup summernote.scroll","summernote.disable summernote.change summernote.dialog.shown","summernote.focusout","relatedTarget","air","bnd","POPOVER_DIST","HintPopover","hint","hintDirection","hints","selectItem","innerHeight","moveDown","$current","$next","$nextGroup","first","moveUp","$prev","$prevGroup","nodeFromItem","createItemTemplates","hintIdx","searchKeyword","search","createGroup","keyword_1","Context","memos","modules","_initialize","_destroy","disabled","disable","plugins","initializeModule","removeModule","removeMemo","enable","ModuleClass","withoutIntialize","splits","hasSeparator","moduleName","methodName","isExternalAPICalled","hasInitOptions","version","clipboard","dropzone","handle","hintPopover","autoLink","autoSync","linkDialog","linkPopover","imageDialog","imagePopover","tablePopover","videoDialog","helpDialog","airPopover","styleWithSpan","textareaAutoSync","onInit","onFocus","onBlur","onBlurCodeview","onEnter","onKeyup","onKeydown","onImageUploadError","mode","htmlMode","lineNumbers","pc","CTRL+Z","CTRL+Y","SHIFT+TAB","CTRL+B","CTRL+I","CTRL+U","CTRL+SHIFT+S","CTRL+BACKSLASH","CTRL+SHIFT+L","CTRL+SHIFT+E","CTRL+SHIFT+R","CTRL+SHIFT+J","CTRL+SHIFT+NUM7","CTRL+SHIFT+NUM8","CTRL+LEFTBRACKET","CTRL+RIGHTBRACKET","CTRL+NUM0","CTRL+NUM1","CTRL+NUM2","CTRL+NUM3","CTRL+NUM4","CTRL+NUM5","CTRL+NUM6","CTRL+ENTER","CTRL+K","mac","CMD+Z","CMD+SHIFT+Z","CMD+B","CMD+I","CMD+U","CMD+SHIFT+S","CMD+BACKSLASH","CMD+SHIFT+L","CMD+SHIFT+E","CMD+SHIFT+R","CMD+SHIFT+J","CMD+SHIFT+NUM7","CMD+SHIFT+NUM8","CMD+LEFTBRACKET","CMD+RIGHTBRACKET","CMD+NUM0","CMD+NUM1","CMD+NUM2","CMD+NUM3","CMD+NUM4","CMD+NUM5","CMD+NUM6","CMD+ENTER","CMD+K","align","circle","frame","pencil","square"],"mappings":"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","file":"summernote.js","sourcesContent":["/**\n * Super simple wysiwyg editor v0.8.9\n * https://summernote.org\n *\n * Copyright 2013- Alan Hong. and other contributors\n * summernote may be freely distributed under the MIT license.\n *\n * Date: 2017-12-25T06:39Z\n */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :\n\ttypeof define === 'function' && define.amd ? define(['jquery'], factory) :\n\t(factory(global ? (global.jQuery || jQuery) : jQuery ));\n}(this, (function ($$1) { 'use strict';\n\n$$1 = $$1 && $$1.hasOwnProperty('default') ? $$1['default'] : $$1;\n\nvar Renderer = /** @class */ (function () {\n    function Renderer(markup, children, options, callback) {\n        this.markup = markup;\n        this.children = children;\n        this.options = options;\n        this.callback = callback;\n    }\n    Renderer.prototype.render = function ($parent) {\n        var $node = $$1(this.markup);\n        if (this.options && this.options.contents) {\n            $node.html(this.options.contents);\n        }\n        if (this.options && this.options.className) {\n            $node.addClass(this.options.className);\n        }\n        if (this.options && this.options.data) {\n            $$1.each(this.options.data, function (k, v) {\n                $node.attr('data-' + k, v);\n            });\n        }\n        if (this.options && this.options.click) {\n            $node.on('click', this.options.click);\n        }\n        if (this.children) {\n            var $container_1 = $node.find('.note-children-container');\n            this.children.forEach(function (child) {\n                child.render($container_1.length ? $container_1 : $node);\n            });\n        }\n        if (this.callback) {\n            this.callback($node, this.options);\n        }\n        if (this.options && this.options.callback) {\n            this.options.callback($node);\n        }\n        if ($parent) {\n            $parent.append($node);\n        }\n        return $node;\n    };\n    return Renderer;\n}());\nvar renderer = {\n    create: function (markup, callback) {\n        return function () {\n            var options = typeof arguments[1] === 'object' ? arguments[1] : arguments[0];\n            var children = $$1.isArray(arguments[0]) ? arguments[0] : [];\n            if (options && options.children) {\n                children = options.children;\n            }\n            return new Renderer(markup, children, options, callback);\n        };\n    }\n};\n\nvar editor = renderer.create('<div class=\"note-editor note-frame panel\"/>');\nvar toolbar = renderer.create('<div class=\"note-toolbar-wrapper panel-default\"><div class=\"note-toolbar panel-heading\"></div></div>');\nvar editingArea = renderer.create('<div class=\"note-editing-area\"/>');\nvar codable = renderer.create('<textarea class=\"note-codable\"/>');\nvar editable = renderer.create('<div class=\"note-editable\" contentEditable=\"true\"/>');\nvar statusbar = renderer.create([\n    '<div class=\"note-statusbar\">',\n    '  <div class=\"note-resizebar\">',\n    '    <div class=\"note-icon-bar\"/>',\n    '    <div class=\"note-icon-bar\"/>',\n    '    <div class=\"note-icon-bar\"/>',\n    '  </div>',\n    '</div>'\n].join(''));\nvar airEditor = renderer.create('<div class=\"note-editor\"/>');\nvar airEditable = renderer.create('<div class=\"note-editable\" contentEditable=\"true\"/>');\nvar buttonGroup = renderer.create('<div class=\"note-btn-group btn-group\">');\nvar dropdown = renderer.create('<div class=\"dropdown-menu\">', function ($node, options) {\n    var markup = $$1.isArray(options.items) ? options.items.map(function (item) {\n        var value = (typeof item === 'string') ? item : (item.value || '');\n        var content = options.template ? options.template(item) : item;\n        var option = (typeof item === 'object') ? item.option : undefined;\n        var dataValue = 'data-value=\"' + value + '\"';\n        var dataOption = (option !== undefined) ? ' data-option=\"' + option + '\"' : '';\n        return '<li><a href=\"#\" ' + (dataValue + dataOption) + '>' + content + '</a></li>';\n    }).join('') : options.items;\n    $node.html(markup);\n});\nvar dropdownButtonContents = function (contents, options) {\n    return contents + ' ' + icon(options.icons.caret, 'span');\n};\nvar dropdownCheck = renderer.create('<div class=\"dropdown-menu note-check\">', function ($node, options) {\n    var markup = $$1.isArray(options.items) ? options.items.map(function (item) {\n        var value = (typeof item === 'string') ? item : (item.value || '');\n        var content = options.template ? options.template(item) : item;\n        return '<li><a href=\"#\" data-value=\"' + value + '\">' + icon(options.checkClassName) + ' ' + content + '</a></li>';\n    }).join('') : options.items;\n    $node.html(markup);\n});\nvar palette = renderer.create('<div class=\"note-color-palette\"/>', function ($node, options) {\n    var contents = [];\n    for (var row = 0, rowSize = options.colors.length; row < rowSize; row++) {\n        var eventName = options.eventName;\n        var colors = options.colors[row];\n        var buttons = [];\n        for (var col = 0, colSize = colors.length; col < colSize; col++) {\n            var color = colors[col];\n            buttons.push([\n                '<button type=\"button\" class=\"note-color-btn\"',\n                'style=\"background-color:', color, '\" ',\n                'data-event=\"', eventName, '\" ',\n                'data-value=\"', color, '\" ',\n                'title=\"', color, '\" ',\n                'data-toggle=\"button\" tabindex=\"-1\"></button>'\n            ].join(''));\n        }\n        contents.push('<div class=\"note-color-row\">' + buttons.join('') + '</div>');\n    }\n    $node.html(contents.join(''));\n    if (options.tooltip) {\n        $node.find('.note-color-btn').tooltip({\n            container: options.container,\n            trigger: 'hover',\n            placement: 'bottom'\n        });\n    }\n});\nvar dialog = renderer.create('<div class=\"modal\" aria-hidden=\"false\" tabindex=\"-1\"/>', function ($node, options) {\n    if (options.fade) {\n        $node.addClass('fade');\n    }\n    $node.html([\n        '<div class=\"modal-dialog\">',\n        '  <div class=\"modal-content\">',\n        (options.title\n            ? '    <div class=\"modal-header\">' +\n                '      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n                '      <h4 class=\"modal-title\">' + options.title + '</h4>' +\n                '    </div>' : ''),\n        '    <div class=\"modal-body\">' + options.body + '</div>',\n        (options.footer\n            ? '    <div class=\"modal-footer\">' + options.footer + '</div>' : ''),\n        '  </div>',\n        '</div>'\n    ].join(''));\n});\nvar popover = renderer.create([\n    '<div class=\"note-popover popover in\">',\n    '  <div class=\"arrow\"/>',\n    '  <div class=\"popover-content note-children-container\"/>',\n    '</div>'\n].join(''), function ($node, options) {\n    var direction = typeof options.direction !== 'undefined' ? options.direction : 'bottom';\n    $node.addClass(direction);\n    if (options.hideArrow) {\n        $node.find('.arrow').hide();\n    }\n});\nvar checkbox = renderer.create('<div class=\"checkbox\"></div>', function ($node, options) {\n    $node.html([\n        ' <label' + (options.id ? ' for=\"' + options.id + '\"' : '') + '>',\n        ' <input type=\"checkbox\"' + (options.id ? ' id=\"' + options.id + '\"' : ''),\n        (options.checked ? ' checked' : '') + '/>',\n        (options.text ? options.text : ''),\n        '</label>'\n    ].join(''));\n});\nvar icon = function (iconClassName, tagName) {\n    tagName = tagName || 'i';\n    return '<' + tagName + ' class=\"' + iconClassName + '\"/>';\n};\nvar ui = {\n    editor: editor,\n    toolbar: toolbar,\n    editingArea: editingArea,\n    codable: codable,\n    editable: editable,\n    statusbar: statusbar,\n    airEditor: airEditor,\n    airEditable: airEditable,\n    buttonGroup: buttonGroup,\n    dropdown: dropdown,\n    dropdownButtonContents: dropdownButtonContents,\n    dropdownCheck: dropdownCheck,\n    palette: palette,\n    dialog: dialog,\n    popover: popover,\n    checkbox: checkbox,\n    icon: icon,\n    options: {},\n    button: function ($node, options) {\n        return renderer.create('<button type=\"button\" class=\"note-btn btn btn-default btn-sm\" tabindex=\"-1\">', function ($node, options) {\n            if (options && options.tooltip) {\n                $node.attr({\n                    title: options.tooltip\n                }).tooltip({\n                    container: options.container,\n                    trigger: 'hover',\n                    placement: 'bottom'\n                });\n            }\n        })($node, options);\n    },\n    toggleBtn: function ($btn, isEnable) {\n        $btn.toggleClass('disabled', !isEnable);\n        $btn.attr('disabled', !isEnable);\n    },\n    toggleBtnActive: function ($btn, isActive) {\n        $btn.toggleClass('active', isActive);\n    },\n    onDialogShown: function ($dialog, handler) {\n        $dialog.one('shown.bs.modal', handler);\n    },\n    onDialogHidden: function ($dialog, handler) {\n        $dialog.one('hidden.bs.modal', handler);\n    },\n    showDialog: function ($dialog) {\n        $dialog.modal('show');\n    },\n    hideDialog: function ($dialog) {\n        $dialog.modal('hide');\n    },\n    createLayout: function ($note, options) {\n        var $editor = (options.airMode ? ui.airEditor([\n            ui.editingArea([\n                ui.airEditable()\n            ])\n        ]) : ui.editor([\n            ui.toolbar(),\n            ui.editingArea([\n                ui.codable(),\n                ui.editable()\n            ]),\n            ui.statusbar()\n        ])).render();\n        $editor.insertAfter($note);\n        return {\n            note: $note,\n            editor: $editor,\n            toolbar: $editor.find('.note-toolbar'),\n            editingArea: $editor.find('.note-editing-area'),\n            editable: $editor.find('.note-editable'),\n            codable: $editor.find('.note-codable'),\n            statusbar: $editor.find('.note-statusbar')\n        };\n    },\n    removeLayout: function ($note, layoutInfo) {\n        $note.html(layoutInfo.editable.html());\n        layoutInfo.editor.remove();\n        $note.show();\n    }\n};\n\n/**\n * @class core.func\n *\n * func utils (for high-order func's arg)\n *\n * @singleton\n * @alternateClassName func\n */\nfunction eq(itemA) {\n    return function (itemB) {\n        return itemA === itemB;\n    };\n}\nfunction eq2(itemA, itemB) {\n    return itemA === itemB;\n}\nfunction peq2(propName) {\n    return function (itemA, itemB) {\n        return itemA[propName] === itemB[propName];\n    };\n}\nfunction ok() {\n    return true;\n}\nfunction fail() {\n    return false;\n}\nfunction not(f) {\n    return function () {\n        return !f.apply(f, arguments);\n    };\n}\nfunction and(fA, fB) {\n    return function (item) {\n        return fA(item) && fB(item);\n    };\n}\nfunction self(a) {\n    return a;\n}\nfunction invoke(obj, method) {\n    return function () {\n        return obj[method].apply(obj, arguments);\n    };\n}\nvar idCounter = 0;\n/**\n * generate a globally-unique id\n *\n * @param {String} [prefix]\n */\nfunction uniqueId(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n}\n/**\n * returns bnd (bounds) from rect\n *\n * - IE Compatibility Issue: http://goo.gl/sRLOAo\n * - Scroll Issue: http://goo.gl/sNjUc\n *\n * @param {Rect} rect\n * @return {Object} bounds\n * @return {Number} bounds.top\n * @return {Number} bounds.left\n * @return {Number} bounds.width\n * @return {Number} bounds.height\n */\nfunction rect2bnd(rect) {\n    var $document = $(document);\n    return {\n        top: rect.top + $document.scrollTop(),\n        left: rect.left + $document.scrollLeft(),\n        width: rect.right - rect.left,\n        height: rect.bottom - rect.top\n    };\n}\n/**\n * returns a copy of the object where the keys have become the values and the values the keys.\n * @param {Object} obj\n * @return {Object}\n */\nfunction invertObject(obj) {\n    var inverted = {};\n    for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            inverted[obj[key]] = key;\n        }\n    }\n    return inverted;\n}\n/**\n * @param {String} namespace\n * @param {String} [prefix]\n * @return {String}\n */\nfunction namespaceToCamel(namespace, prefix) {\n    prefix = prefix || '';\n    return prefix + namespace.split('.').map(function (name) {\n        return name.substring(0, 1).toUpperCase() + name.substring(1);\n    }).join('');\n}\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {Function} func\n * @param {Number} wait\n * @param {Boolean} immediate\n * @return {Function}\n */\nfunction debounce(func, wait, immediate) {\n    var _this = this;\n    var timeout;\n    return function () {\n        var context = _this;\n        var args = arguments;\n        var later = function () {\n            timeout = null;\n            if (!immediate) {\n                func.apply(context, args);\n            }\n        };\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) {\n            func.apply(context, args);\n        }\n    };\n}\nvar func = {\n    eq: eq,\n    eq2: eq2,\n    peq2: peq2,\n    ok: ok,\n    fail: fail,\n    self: self,\n    not: not,\n    and: and,\n    invoke: invoke,\n    uniqueId: uniqueId,\n    rect2bnd: rect2bnd,\n    invertObject: invertObject,\n    namespaceToCamel: namespaceToCamel,\n    debounce: debounce\n};\n\n/**\n * returns the first item of an array.\n *\n * @param {Array} array\n */\nfunction head(array) {\n    return array[0];\n}\n/**\n * returns the last item of an array.\n *\n * @param {Array} array\n */\nfunction last(array) {\n    return array[array.length - 1];\n}\n/**\n * returns everything but the last entry of the array.\n *\n * @param {Array} array\n */\nfunction initial(array) {\n    return array.slice(0, array.length - 1);\n}\n/**\n * returns the rest of the items in an array.\n *\n * @param {Array} array\n */\nfunction tail(array) {\n    return array.slice(1);\n}\n/**\n * returns item of array\n */\nfunction find(array, pred) {\n    for (var idx = 0, len = array.length; idx < len; idx++) {\n        var item = array[idx];\n        if (pred(item)) {\n            return item;\n        }\n    }\n}\n/**\n * returns true if all of the values in the array pass the predicate truth test.\n */\nfunction all(array, pred) {\n    for (var idx = 0, len = array.length; idx < len; idx++) {\n        if (!pred(array[idx])) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * returns index of item\n */\nfunction indexOf(array, item) {\n    return $$1.inArray(item, array);\n}\n/**\n * returns true if the value is present in the list.\n */\nfunction contains(array, item) {\n    return indexOf(array, item) !== -1;\n}\n/**\n * get sum from a list\n *\n * @param {Array} array - array\n * @param {Function} fn - iterator\n */\nfunction sum(array, fn) {\n    fn = fn || func.self;\n    return array.reduce(function (memo, v) {\n        return memo + fn(v);\n    }, 0);\n}\n/**\n * returns a copy of the collection with array type.\n * @param {Collection} collection - collection eg) node.childNodes, ...\n */\nfunction from(collection) {\n    var result = [];\n    var length = collection.length;\n    var idx = -1;\n    while (++idx < length) {\n        result[idx] = collection[idx];\n    }\n    return result;\n}\n/**\n * returns whether list is empty or not\n */\nfunction isEmpty$1(array) {\n    return !array || !array.length;\n}\n/**\n * cluster elements by predicate function.\n *\n * @param {Array} array - array\n * @param {Function} fn - predicate function for cluster rule\n * @param {Array[]}\n */\nfunction clusterBy(array, fn) {\n    if (!array.length) {\n        return [];\n    }\n    var aTail = tail(array);\n    return aTail.reduce(function (memo, v) {\n        var aLast = last(memo);\n        if (fn(last(aLast), v)) {\n            aLast[aLast.length] = v;\n        }\n        else {\n            memo[memo.length] = [v];\n        }\n        return memo;\n    }, [[head(array)]]);\n}\n/**\n * returns a copy of the array with all false values removed\n *\n * @param {Array} array - array\n * @param {Function} fn - predicate function for cluster rule\n */\nfunction compact(array) {\n    var aResult = [];\n    for (var idx = 0, len = array.length; idx < len; idx++) {\n        if (array[idx]) {\n            aResult.push(array[idx]);\n        }\n    }\n    return aResult;\n}\n/**\n * produces a duplicate-free version of the array\n *\n * @param {Array} array\n */\nfunction unique(array) {\n    var results = [];\n    for (var idx = 0, len = array.length; idx < len; idx++) {\n        if (!contains(results, array[idx])) {\n            results.push(array[idx]);\n        }\n    }\n    return results;\n}\n/**\n * returns next item.\n * @param {Array} array\n */\nfunction next(array, item) {\n    var idx = indexOf(array, item);\n    if (idx === -1) {\n        return null;\n    }\n    return array[idx + 1];\n}\n/**\n * returns prev item.\n * @param {Array} array\n */\nfunction prev(array, item) {\n    var idx = indexOf(array, item);\n    if (idx === -1) {\n        return null;\n    }\n    return array[idx - 1];\n}\n/**\n * @class core.list\n *\n * list utils\n *\n * @singleton\n * @alternateClassName list\n */\nvar lists = {\n    head: head,\n    last: last,\n    initial: initial,\n    tail: tail,\n    prev: prev,\n    next: next,\n    find: find,\n    contains: contains,\n    all: all,\n    sum: sum,\n    from: from,\n    isEmpty: isEmpty$1,\n    clusterBy: clusterBy,\n    compact: compact,\n    unique: unique\n};\n\nvar isSupportAmd = typeof define === 'function' && define.amd; // eslint-disable-line\n/**\n * returns whether font is installed or not.\n *\n * @param {String} fontName\n * @return {Boolean}\n */\nfunction isFontInstalled(fontName) {\n    var testFontName = fontName === 'Comic Sans MS' ? 'Courier New' : 'Comic Sans MS';\n    var $tester = $$1('<div>').css({\n        position: 'absolute',\n        left: '-9999px',\n        top: '-9999px',\n        fontSize: '200px'\n    }).text('mmmmmmmmmwwwwwww').appendTo(document.body);\n    var originalWidth = $tester.css('fontFamily', testFontName).width();\n    var width = $tester.css('fontFamily', fontName + ',' + testFontName).width();\n    $tester.remove();\n    return originalWidth !== width;\n}\nvar userAgent = navigator.userAgent;\nvar isMSIE = /MSIE|Trident/i.test(userAgent);\nvar browserVersion;\nif (isMSIE) {\n    var matches = /MSIE (\\d+[.]\\d+)/.exec(userAgent);\n    if (matches) {\n        browserVersion = parseFloat(matches[1]);\n    }\n    matches = /Trident\\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(userAgent);\n    if (matches) {\n        browserVersion = parseFloat(matches[1]);\n    }\n}\nvar isEdge = /Edge\\/\\d+/.test(userAgent);\nvar hasCodeMirror = !!window.CodeMirror;\nif (!hasCodeMirror && isSupportAmd) {\n    // Webpack\n    if (typeof __webpack_require__ === 'function') {\n        try {\n            // If CodeMirror can't be resolved, `require.resolve` will throw an\n            // exception and `hasCodeMirror` won't be set to `true`.\n            require.resolve('codemirror');\n            hasCodeMirror = true;\n        }\n        catch (e) {\n            // do nothing\n        }\n    }\n    else if (typeof require !== 'undefined') {\n        // Browserify\n        if (typeof require.resolve !== 'undefined') {\n            try {\n                // If CodeMirror can't be resolved, `require.resolve` will throw an\n                // exception and `hasCodeMirror` won't be set to `true`.\n                require.resolve('codemirror');\n                hasCodeMirror = true;\n            }\n            catch (e) {\n                // do nothing\n            }\n            // Almond/Require\n        }\n        else if (typeof require.specified !== 'undefined') {\n            hasCodeMirror = require.specified('codemirror');\n        }\n    }\n}\nvar isSupportTouch = (('ontouchstart' in window) ||\n    (navigator.MaxTouchPoints > 0) ||\n    (navigator.msMaxTouchPoints > 0));\n// [workaround] IE doesn't have input events for contentEditable\n// - see: https://goo.gl/4bfIvA\nvar inputEventName = (isMSIE || isEdge) ? 'DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted' : 'input';\n/**\n * @class core.env\n *\n * Object which check platform and agent\n *\n * @singleton\n * @alternateClassName env\n */\nvar env = {\n    isMac: navigator.appVersion.indexOf('Mac') > -1,\n    isMSIE: isMSIE,\n    isEdge: isEdge,\n    isFF: !isEdge && /firefox/i.test(userAgent),\n    isPhantom: /PhantomJS/i.test(userAgent),\n    isWebkit: !isEdge && /webkit/i.test(userAgent),\n    isChrome: !isEdge && /chrome/i.test(userAgent),\n    isSafari: !isEdge && /safari/i.test(userAgent),\n    browserVersion: browserVersion,\n    jqueryVersion: parseFloat($$1.fn.jquery),\n    isSupportAmd: isSupportAmd,\n    isSupportTouch: isSupportTouch,\n    hasCodeMirror: hasCodeMirror,\n    isFontInstalled: isFontInstalled,\n    isW3CRangeSupport: !!document.createRange,\n    inputEventName: inputEventName\n};\n\nvar NBSP_CHAR = String.fromCharCode(160);\nvar ZERO_WIDTH_NBSP_CHAR = '\\ufeff';\n/**\n * @method isEditable\n *\n * returns whether node is `note-editable` or not.\n *\n * @param {Node} node\n * @return {Boolean}\n */\nfunction isEditable(node) {\n    return node && $$1(node).hasClass('note-editable');\n}\n/**\n * @method isControlSizing\n *\n * returns whether node is `note-control-sizing` or not.\n *\n * @param {Node} node\n * @return {Boolean}\n */\nfunction isControlSizing(node) {\n    return node && $$1(node).hasClass('note-control-sizing');\n}\n/**\n * @method makePredByNodeName\n *\n * returns predicate which judge whether nodeName is same\n *\n * @param {String} nodeName\n * @return {Function}\n */\nfunction makePredByNodeName(nodeName) {\n    nodeName = nodeName.toUpperCase();\n    return function (node) {\n        return node && node.nodeName.toUpperCase() === nodeName;\n    };\n}\n/**\n * @method isText\n *\n *\n *\n * @param {Node} node\n * @return {Boolean} true if node's type is text(3)\n */\nfunction isText(node) {\n    return node && node.nodeType === 3;\n}\n/**\n * @method isElement\n *\n *\n *\n * @param {Node} node\n * @return {Boolean} true if node's type is element(1)\n */\nfunction isElement(node) {\n    return node && node.nodeType === 1;\n}\n/**\n * ex) br, col, embed, hr, img, input, ...\n * @see http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n */\nfunction isVoid(node) {\n    return node && /^BR|^IMG|^HR|^IFRAME|^BUTTON|^INPUT/.test(node.nodeName.toUpperCase());\n}\nfunction isPara(node) {\n    if (isEditable(node)) {\n        return false;\n    }\n    // Chrome(v31.0), FF(v25.0.1) use DIV for paragraph\n    return node && /^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase());\n}\nfunction isHeading(node) {\n    return node && /^H[1-7]/.test(node.nodeName.toUpperCase());\n}\nvar isPre = makePredByNodeName('PRE');\nvar isLi = makePredByNodeName('LI');\nfunction isPurePara(node) {\n    return isPara(node) && !isLi(node);\n}\nvar isTable = makePredByNodeName('TABLE');\nvar isData = makePredByNodeName('DATA');\nfunction isInline(node) {\n    return !isBodyContainer(node) &&\n        !isList(node) &&\n        !isHr(node) &&\n        !isPara(node) &&\n        !isTable(node) &&\n        !isBlockquote(node) &&\n        !isData(node);\n}\nfunction isList(node) {\n    return node && /^UL|^OL/.test(node.nodeName.toUpperCase());\n}\nvar isHr = makePredByNodeName('HR');\nfunction isCell(node) {\n    return node && /^TD|^TH/.test(node.nodeName.toUpperCase());\n}\nvar isBlockquote = makePredByNodeName('BLOCKQUOTE');\nfunction isBodyContainer(node) {\n    return isCell(node) || isBlockquote(node) || isEditable(node);\n}\nvar isAnchor = makePredByNodeName('A');\nfunction isParaInline(node) {\n    return isInline(node) && !!ancestor(node, isPara);\n}\nfunction isBodyInline(node) {\n    return isInline(node) && !ancestor(node, isPara);\n}\nvar isBody = makePredByNodeName('BODY');\n/**\n * returns whether nodeB is closest sibling of nodeA\n *\n * @param {Node} nodeA\n * @param {Node} nodeB\n * @return {Boolean}\n */\nfunction isClosestSibling(nodeA, nodeB) {\n    return nodeA.nextSibling === nodeB ||\n        nodeA.previousSibling === nodeB;\n}\n/**\n * returns array of closest siblings with node\n *\n * @param {Node} node\n * @param {function} [pred] - predicate function\n * @return {Node[]}\n */\nfunction withClosestSiblings(node, pred) {\n    pred = pred || func.ok;\n    var siblings = [];\n    if (node.previousSibling && pred(node.previousSibling)) {\n        siblings.push(node.previousSibling);\n    }\n    siblings.push(node);\n    if (node.nextSibling && pred(node.nextSibling)) {\n        siblings.push(node.nextSibling);\n    }\n    return siblings;\n}\n/**\n * blank HTML for cursor position\n * - [workaround] old IE only works with &nbsp;\n * - [workaround] IE11 and other browser works with bogus br\n */\nvar blankHTML = env.isMSIE && env.browserVersion < 11 ? '&nbsp;' : '<br>';\n/**\n * @method nodeLength\n *\n * returns #text's text size or element's childNodes size\n *\n * @param {Node} node\n */\nfunction nodeLength(node) {\n    if (isText(node)) {\n        return node.nodeValue.length;\n    }\n    if (node) {\n        return node.childNodes.length;\n    }\n    return 0;\n}\n/**\n * returns whether node is empty or not.\n *\n * @param {Node} node\n * @return {Boolean}\n */\nfunction isEmpty(node) {\n    var len = nodeLength(node);\n    if (len === 0) {\n        return true;\n    }\n    else if (!isText(node) && len === 1 && node.innerHTML === blankHTML) {\n        // ex) <p><br></p>, <span><br></span>\n        return true;\n    }\n    else if (lists.all(node.childNodes, isText) && node.innerHTML === '') {\n        // ex) <p></p>, <span></span>\n        return true;\n    }\n    return false;\n}\n/**\n * padding blankHTML if node is empty (for cursor position)\n */\nfunction paddingBlankHTML(node) {\n    if (!isVoid(node) && !nodeLength(node)) {\n        node.innerHTML = blankHTML;\n    }\n}\n/**\n * find nearest ancestor predicate hit\n *\n * @param {Node} node\n * @param {Function} pred - predicate function\n */\nfunction ancestor(node, pred) {\n    while (node) {\n        if (pred(node)) {\n            return node;\n        }\n        if (isEditable(node)) {\n            break;\n        }\n        node = node.parentNode;\n    }\n    return null;\n}\n/**\n * find nearest ancestor only single child blood line and predicate hit\n *\n * @param {Node} node\n * @param {Function} pred - predicate function\n */\nfunction singleChildAncestor(node, pred) {\n    node = node.parentNode;\n    while (node) {\n        if (nodeLength(node) !== 1) {\n            break;\n        }\n        if (pred(node)) {\n            return node;\n        }\n        if (isEditable(node)) {\n            break;\n        }\n        node = node.parentNode;\n    }\n    return null;\n}\n/**\n * returns new array of ancestor nodes (until predicate hit).\n *\n * @param {Node} node\n * @param {Function} [optional] pred - predicate function\n */\nfunction listAncestor(node, pred) {\n    pred = pred || func.fail;\n    var ancestors = [];\n    ancestor(node, function (el) {\n        if (!isEditable(el)) {\n            ancestors.push(el);\n        }\n        return pred(el);\n    });\n    return ancestors;\n}\n/**\n * find farthest ancestor predicate hit\n */\nfunction lastAncestor(node, pred) {\n    var ancestors = listAncestor(node);\n    return lists.last(ancestors.filter(pred));\n}\n/**\n * returns common ancestor node between two nodes.\n *\n * @param {Node} nodeA\n * @param {Node} nodeB\n */\nfunction commonAncestor(nodeA, nodeB) {\n    var ancestors = listAncestor(nodeA);\n    for (var n = nodeB; n; n = n.parentNode) {\n        if ($$1.inArray(n, ancestors) > -1) {\n            return n;\n        }\n    }\n    return null; // difference document area\n}\n/**\n * listing all previous siblings (until predicate hit).\n *\n * @param {Node} node\n * @param {Function} [optional] pred - predicate function\n */\nfunction listPrev(node, pred) {\n    pred = pred || func.fail;\n    var nodes = [];\n    while (node) {\n        if (pred(node)) {\n            break;\n        }\n        nodes.push(node);\n        node = node.previousSibling;\n    }\n    return nodes;\n}\n/**\n * listing next siblings (until predicate hit).\n *\n * @param {Node} node\n * @param {Function} [pred] - predicate function\n */\nfunction listNext(node, pred) {\n    pred = pred || func.fail;\n    var nodes = [];\n    while (node) {\n        if (pred(node)) {\n            break;\n        }\n        nodes.push(node);\n        node = node.nextSibling;\n    }\n    return nodes;\n}\n/**\n * listing descendant nodes\n *\n * @param {Node} node\n * @param {Function} [pred] - predicate function\n */\nfunction listDescendant(node, pred) {\n    var descendants = [];\n    pred = pred || func.ok;\n    // start DFS(depth first search) with node\n    (function fnWalk(current) {\n        if (node !== current && pred(current)) {\n            descendants.push(current);\n        }\n        for (var idx = 0, len = current.childNodes.length; idx < len; idx++) {\n            fnWalk(current.childNodes[idx]);\n        }\n    })(node);\n    return descendants;\n}\n/**\n * wrap node with new tag.\n *\n * @param {Node} node\n * @param {Node} tagName of wrapper\n * @return {Node} - wrapper\n */\nfunction wrap(node, wrapperName) {\n    var parent = node.parentNode;\n    var wrapper = $$1('<' + wrapperName + '>')[0];\n    parent.insertBefore(wrapper, node);\n    wrapper.appendChild(node);\n    return wrapper;\n}\n/**\n * insert node after preceding\n *\n * @param {Node} node\n * @param {Node} preceding - predicate function\n */\nfunction insertAfter(node, preceding) {\n    var next = preceding.nextSibling;\n    var parent = preceding.parentNode;\n    if (next) {\n        parent.insertBefore(node, next);\n    }\n    else {\n        parent.appendChild(node);\n    }\n    return node;\n}\n/**\n * append elements.\n *\n * @param {Node} node\n * @param {Collection} aChild\n */\nfunction appendChildNodes(node, aChild) {\n    $$1.each(aChild, function (idx, child) {\n        node.appendChild(child);\n    });\n    return node;\n}\n/**\n * returns whether boundaryPoint is left edge or not.\n *\n * @param {BoundaryPoint} point\n * @return {Boolean}\n */\nfunction isLeftEdgePoint(point) {\n    return point.offset === 0;\n}\n/**\n * returns whether boundaryPoint is right edge or not.\n *\n * @param {BoundaryPoint} point\n * @return {Boolean}\n */\nfunction isRightEdgePoint(point) {\n    return point.offset === nodeLength(point.node);\n}\n/**\n * returns whether boundaryPoint is edge or not.\n *\n * @param {BoundaryPoint} point\n * @return {Boolean}\n */\nfunction isEdgePoint(point) {\n    return isLeftEdgePoint(point) || isRightEdgePoint(point);\n}\n/**\n * returns whether node is left edge of ancestor or not.\n *\n * @param {Node} node\n * @param {Node} ancestor\n * @return {Boolean}\n */\nfunction isLeftEdgeOf(node, ancestor) {\n    while (node && node !== ancestor) {\n        if (position(node) !== 0) {\n            return false;\n        }\n        node = node.parentNode;\n    }\n    return true;\n}\n/**\n * returns whether node is right edge of ancestor or not.\n *\n * @param {Node} node\n * @param {Node} ancestor\n * @return {Boolean}\n */\nfunction isRightEdgeOf(node, ancestor) {\n    if (!ancestor) {\n        return false;\n    }\n    while (node && node !== ancestor) {\n        if (position(node) !== nodeLength(node.parentNode) - 1) {\n            return false;\n        }\n        node = node.parentNode;\n    }\n    return true;\n}\n/**\n * returns whether point is left edge of ancestor or not.\n * @param {BoundaryPoint} point\n * @param {Node} ancestor\n * @return {Boolean}\n */\nfunction isLeftEdgePointOf(point, ancestor) {\n    return isLeftEdgePoint(point) && isLeftEdgeOf(point.node, ancestor);\n}\n/**\n * returns whether point is right edge of ancestor or not.\n * @param {BoundaryPoint} point\n * @param {Node} ancestor\n * @return {Boolean}\n */\nfunction isRightEdgePointOf(point, ancestor) {\n    return isRightEdgePoint(point) && isRightEdgeOf(point.node, ancestor);\n}\n/**\n * returns offset from parent.\n *\n * @param {Node} node\n */\nfunction position(node) {\n    var offset = 0;\n    while ((node = node.previousSibling)) {\n        offset += 1;\n    }\n    return offset;\n}\nfunction hasChildren(node) {\n    return !!(node && node.childNodes && node.childNodes.length);\n}\n/**\n * returns previous boundaryPoint\n *\n * @param {BoundaryPoint} point\n * @param {Boolean} isSkipInnerOffset\n * @return {BoundaryPoint}\n */\nfunction prevPoint(point, isSkipInnerOffset) {\n    var node;\n    var offset;\n    if (point.offset === 0) {\n        if (isEditable(point.node)) {\n            return null;\n        }\n        node = point.node.parentNode;\n        offset = position(point.node);\n    }\n    else if (hasChildren(point.node)) {\n        node = point.node.childNodes[point.offset - 1];\n        offset = nodeLength(node);\n    }\n    else {\n        node = point.node;\n        offset = isSkipInnerOffset ? 0 : point.offset - 1;\n    }\n    return {\n        node: node,\n        offset: offset\n    };\n}\n/**\n * returns next boundaryPoint\n *\n * @param {BoundaryPoint} point\n * @param {Boolean} isSkipInnerOffset\n * @return {BoundaryPoint}\n */\nfunction nextPoint(point, isSkipInnerOffset) {\n    var node, offset;\n    if (nodeLength(point.node) === point.offset) {\n        if (isEditable(point.node)) {\n            return null;\n        }\n        node = point.node.parentNode;\n        offset = position(point.node) + 1;\n    }\n    else if (hasChildren(point.node)) {\n        node = point.node.childNodes[point.offset];\n        offset = 0;\n    }\n    else {\n        node = point.node;\n        offset = isSkipInnerOffset ? nodeLength(point.node) : point.offset + 1;\n    }\n    return {\n        node: node,\n        offset: offset\n    };\n}\n/**\n * returns whether pointA and pointB is same or not.\n *\n * @param {BoundaryPoint} pointA\n * @param {BoundaryPoint} pointB\n * @return {Boolean}\n */\nfunction isSamePoint(pointA, pointB) {\n    return pointA.node === pointB.node && pointA.offset === pointB.offset;\n}\n/**\n * returns whether point is visible (can set cursor) or not.\n *\n * @param {BoundaryPoint} point\n * @return {Boolean}\n */\nfunction isVisiblePoint(point) {\n    if (isText(point.node) || !hasChildren(point.node) || isEmpty(point.node)) {\n        return true;\n    }\n    var leftNode = point.node.childNodes[point.offset - 1];\n    var rightNode = point.node.childNodes[point.offset];\n    if ((!leftNode || isVoid(leftNode)) && (!rightNode || isVoid(rightNode))) {\n        return true;\n    }\n    return false;\n}\n/**\n * @method prevPointUtil\n *\n * @param {BoundaryPoint} point\n * @param {Function} pred\n * @return {BoundaryPoint}\n */\nfunction prevPointUntil(point, pred) {\n    while (point) {\n        if (pred(point)) {\n            return point;\n        }\n        point = prevPoint(point);\n    }\n    return null;\n}\n/**\n * @method nextPointUntil\n *\n * @param {BoundaryPoint} point\n * @param {Function} pred\n * @return {BoundaryPoint}\n */\nfunction nextPointUntil(point, pred) {\n    while (point) {\n        if (pred(point)) {\n            return point;\n        }\n        point = nextPoint(point);\n    }\n    return null;\n}\n/**\n * returns whether point has character or not.\n *\n * @param {Point} point\n * @return {Boolean}\n */\nfunction isCharPoint(point) {\n    if (!isText(point.node)) {\n        return false;\n    }\n    var ch = point.node.nodeValue.charAt(point.offset - 1);\n    return ch && (ch !== ' ' && ch !== NBSP_CHAR);\n}\n/**\n * @method walkPoint\n *\n * @param {BoundaryPoint} startPoint\n * @param {BoundaryPoint} endPoint\n * @param {Function} handler\n * @param {Boolean} isSkipInnerOffset\n */\nfunction walkPoint(startPoint, endPoint, handler, isSkipInnerOffset) {\n    var point = startPoint;\n    while (point) {\n        handler(point);\n        if (isSamePoint(point, endPoint)) {\n            break;\n        }\n        var isSkipOffset = isSkipInnerOffset &&\n            startPoint.node !== point.node &&\n            endPoint.node !== point.node;\n        point = nextPoint(point, isSkipOffset);\n    }\n}\n/**\n * @method makeOffsetPath\n *\n * return offsetPath(array of offset) from ancestor\n *\n * @param {Node} ancestor - ancestor node\n * @param {Node} node\n */\nfunction makeOffsetPath(ancestor, node) {\n    var ancestors = listAncestor(node, func.eq(ancestor));\n    return ancestors.map(position).reverse();\n}\n/**\n * @method fromOffsetPath\n *\n * return element from offsetPath(array of offset)\n *\n * @param {Node} ancestor - ancestor node\n * @param {array} offsets - offsetPath\n */\nfunction fromOffsetPath(ancestor, offsets) {\n    var current = ancestor;\n    for (var i = 0, len = offsets.length; i < len; i++) {\n        if (current.childNodes.length <= offsets[i]) {\n            current = current.childNodes[current.childNodes.length - 1];\n        }\n        else {\n            current = current.childNodes[offsets[i]];\n        }\n    }\n    return current;\n}\n/**\n * @method splitNode\n *\n * split element or #text\n *\n * @param {BoundaryPoint} point\n * @param {Object} [options]\n * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n * @return {Node} right node of boundaryPoint\n */\nfunction splitNode(point, options) {\n    var isSkipPaddingBlankHTML = options && options.isSkipPaddingBlankHTML;\n    var isNotSplitEdgePoint = options && options.isNotSplitEdgePoint;\n    // edge case\n    if (isEdgePoint(point) && (isText(point.node) || isNotSplitEdgePoint)) {\n        if (isLeftEdgePoint(point)) {\n            return point.node;\n        }\n        else if (isRightEdgePoint(point)) {\n            return point.node.nextSibling;\n        }\n    }\n    // split #text\n    if (isText(point.node)) {\n        return point.node.splitText(point.offset);\n    }\n    else {\n        var childNode = point.node.childNodes[point.offset];\n        var clone = insertAfter(point.node.cloneNode(false), point.node);\n        appendChildNodes(clone, listNext(childNode));\n        if (!isSkipPaddingBlankHTML) {\n            paddingBlankHTML(point.node);\n            paddingBlankHTML(clone);\n        }\n        return clone;\n    }\n}\n/**\n * @method splitTree\n *\n * split tree by point\n *\n * @param {Node} root - split root\n * @param {BoundaryPoint} point\n * @param {Object} [options]\n * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n * @return {Node} right node of boundaryPoint\n */\nfunction splitTree(root, point, options) {\n    // ex) [#text, <span>, <p>]\n    var ancestors = listAncestor(point.node, func.eq(root));\n    if (!ancestors.length) {\n        return null;\n    }\n    else if (ancestors.length === 1) {\n        return splitNode(point, options);\n    }\n    return ancestors.reduce(function (node, parent) {\n        if (node === point.node) {\n            node = splitNode(point, options);\n        }\n        return splitNode({\n            node: parent,\n            offset: node ? position(node) : nodeLength(parent)\n        }, options);\n    });\n}\n/**\n * split point\n *\n * @param {Point} point\n * @param {Boolean} isInline\n * @return {Object}\n */\nfunction splitPoint(point, isInline) {\n    // find splitRoot, container\n    //  - inline: splitRoot is a child of paragraph\n    //  - block: splitRoot is a child of bodyContainer\n    var pred = isInline ? isPara : isBodyContainer;\n    var ancestors = listAncestor(point.node, pred);\n    var topAncestor = lists.last(ancestors) || point.node;\n    var splitRoot, container;\n    if (pred(topAncestor)) {\n        splitRoot = ancestors[ancestors.length - 2];\n        container = topAncestor;\n    }\n    else {\n        splitRoot = topAncestor;\n        container = splitRoot.parentNode;\n    }\n    // if splitRoot is exists, split with splitTree\n    var pivot = splitRoot && splitTree(splitRoot, point, {\n        isSkipPaddingBlankHTML: isInline,\n        isNotSplitEdgePoint: isInline\n    });\n    // if container is point.node, find pivot with point.offset\n    if (!pivot && container === point.node) {\n        pivot = point.node.childNodes[point.offset];\n    }\n    return {\n        rightNode: pivot,\n        container: container\n    };\n}\nfunction create(nodeName) {\n    return document.createElement(nodeName);\n}\nfunction createText(text) {\n    return document.createTextNode(text);\n}\n/**\n * @method remove\n *\n * remove node, (isRemoveChild: remove child or not)\n *\n * @param {Node} node\n * @param {Boolean} isRemoveChild\n */\nfunction remove(node, isRemoveChild) {\n    if (!node || !node.parentNode) {\n        return;\n    }\n    if (node.removeNode) {\n        return node.removeNode(isRemoveChild);\n    }\n    var parent = node.parentNode;\n    if (!isRemoveChild) {\n        var nodes = [];\n        for (var i = 0, len = node.childNodes.length; i < len; i++) {\n            nodes.push(node.childNodes[i]);\n        }\n        for (var i = 0, len = nodes.length; i < len; i++) {\n            parent.insertBefore(nodes[i], node);\n        }\n    }\n    parent.removeChild(node);\n}\n/**\n * @method removeWhile\n *\n * @param {Node} node\n * @param {Function} pred\n */\nfunction removeWhile(node, pred) {\n    while (node) {\n        if (isEditable(node) || !pred(node)) {\n            break;\n        }\n        var parent = node.parentNode;\n        remove(node);\n        node = parent;\n    }\n}\n/**\n * @method replace\n *\n * replace node with provided nodeName\n *\n * @param {Node} node\n * @param {String} nodeName\n * @return {Node} - new node\n */\nfunction replace(node, nodeName) {\n    if (node.nodeName.toUpperCase() === nodeName.toUpperCase()) {\n        return node;\n    }\n    var newNode = create(nodeName);\n    if (node.style.cssText) {\n        newNode.style.cssText = node.style.cssText;\n    }\n    appendChildNodes(newNode, lists.from(node.childNodes));\n    insertAfter(newNode, node);\n    remove(node);\n    return newNode;\n}\nvar isTextarea = makePredByNodeName('TEXTAREA');\n/**\n * @param {jQuery} $node\n * @param {Boolean} [stripLinebreaks] - default: false\n */\nfunction value($node, stripLinebreaks) {\n    var val = isTextarea($node[0]) ? $node.val() : $node.html();\n    if (stripLinebreaks) {\n        return val.replace(/[\\n\\r]/g, '');\n    }\n    return val;\n}\n/**\n * @method html\n *\n * get the HTML contents of node\n *\n * @param {jQuery} $node\n * @param {Boolean} [isNewlineOnBlock]\n */\nfunction html($node, isNewlineOnBlock) {\n    var markup = value($node);\n    if (isNewlineOnBlock) {\n        var regexTag = /<(\\/?)(\\b(?!!)[^>\\s]*)(.*?)(\\s*\\/?>)/g;\n        markup = markup.replace(regexTag, function (match, endSlash, name) {\n            name = name.toUpperCase();\n            var isEndOfInlineContainer = /^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name) &&\n                !!endSlash;\n            var isBlockNode = /^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);\n            return match + ((isEndOfInlineContainer || isBlockNode) ? '\\n' : '');\n        });\n        markup = $$1.trim(markup);\n    }\n    return markup;\n}\nfunction posFromPlaceholder(placeholder) {\n    var $placeholder = $$1(placeholder);\n    var pos = $placeholder.offset();\n    var height = $placeholder.outerHeight(true); // include margin\n    return {\n        left: pos.left,\n        top: pos.top + height\n    };\n}\nfunction attachEvents($node, events) {\n    Object.keys(events).forEach(function (key) {\n        $node.on(key, events[key]);\n    });\n}\nfunction detachEvents($node, events) {\n    Object.keys(events).forEach(function (key) {\n        $node.off(key, events[key]);\n    });\n}\n/**\n * @method isCustomStyleTag\n *\n * assert if a node contains a \"note-styletag\" class,\n * which implies that's a custom-made style tag node\n *\n * @param {Node} an HTML DOM node\n */\nfunction isCustomStyleTag(node) {\n    return node && !isText(node) && lists.contains(node.classList, 'note-styletag');\n}\nvar dom = {\n    /** @property {String} NBSP_CHAR */\n    NBSP_CHAR: NBSP_CHAR,\n    /** @property {String} ZERO_WIDTH_NBSP_CHAR */\n    ZERO_WIDTH_NBSP_CHAR: ZERO_WIDTH_NBSP_CHAR,\n    /** @property {String} blank */\n    blank: blankHTML,\n    /** @property {String} emptyPara */\n    emptyPara: \"<p>\" + blankHTML + \"</p>\",\n    makePredByNodeName: makePredByNodeName,\n    isEditable: isEditable,\n    isControlSizing: isControlSizing,\n    isText: isText,\n    isElement: isElement,\n    isVoid: isVoid,\n    isPara: isPara,\n    isPurePara: isPurePara,\n    isHeading: isHeading,\n    isInline: isInline,\n    isBlock: func.not(isInline),\n    isBodyInline: isBodyInline,\n    isBody: isBody,\n    isParaInline: isParaInline,\n    isPre: isPre,\n    isList: isList,\n    isTable: isTable,\n    isData: isData,\n    isCell: isCell,\n    isBlockquote: isBlockquote,\n    isBodyContainer: isBodyContainer,\n    isAnchor: isAnchor,\n    isDiv: makePredByNodeName('DIV'),\n    isLi: isLi,\n    isBR: makePredByNodeName('BR'),\n    isSpan: makePredByNodeName('SPAN'),\n    isB: makePredByNodeName('B'),\n    isU: makePredByNodeName('U'),\n    isS: makePredByNodeName('S'),\n    isI: makePredByNodeName('I'),\n    isImg: makePredByNodeName('IMG'),\n    isTextarea: isTextarea,\n    isEmpty: isEmpty,\n    isEmptyAnchor: func.and(isAnchor, isEmpty),\n    isClosestSibling: isClosestSibling,\n    withClosestSiblings: withClosestSiblings,\n    nodeLength: nodeLength,\n    isLeftEdgePoint: isLeftEdgePoint,\n    isRightEdgePoint: isRightEdgePoint,\n    isEdgePoint: isEdgePoint,\n    isLeftEdgeOf: isLeftEdgeOf,\n    isRightEdgeOf: isRightEdgeOf,\n    isLeftEdgePointOf: isLeftEdgePointOf,\n    isRightEdgePointOf: isRightEdgePointOf,\n    prevPoint: prevPoint,\n    nextPoint: nextPoint,\n    isSamePoint: isSamePoint,\n    isVisiblePoint: isVisiblePoint,\n    prevPointUntil: prevPointUntil,\n    nextPointUntil: nextPointUntil,\n    isCharPoint: isCharPoint,\n    walkPoint: walkPoint,\n    ancestor: ancestor,\n    singleChildAncestor: singleChildAncestor,\n    listAncestor: listAncestor,\n    lastAncestor: lastAncestor,\n    listNext: listNext,\n    listPrev: listPrev,\n    listDescendant: listDescendant,\n    commonAncestor: commonAncestor,\n    wrap: wrap,\n    insertAfter: insertAfter,\n    appendChildNodes: appendChildNodes,\n    position: position,\n    hasChildren: hasChildren,\n    makeOffsetPath: makeOffsetPath,\n    fromOffsetPath: fromOffsetPath,\n    splitTree: splitTree,\n    splitPoint: splitPoint,\n    create: create,\n    createText: createText,\n    remove: remove,\n    removeWhile: removeWhile,\n    replace: replace,\n    html: html,\n    value: value,\n    posFromPlaceholder: posFromPlaceholder,\n    attachEvents: attachEvents,\n    detachEvents: detachEvents,\n    isCustomStyleTag: isCustomStyleTag\n};\n\n$$1.summernote = $$1.summernote || {\n    lang: {}\n};\n$$1.extend($$1.summernote.lang, {\n    'en-US': {\n        font: {\n            bold: 'Bold',\n            italic: 'Italic',\n            underline: 'Underline',\n            clear: 'Remove Font Style',\n            height: 'Line Height',\n            name: 'Font Family',\n            strikethrough: 'Strikethrough',\n            subscript: 'Subscript',\n            superscript: 'Superscript',\n            size: 'Font Size'\n        },\n        image: {\n            image: 'Picture',\n            insert: 'Insert Image',\n            resizeFull: 'Resize Full',\n            resizeHalf: 'Resize Half',\n            resizeQuarter: 'Resize Quarter',\n            floatLeft: 'Float Left',\n            floatRight: 'Float Right',\n            floatNone: 'Float None',\n            shapeRounded: 'Shape: Rounded',\n            shapeCircle: 'Shape: Circle',\n            shapeThumbnail: 'Shape: Thumbnail',\n            shapeNone: 'Shape: None',\n            dragImageHere: 'Drag image or text here',\n            dropImage: 'Drop image or Text',\n            selectFromFiles: 'Select from files',\n            maximumFileSize: 'Maximum file size',\n            maximumFileSizeError: 'Maximum file size exceeded.',\n            url: 'Image URL',\n            remove: 'Remove Image',\n            original: 'Original'\n        },\n        video: {\n            video: 'Video',\n            videoLink: 'Video Link',\n            insert: 'Insert Video',\n            url: 'Video URL',\n            providers: '(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)'\n        },\n        link: {\n            link: 'Link',\n            insert: 'Insert Link',\n            unlink: 'Unlink',\n            edit: 'Edit',\n            textToDisplay: 'Text to display',\n            url: 'To what URL should this link go?',\n            openInNewWindow: 'Open in new window'\n        },\n        table: {\n            table: 'Table',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            addColLeft: 'Add column left',\n            addColRight: 'Add column right',\n            delRow: 'Delete row',\n            delCol: 'Delete column',\n            delTable: 'Delete table'\n        },\n        hr: {\n            insert: 'Insert Horizontal Rule'\n        },\n        style: {\n            style: 'Style',\n            p: 'Normal',\n            blockquote: 'Quote',\n            pre: 'Code',\n            h1: 'Header 1',\n            h2: 'Header 2',\n            h3: 'Header 3',\n            h4: 'Header 4',\n            h5: 'Header 5',\n            h6: 'Header 6'\n        },\n        lists: {\n            unordered: 'Unordered list',\n            ordered: 'Ordered list'\n        },\n        options: {\n            help: 'Help',\n            fullscreen: 'Full Screen',\n            codeview: 'Code View'\n        },\n        paragraph: {\n            paragraph: 'Paragraph',\n            outdent: 'Outdent',\n            indent: 'Indent',\n            left: 'Align left',\n            center: 'Align center',\n            right: 'Align right',\n            justify: 'Justify full'\n        },\n        color: {\n            recent: 'Recent Color',\n            more: 'More Color',\n            background: 'Background Color',\n            foreground: 'Foreground Color',\n            transparent: 'Transparent',\n            setTransparent: 'Set transparent',\n            reset: 'Reset',\n            resetToDefault: 'Reset to default'\n        },\n        shortcut: {\n            shortcuts: 'Keyboard shortcuts',\n            close: 'Close',\n            textFormatting: 'Text formatting',\n            action: 'Action',\n            paragraphFormatting: 'Paragraph formatting',\n            documentStyle: 'Document Style',\n            extraKeys: 'Extra keys'\n        },\n        help: {\n            'insertParagraph': 'Insert Paragraph',\n            'undo': 'Undoes the last command',\n            'redo': 'Redoes the last command',\n            'tab': 'Tab',\n            'untab': 'Untab',\n            'bold': 'Set a bold style',\n            'italic': 'Set a italic style',\n            'underline': 'Set a underline style',\n            'strikethrough': 'Set a strikethrough style',\n            'removeFormat': 'Clean a style',\n            'justifyLeft': 'Set left align',\n            'justifyCenter': 'Set center align',\n            'justifyRight': 'Set right align',\n            'justifyFull': 'Set full align',\n            'insertUnorderedList': 'Toggle unordered list',\n            'insertOrderedList': 'Toggle ordered list',\n            'outdent': 'Outdent on current paragraph',\n            'indent': 'Indent on current paragraph',\n            'formatPara': 'Change current block\\'s format as a paragraph(P tag)',\n            'formatH1': 'Change current block\\'s format as H1',\n            'formatH2': 'Change current block\\'s format as H2',\n            'formatH3': 'Change current block\\'s format as H3',\n            'formatH4': 'Change current block\\'s format as H4',\n            'formatH5': 'Change current block\\'s format as H5',\n            'formatH6': 'Change current block\\'s format as H6',\n            'insertHorizontalRule': 'Insert horizontal rule',\n            'linkDialog.show': 'Show Link Dialog'\n        },\n        history: {\n            undo: 'Undo',\n            redo: 'Redo'\n        },\n        specialChar: {\n            specialChar: 'SPECIAL CHARACTERS',\n            select: 'Select Special characters'\n        }\n    }\n});\n\nvar KEY_MAP = {\n    'BACKSPACE': 8,\n    'TAB': 9,\n    'ENTER': 13,\n    'SPACE': 32,\n    'DELETE': 46,\n    // Arrow\n    'LEFT': 37,\n    'UP': 38,\n    'RIGHT': 39,\n    'DOWN': 40,\n    // Number: 0-9\n    'NUM0': 48,\n    'NUM1': 49,\n    'NUM2': 50,\n    'NUM3': 51,\n    'NUM4': 52,\n    'NUM5': 53,\n    'NUM6': 54,\n    'NUM7': 55,\n    'NUM8': 56,\n    // Alphabet: a-z\n    'B': 66,\n    'E': 69,\n    'I': 73,\n    'J': 74,\n    'K': 75,\n    'L': 76,\n    'R': 82,\n    'S': 83,\n    'U': 85,\n    'V': 86,\n    'Y': 89,\n    'Z': 90,\n    'SLASH': 191,\n    'LEFTBRACKET': 219,\n    'BACKSLASH': 220,\n    'RIGHTBRACKET': 221\n};\n/**\n * @class core.key\n *\n * Object for keycodes.\n *\n * @singleton\n * @alternateClassName key\n */\nvar key = {\n    /**\n     * @method isEdit\n     *\n     * @param {Number} keyCode\n     * @return {Boolean}\n     */\n    isEdit: function (keyCode) {\n        return lists.contains([\n            KEY_MAP.BACKSPACE,\n            KEY_MAP.TAB,\n            KEY_MAP.ENTER,\n            KEY_MAP.SPACE,\n            KEY_MAP.DELETE\n        ], keyCode);\n    },\n    /**\n     * @method isMove\n     *\n     * @param {Number} keyCode\n     * @return {Boolean}\n     */\n    isMove: function (keyCode) {\n        return lists.contains([\n            KEY_MAP.LEFT,\n            KEY_MAP.UP,\n            KEY_MAP.RIGHT,\n            KEY_MAP.DOWN\n        ], keyCode);\n    },\n    /**\n     * @property {Object} nameFromCode\n     * @property {String} nameFromCode.8 \"BACKSPACE\"\n     */\n    nameFromCode: func.invertObject(KEY_MAP),\n    code: KEY_MAP\n};\n\n/**\n * return boundaryPoint from TextRange, inspired by Andy Na's HuskyRange.js\n *\n * @param {TextRange} textRange\n * @param {Boolean} isStart\n * @return {BoundaryPoint}\n *\n * @see http://msdn.microsoft.com/en-us/library/ie/ms535872(v=vs.85).aspx\n */\nfunction textRangeToPoint(textRange, isStart) {\n    var container = textRange.parentElement();\n    var offset;\n    var tester = document.body.createTextRange();\n    var prevContainer;\n    var childNodes = lists.from(container.childNodes);\n    for (offset = 0; offset < childNodes.length; offset++) {\n        if (dom.isText(childNodes[offset])) {\n            continue;\n        }\n        tester.moveToElementText(childNodes[offset]);\n        if (tester.compareEndPoints('StartToStart', textRange) >= 0) {\n            break;\n        }\n        prevContainer = childNodes[offset];\n    }\n    if (offset !== 0 && dom.isText(childNodes[offset - 1])) {\n        var textRangeStart = document.body.createTextRange();\n        var curTextNode = null;\n        textRangeStart.moveToElementText(prevContainer || container);\n        textRangeStart.collapse(!prevContainer);\n        curTextNode = prevContainer ? prevContainer.nextSibling : container.firstChild;\n        var pointTester = textRange.duplicate();\n        pointTester.setEndPoint('StartToStart', textRangeStart);\n        var textCount = pointTester.text.replace(/[\\r\\n]/g, '').length;\n        while (textCount > curTextNode.nodeValue.length && curTextNode.nextSibling) {\n            textCount -= curTextNode.nodeValue.length;\n            curTextNode = curTextNode.nextSibling;\n        }\n        // [workaround] enforce IE to re-reference curTextNode, hack\n        var dummy = curTextNode.nodeValue; // eslint-disable-line\n        if (isStart && curTextNode.nextSibling && dom.isText(curTextNode.nextSibling) &&\n            textCount === curTextNode.nodeValue.length) {\n            textCount -= curTextNode.nodeValue.length;\n            curTextNode = curTextNode.nextSibling;\n        }\n        container = curTextNode;\n        offset = textCount;\n    }\n    return {\n        cont: container,\n        offset: offset\n    };\n}\n/**\n * return TextRange from boundary point (inspired by google closure-library)\n * @param {BoundaryPoint} point\n * @return {TextRange}\n */\nfunction pointToTextRange(point) {\n    var textRangeInfo = function (container, offset) {\n        var node, isCollapseToStart;\n        if (dom.isText(container)) {\n            var prevTextNodes = dom.listPrev(container, func.not(dom.isText));\n            var prevContainer = lists.last(prevTextNodes).previousSibling;\n            node = prevContainer || container.parentNode;\n            offset += lists.sum(lists.tail(prevTextNodes), dom.nodeLength);\n            isCollapseToStart = !prevContainer;\n        }\n        else {\n            node = container.childNodes[offset] || container;\n            if (dom.isText(node)) {\n                return textRangeInfo(node, 0);\n            }\n            offset = 0;\n            isCollapseToStart = false;\n        }\n        return {\n            node: node,\n            collapseToStart: isCollapseToStart,\n            offset: offset\n        };\n    };\n    var textRange = document.body.createTextRange();\n    var info = textRangeInfo(point.node, point.offset);\n    textRange.moveToElementText(info.node);\n    textRange.collapse(info.collapseToStart);\n    textRange.moveStart('character', info.offset);\n    return textRange;\n}\n/**\n   * Wrapped Range\n   *\n   * @constructor\n   * @param {Node} sc - start container\n   * @param {Number} so - start offset\n   * @param {Node} ec - end container\n   * @param {Number} eo - end offset\n   */\nvar WrappedRange = /** @class */ (function () {\n    function WrappedRange(sc, so, ec, eo) {\n        this.sc = sc;\n        this.so = so;\n        this.ec = ec;\n        this.eo = eo;\n        // isOnEditable: judge whether range is on editable or not\n        this.isOnEditable = this.makeIsOn(dom.isEditable);\n        // isOnList: judge whether range is on list node or not\n        this.isOnList = this.makeIsOn(dom.isList);\n        // isOnAnchor: judge whether range is on anchor node or not\n        this.isOnAnchor = this.makeIsOn(dom.isAnchor);\n        // isOnCell: judge whether range is on cell node or not\n        this.isOnCell = this.makeIsOn(dom.isCell);\n        // isOnData: judge whether range is on data node or not\n        this.isOnData = this.makeIsOn(dom.isData);\n    }\n    // nativeRange: get nativeRange from sc, so, ec, eo\n    WrappedRange.prototype.nativeRange = function () {\n        if (env.isW3CRangeSupport) {\n            var w3cRange = document.createRange();\n            w3cRange.setStart(this.sc, this.so);\n            w3cRange.setEnd(this.ec, this.eo);\n            return w3cRange;\n        }\n        else {\n            var textRange = pointToTextRange({\n                node: this.sc,\n                offset: this.so\n            });\n            textRange.setEndPoint('EndToEnd', pointToTextRange({\n                node: this.ec,\n                offset: this.eo\n            }));\n            return textRange;\n        }\n    };\n    WrappedRange.prototype.getPoints = function () {\n        return {\n            sc: this.sc,\n            so: this.so,\n            ec: this.ec,\n            eo: this.eo\n        };\n    };\n    WrappedRange.prototype.getStartPoint = function () {\n        return {\n            node: this.sc,\n            offset: this.so\n        };\n    };\n    WrappedRange.prototype.getEndPoint = function () {\n        return {\n            node: this.ec,\n            offset: this.eo\n        };\n    };\n    /**\n     * select update visible range\n     */\n    WrappedRange.prototype.select = function () {\n        var nativeRng = this.nativeRange();\n        if (env.isW3CRangeSupport) {\n            var selection = document.getSelection();\n            if (selection.rangeCount > 0) {\n                selection.removeAllRanges();\n            }\n            selection.addRange(nativeRng);\n        }\n        else {\n            nativeRng.select();\n        }\n        return this;\n    };\n    /**\n     * Moves the scrollbar to start container(sc) of current range\n     *\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.scrollIntoView = function (container) {\n        var height = $$1(container).height();\n        if (container.scrollTop + height < this.sc.offsetTop) {\n            container.scrollTop += Math.abs(container.scrollTop + height - this.sc.offsetTop);\n        }\n        return this;\n    };\n    /**\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.normalize = function () {\n        /**\n         * @param {BoundaryPoint} point\n         * @param {Boolean} isLeftToRight\n         * @return {BoundaryPoint}\n         */\n        var getVisiblePoint = function (point, isLeftToRight) {\n            if ((dom.isVisiblePoint(point) && !dom.isEdgePoint(point)) ||\n                (dom.isVisiblePoint(point) && dom.isRightEdgePoint(point) && !isLeftToRight) ||\n                (dom.isVisiblePoint(point) && dom.isLeftEdgePoint(point) && isLeftToRight) ||\n                (dom.isVisiblePoint(point) && dom.isBlock(point.node) && dom.isEmpty(point.node))) {\n                return point;\n            }\n            // point on block's edge\n            var block = dom.ancestor(point.node, dom.isBlock);\n            if (((dom.isLeftEdgePointOf(point, block) || dom.isVoid(dom.prevPoint(point).node)) && !isLeftToRight) ||\n                ((dom.isRightEdgePointOf(point, block) || dom.isVoid(dom.nextPoint(point).node)) && isLeftToRight)) {\n                // returns point already on visible point\n                if (dom.isVisiblePoint(point)) {\n                    return point;\n                }\n                // reverse direction\n                isLeftToRight = !isLeftToRight;\n            }\n            var nextPoint = isLeftToRight ? dom.nextPointUntil(dom.nextPoint(point), dom.isVisiblePoint)\n                : dom.prevPointUntil(dom.prevPoint(point), dom.isVisiblePoint);\n            return nextPoint || point;\n        };\n        var endPoint = getVisiblePoint(this.getEndPoint(), false);\n        var startPoint = this.isCollapsed() ? endPoint : getVisiblePoint(this.getStartPoint(), true);\n        return new WrappedRange(startPoint.node, startPoint.offset, endPoint.node, endPoint.offset);\n    };\n    /**\n     * returns matched nodes on range\n     *\n     * @param {Function} [pred] - predicate function\n     * @param {Object} [options]\n     * @param {Boolean} [options.includeAncestor]\n     * @param {Boolean} [options.fullyContains]\n     * @return {Node[]}\n     */\n    WrappedRange.prototype.nodes = function (pred, options) {\n        pred = pred || func.ok;\n        var includeAncestor = options && options.includeAncestor;\n        var fullyContains = options && options.fullyContains;\n        // TODO compare points and sort\n        var startPoint = this.getStartPoint();\n        var endPoint = this.getEndPoint();\n        var nodes = [];\n        var leftEdgeNodes = [];\n        dom.walkPoint(startPoint, endPoint, function (point) {\n            if (dom.isEditable(point.node)) {\n                return;\n            }\n            var node;\n            if (fullyContains) {\n                if (dom.isLeftEdgePoint(point)) {\n                    leftEdgeNodes.push(point.node);\n                }\n                if (dom.isRightEdgePoint(point) && lists.contains(leftEdgeNodes, point.node)) {\n                    node = point.node;\n                }\n            }\n            else if (includeAncestor) {\n                node = dom.ancestor(point.node, pred);\n            }\n            else {\n                node = point.node;\n            }\n            if (node && pred(node)) {\n                nodes.push(node);\n            }\n        }, true);\n        return lists.unique(nodes);\n    };\n    /**\n     * returns commonAncestor of range\n     * @return {Element} - commonAncestor\n     */\n    WrappedRange.prototype.commonAncestor = function () {\n        return dom.commonAncestor(this.sc, this.ec);\n    };\n    /**\n     * returns expanded range by pred\n     *\n     * @param {Function} pred - predicate function\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.expand = function (pred) {\n        var startAncestor = dom.ancestor(this.sc, pred);\n        var endAncestor = dom.ancestor(this.ec, pred);\n        if (!startAncestor && !endAncestor) {\n            return new WrappedRange(this.sc, this.so, this.ec, this.eo);\n        }\n        var boundaryPoints = this.getPoints();\n        if (startAncestor) {\n            boundaryPoints.sc = startAncestor;\n            boundaryPoints.so = 0;\n        }\n        if (endAncestor) {\n            boundaryPoints.ec = endAncestor;\n            boundaryPoints.eo = dom.nodeLength(endAncestor);\n        }\n        return new WrappedRange(boundaryPoints.sc, boundaryPoints.so, boundaryPoints.ec, boundaryPoints.eo);\n    };\n    /**\n     * @param {Boolean} isCollapseToStart\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.collapse = function (isCollapseToStart) {\n        if (isCollapseToStart) {\n            return new WrappedRange(this.sc, this.so, this.sc, this.so);\n        }\n        else {\n            return new WrappedRange(this.ec, this.eo, this.ec, this.eo);\n        }\n    };\n    /**\n     * splitText on range\n     */\n    WrappedRange.prototype.splitText = function () {\n        var isSameContainer = this.sc === this.ec;\n        var boundaryPoints = this.getPoints();\n        if (dom.isText(this.ec) && !dom.isEdgePoint(this.getEndPoint())) {\n            this.ec.splitText(this.eo);\n        }\n        if (dom.isText(this.sc) && !dom.isEdgePoint(this.getStartPoint())) {\n            boundaryPoints.sc = this.sc.splitText(this.so);\n            boundaryPoints.so = 0;\n            if (isSameContainer) {\n                boundaryPoints.ec = boundaryPoints.sc;\n                boundaryPoints.eo = this.eo - this.so;\n            }\n        }\n        return new WrappedRange(boundaryPoints.sc, boundaryPoints.so, boundaryPoints.ec, boundaryPoints.eo);\n    };\n    /**\n     * delete contents on range\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.deleteContents = function () {\n        if (this.isCollapsed()) {\n            return this;\n        }\n        var rng = this.splitText();\n        var nodes = rng.nodes(null, {\n            fullyContains: true\n        });\n        // find new cursor point\n        var point = dom.prevPointUntil(rng.getStartPoint(), function (point) {\n            return !lists.contains(nodes, point.node);\n        });\n        var emptyParents = [];\n        $$1.each(nodes, function (idx, node) {\n            // find empty parents\n            var parent = node.parentNode;\n            if (point.node !== parent && dom.nodeLength(parent) === 1) {\n                emptyParents.push(parent);\n            }\n            dom.remove(node, false);\n        });\n        // remove empty parents\n        $$1.each(emptyParents, function (idx, node) {\n            dom.remove(node, false);\n        });\n        return new WrappedRange(point.node, point.offset, point.node, point.offset).normalize();\n    };\n    /**\n     * makeIsOn: return isOn(pred) function\n     */\n    WrappedRange.prototype.makeIsOn = function (pred) {\n        return function () {\n            var ancestor = dom.ancestor(this.sc, pred);\n            return !!ancestor && (ancestor === dom.ancestor(this.ec, pred));\n        };\n    };\n    /**\n     * @param {Function} pred\n     * @return {Boolean}\n     */\n    WrappedRange.prototype.isLeftEdgeOf = function (pred) {\n        if (!dom.isLeftEdgePoint(this.getStartPoint())) {\n            return false;\n        }\n        var node = dom.ancestor(this.sc, pred);\n        return node && dom.isLeftEdgeOf(this.sc, node);\n    };\n    /**\n     * returns whether range was collapsed or not\n     */\n    WrappedRange.prototype.isCollapsed = function () {\n        return this.sc === this.ec && this.so === this.eo;\n    };\n    /**\n     * wrap inline nodes which children of body with paragraph\n     *\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.wrapBodyInlineWithPara = function () {\n        if (dom.isBodyContainer(this.sc) && dom.isEmpty(this.sc)) {\n            this.sc.innerHTML = dom.emptyPara;\n            return new WrappedRange(this.sc.firstChild, 0, this.sc.firstChild, 0);\n        }\n        /**\n         * [workaround] firefox often create range on not visible point. so normalize here.\n         *  - firefox: |<p>text</p>|\n         *  - chrome: <p>|text|</p>\n         */\n        var rng = this.normalize();\n        if (dom.isParaInline(this.sc) || dom.isPara(this.sc)) {\n            return rng;\n        }\n        // find inline top ancestor\n        var topAncestor;\n        if (dom.isInline(rng.sc)) {\n            var ancestors = dom.listAncestor(rng.sc, func.not(dom.isInline));\n            topAncestor = lists.last(ancestors);\n            if (!dom.isInline(topAncestor)) {\n                topAncestor = ancestors[ancestors.length - 2] || rng.sc.childNodes[rng.so];\n            }\n        }\n        else {\n            topAncestor = rng.sc.childNodes[rng.so > 0 ? rng.so - 1 : 0];\n        }\n        // siblings not in paragraph\n        var inlineSiblings = dom.listPrev(topAncestor, dom.isParaInline).reverse();\n        inlineSiblings = inlineSiblings.concat(dom.listNext(topAncestor.nextSibling, dom.isParaInline));\n        // wrap with paragraph\n        if (inlineSiblings.length) {\n            var para = dom.wrap(lists.head(inlineSiblings), 'p');\n            dom.appendChildNodes(para, lists.tail(inlineSiblings));\n        }\n        return this.normalize();\n    };\n    /**\n     * insert node at current cursor\n     *\n     * @param {Node} node\n     * @return {Node}\n     */\n    WrappedRange.prototype.insertNode = function (node) {\n        var rng = this.wrapBodyInlineWithPara().deleteContents();\n        var info = dom.splitPoint(rng.getStartPoint(), dom.isInline(node));\n        if (info.rightNode) {\n            info.rightNode.parentNode.insertBefore(node, info.rightNode);\n        }\n        else {\n            info.container.appendChild(node);\n        }\n        return node;\n    };\n    /**\n     * insert html at current cursor\n     */\n    WrappedRange.prototype.pasteHTML = function (markup) {\n        var contentsContainer = $$1('<div></div>').html(markup)[0];\n        var childNodes = lists.from(contentsContainer.childNodes);\n        var rng = this.wrapBodyInlineWithPara().deleteContents();\n        return childNodes.reverse().map(function (childNode) {\n            return rng.insertNode(childNode);\n        }).reverse();\n    };\n    /**\n     * returns text in range\n     *\n     * @return {String}\n     */\n    WrappedRange.prototype.toString = function () {\n        var nativeRng = this.nativeRange();\n        return env.isW3CRangeSupport ? nativeRng.toString() : nativeRng.text;\n    };\n    /**\n     * returns range for word before cursor\n     *\n     * @param {Boolean} [findAfter] - find after cursor, default: false\n     * @return {WrappedRange}\n     */\n    WrappedRange.prototype.getWordRange = function (findAfter) {\n        var endPoint = this.getEndPoint();\n        if (!dom.isCharPoint(endPoint)) {\n            return this;\n        }\n        var startPoint = dom.prevPointUntil(endPoint, function (point) {\n            return !dom.isCharPoint(point);\n        });\n        if (findAfter) {\n            endPoint = dom.nextPointUntil(endPoint, function (point) {\n                return !dom.isCharPoint(point);\n            });\n        }\n        return new WrappedRange(startPoint.node, startPoint.offset, endPoint.node, endPoint.offset);\n    };\n    /**\n     * create offsetPath bookmark\n     *\n     * @param {Node} editable\n     */\n    WrappedRange.prototype.bookmark = function (editable) {\n        return {\n            s: {\n                path: dom.makeOffsetPath(editable, this.sc),\n                offset: this.so\n            },\n            e: {\n                path: dom.makeOffsetPath(editable, this.ec),\n                offset: this.eo\n            }\n        };\n    };\n    /**\n     * create offsetPath bookmark base on paragraph\n     *\n     * @param {Node[]} paras\n     */\n    WrappedRange.prototype.paraBookmark = function (paras) {\n        return {\n            s: {\n                path: lists.tail(dom.makeOffsetPath(lists.head(paras), this.sc)),\n                offset: this.so\n            },\n            e: {\n                path: lists.tail(dom.makeOffsetPath(lists.last(paras), this.ec)),\n                offset: this.eo\n            }\n        };\n    };\n    /**\n     * getClientRects\n     * @return {Rect[]}\n     */\n    WrappedRange.prototype.getClientRects = function () {\n        var nativeRng = this.nativeRange();\n        return nativeRng.getClientRects();\n    };\n    return WrappedRange;\n}());\n/**\n * Data structure\n *  * BoundaryPoint: a point of dom tree\n *  * BoundaryPoints: two boundaryPoints corresponding to the start and the end of the Range\n *\n * See to http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Position\n */\nvar range = {\n    /**\n     * create Range Object From arguments or Browser Selection\n     *\n     * @param {Node} sc - start container\n     * @param {Number} so - start offset\n     * @param {Node} ec - end container\n     * @param {Number} eo - end offset\n     * @return {WrappedRange}\n     */\n    create: function (sc, so, ec, eo) {\n        if (arguments.length === 4) {\n            return new WrappedRange(sc, so, ec, eo);\n        }\n        else if (arguments.length === 2) {\n            ec = sc;\n            eo = so;\n            return new WrappedRange(sc, so, ec, eo);\n        }\n        else {\n            var wrappedRange = this.createFromSelection();\n            if (!wrappedRange && arguments.length === 1) {\n                wrappedRange = this.createFromNode(arguments[0]);\n                return wrappedRange.collapse(dom.emptyPara === arguments[0].innerHTML);\n            }\n            return wrappedRange;\n        }\n    },\n    createFromSelection: function () {\n        var sc, so, ec, eo;\n        if (env.isW3CRangeSupport) {\n            var selection = document.getSelection();\n            if (!selection || selection.rangeCount === 0) {\n                return null;\n            }\n            else if (dom.isBody(selection.anchorNode)) {\n                // Firefox: returns entire body as range on initialization.\n                // We won't never need it.\n                return null;\n            }\n            var nativeRng = selection.getRangeAt(0);\n            sc = nativeRng.startContainer;\n            so = nativeRng.startOffset;\n            ec = nativeRng.endContainer;\n            eo = nativeRng.endOffset;\n        }\n        else {\n            var textRange = document.selection.createRange();\n            var textRangeEnd = textRange.duplicate();\n            textRangeEnd.collapse(false);\n            var textRangeStart = textRange;\n            textRangeStart.collapse(true);\n            var startPoint = textRangeToPoint(textRangeStart, true);\n            var endPoint = textRangeToPoint(textRangeEnd, false);\n            // same visible point case: range was collapsed.\n            if (dom.isText(startPoint.node) && dom.isLeftEdgePoint(startPoint) &&\n                dom.isTextNode(endPoint.node) && dom.isRightEdgePoint(endPoint) &&\n                endPoint.node.nextSibling === startPoint.node) {\n                startPoint = endPoint;\n            }\n            sc = startPoint.cont;\n            so = startPoint.offset;\n            ec = endPoint.cont;\n            eo = endPoint.offset;\n        }\n        return new WrappedRange(sc, so, ec, eo);\n    },\n    /**\n     * @method\n     *\n     * create WrappedRange from node\n     *\n     * @param {Node} node\n     * @return {WrappedRange}\n     */\n    createFromNode: function (node) {\n        var sc = node;\n        var so = 0;\n        var ec = node;\n        var eo = dom.nodeLength(ec);\n        // browsers can't target a picture or void node\n        if (dom.isVoid(sc)) {\n            so = dom.listPrev(sc).length - 1;\n            sc = sc.parentNode;\n        }\n        if (dom.isBR(ec)) {\n            eo = dom.listPrev(ec).length - 1;\n            ec = ec.parentNode;\n        }\n        else if (dom.isVoid(ec)) {\n            eo = dom.listPrev(ec).length;\n            ec = ec.parentNode;\n        }\n        return this.create(sc, so, ec, eo);\n    },\n    /**\n     * create WrappedRange from node after position\n     *\n     * @param {Node} node\n     * @return {WrappedRange}\n     */\n    createFromNodeBefore: function (node) {\n        return this.createFromNode(node).collapse(true);\n    },\n    /**\n     * create WrappedRange from node after position\n     *\n     * @param {Node} node\n     * @return {WrappedRange}\n     */\n    createFromNodeAfter: function (node) {\n        return this.createFromNode(node).collapse();\n    },\n    /**\n     * @method\n     *\n     * create WrappedRange from bookmark\n     *\n     * @param {Node} editable\n     * @param {Object} bookmark\n     * @return {WrappedRange}\n     */\n    createFromBookmark: function (editable, bookmark) {\n        var sc = dom.fromOffsetPath(editable, bookmark.s.path);\n        var so = bookmark.s.offset;\n        var ec = dom.fromOffsetPath(editable, bookmark.e.path);\n        var eo = bookmark.e.offset;\n        return new WrappedRange(sc, so, ec, eo);\n    },\n    /**\n     * @method\n     *\n     * create WrappedRange from paraBookmark\n     *\n     * @param {Object} bookmark\n     * @param {Node[]} paras\n     * @return {WrappedRange}\n     */\n    createFromParaBookmark: function (bookmark, paras) {\n        var so = bookmark.s.offset;\n        var eo = bookmark.e.offset;\n        var sc = dom.fromOffsetPath(lists.head(paras), bookmark.s.path);\n        var ec = dom.fromOffsetPath(lists.last(paras), bookmark.e.path);\n        return new WrappedRange(sc, so, ec, eo);\n    }\n};\n\n/**\n * @method readFileAsDataURL\n *\n * read contents of file as representing URL\n *\n * @param {File} file\n * @return {Promise} - then: dataUrl\n */\nfunction readFileAsDataURL(file) {\n    return $$1.Deferred(function (deferred) {\n        $$1.extend(new FileReader(), {\n            onload: function (e) {\n                var dataURL = e.target.result;\n                deferred.resolve(dataURL);\n            },\n            onerror: function (err) {\n                deferred.reject(err);\n            }\n        }).readAsDataURL(file);\n    }).promise();\n}\n/**\n * @method createImage\n *\n * create `<image>` from url string\n *\n * @param {String} url\n * @return {Promise} - then: $image\n */\nfunction createImage(url) {\n    return $$1.Deferred(function (deferred) {\n        var $img = $$1('<img>');\n        $img.one('load', function () {\n            $img.off('error abort');\n            deferred.resolve($img);\n        }).one('error abort', function () {\n            $img.off('load').detach();\n            deferred.reject($img);\n        }).css({\n            display: 'none'\n        }).appendTo(document.body).attr('src', url);\n    }).promise();\n}\n\nvar History = /** @class */ (function () {\n    function History($editable) {\n        this.stack = [];\n        this.stackOffset = -1;\n        this.$editable = $editable;\n        this.editable = $editable[0];\n    }\n    History.prototype.makeSnapshot = function () {\n        var rng = range.create(this.editable);\n        var emptyBookmark = { s: { path: [], offset: 0 }, e: { path: [], offset: 0 } };\n        return {\n            contents: this.$editable.html(),\n            bookmark: (rng ? rng.bookmark(this.editable) : emptyBookmark)\n        };\n    };\n    History.prototype.applySnapshot = function (snapshot) {\n        if (snapshot.contents !== null) {\n            this.$editable.html(snapshot.contents);\n        }\n        if (snapshot.bookmark !== null) {\n            range.createFromBookmark(this.editable, snapshot.bookmark).select();\n        }\n    };\n    /**\n    * @method rewind\n    * Rewinds the history stack back to the first snapshot taken.\n    * Leaves the stack intact, so that \"Redo\" can still be used.\n    */\n    History.prototype.rewind = function () {\n        // Create snap shot if not yet recorded\n        if (this.$editable.html() !== this.stack[this.stackOffset].contents) {\n            this.recordUndo();\n        }\n        // Return to the first available snapshot.\n        this.stackOffset = 0;\n        // Apply that snapshot.\n        this.applySnapshot(this.stack[this.stackOffset]);\n    };\n    /**\n    * @method reset\n    * Resets the history stack completely; reverting to an empty editor.\n    */\n    History.prototype.reset = function () {\n        // Clear the stack.\n        this.stack = [];\n        // Restore stackOffset to its original value.\n        this.stackOffset = -1;\n        // Clear the editable area.\n        this.$editable.html('');\n        // Record our first snapshot (of nothing).\n        this.recordUndo();\n    };\n    /**\n     * undo\n     */\n    History.prototype.undo = function () {\n        // Create snap shot if not yet recorded\n        if (this.$editable.html() !== this.stack[this.stackOffset].contents) {\n            this.recordUndo();\n        }\n        if (this.stackOffset > 0) {\n            this.stackOffset--;\n            this.applySnapshot(this.stack[this.stackOffset]);\n        }\n    };\n    /**\n     * redo\n     */\n    History.prototype.redo = function () {\n        if (this.stack.length - 1 > this.stackOffset) {\n            this.stackOffset++;\n            this.applySnapshot(this.stack[this.stackOffset]);\n        }\n    };\n    /**\n     * recorded undo\n     */\n    History.prototype.recordUndo = function () {\n        this.stackOffset++;\n        // Wash out stack after stackOffset\n        if (this.stack.length > this.stackOffset) {\n            this.stack = this.stack.slice(0, this.stackOffset);\n        }\n        // Create new snapshot and push it to the end\n        this.stack.push(this.makeSnapshot());\n    };\n    return History;\n}());\n\nvar Style = /** @class */ (function () {\n    function Style() {\n    }\n    /**\n     * @method jQueryCSS\n     *\n     * [workaround] for old jQuery\n     * passing an array of style properties to .css()\n     * will result in an object of property-value pairs.\n     * (compability with version < 1.9)\n     *\n     * @private\n     * @param  {jQuery} $obj\n     * @param  {Array} propertyNames - An array of one or more CSS properties.\n     * @return {Object}\n     */\n    Style.prototype.jQueryCSS = function ($obj, propertyNames) {\n        if (env.jqueryVersion < 1.9) {\n            var result_1 = {};\n            $$1.each(propertyNames, function (idx, propertyName) {\n                result_1[propertyName] = $obj.css(propertyName);\n            });\n            return result_1;\n        }\n        return $obj.css(propertyNames);\n    };\n    /**\n     * returns style object from node\n     *\n     * @param {jQuery} $node\n     * @return {Object}\n     */\n    Style.prototype.fromNode = function ($node) {\n        var properties = ['font-family', 'font-size', 'text-align', 'list-style-type', 'line-height'];\n        var styleInfo = this.jQueryCSS($node, properties) || {};\n        styleInfo['font-size'] = parseInt(styleInfo['font-size'], 10);\n        return styleInfo;\n    };\n    /**\n     * paragraph level style\n     *\n     * @param {WrappedRange} rng\n     * @param {Object} styleInfo\n     */\n    Style.prototype.stylePara = function (rng, styleInfo) {\n        $$1.each(rng.nodes(dom.isPara, {\n            includeAncestor: true\n        }), function (idx, para) {\n            $$1(para).css(styleInfo);\n        });\n    };\n    /**\n     * insert and returns styleNodes on range.\n     *\n     * @param {WrappedRange} rng\n     * @param {Object} [options] - options for styleNodes\n     * @param {String} [options.nodeName] - default: `SPAN`\n     * @param {Boolean} [options.expandClosestSibling] - default: `false`\n     * @param {Boolean} [options.onlyPartialContains] - default: `false`\n     * @return {Node[]}\n     */\n    Style.prototype.styleNodes = function (rng, options) {\n        rng = rng.splitText();\n        var nodeName = (options && options.nodeName) || 'SPAN';\n        var expandClosestSibling = !!(options && options.expandClosestSibling);\n        var onlyPartialContains = !!(options && options.onlyPartialContains);\n        if (rng.isCollapsed()) {\n            return [rng.insertNode(dom.create(nodeName))];\n        }\n        var pred = dom.makePredByNodeName(nodeName);\n        var nodes = rng.nodes(dom.isText, {\n            fullyContains: true\n        }).map(function (text) {\n            return dom.singleChildAncestor(text, pred) || dom.wrap(text, nodeName);\n        });\n        if (expandClosestSibling) {\n            if (onlyPartialContains) {\n                var nodesInRange_1 = rng.nodes();\n                // compose with partial contains predication\n                pred = func.and(pred, function (node) {\n                    return lists.contains(nodesInRange_1, node);\n                });\n            }\n            return nodes.map(function (node) {\n                var siblings = dom.withClosestSiblings(node, pred);\n                var head = lists.head(siblings);\n                var tails = lists.tail(siblings);\n                $$1.each(tails, function (idx, elem) {\n                    dom.appendChildNodes(head, elem.childNodes);\n                    dom.remove(elem);\n                });\n                return lists.head(siblings);\n            });\n        }\n        else {\n            return nodes;\n        }\n    };\n    /**\n     * get current style on cursor\n     *\n     * @param {WrappedRange} rng\n     * @return {Object} - object contains style properties.\n     */\n    Style.prototype.current = function (rng) {\n        var $cont = $$1(!dom.isElement(rng.sc) ? rng.sc.parentNode : rng.sc);\n        var styleInfo = this.fromNode($cont);\n        // document.queryCommandState for toggle state\n        // [workaround] prevent Firefox nsresult: \"0x80004005 (NS_ERROR_FAILURE)\"\n        try {\n            styleInfo = $$1.extend(styleInfo, {\n                'font-bold': document.queryCommandState('bold') ? 'bold' : 'normal',\n                'font-italic': document.queryCommandState('italic') ? 'italic' : 'normal',\n                'font-underline': document.queryCommandState('underline') ? 'underline' : 'normal',\n                'font-subscript': document.queryCommandState('subscript') ? 'subscript' : 'normal',\n                'font-superscript': document.queryCommandState('superscript') ? 'superscript' : 'normal',\n                'font-strikethrough': document.queryCommandState('strikethrough') ? 'strikethrough' : 'normal',\n                'font-family': document.queryCommandValue('fontname') || styleInfo['font-family']\n            });\n        }\n        catch (e) { }\n        // list-style-type to list-style(unordered, ordered)\n        if (!rng.isOnList()) {\n            styleInfo['list-style'] = 'none';\n        }\n        else {\n            var orderedTypes = ['circle', 'disc', 'disc-leading-zero', 'square'];\n            var isUnordered = $$1.inArray(styleInfo['list-style-type'], orderedTypes) > -1;\n            styleInfo['list-style'] = isUnordered ? 'unordered' : 'ordered';\n        }\n        var para = dom.ancestor(rng.sc, dom.isPara);\n        if (para && para.style['line-height']) {\n            styleInfo['line-height'] = para.style.lineHeight;\n        }\n        else {\n            var lineHeight = parseInt(styleInfo['line-height'], 10) / parseInt(styleInfo['font-size'], 10);\n            styleInfo['line-height'] = lineHeight.toFixed(1);\n        }\n        styleInfo.anchor = rng.isOnAnchor() && dom.ancestor(rng.sc, dom.isAnchor);\n        styleInfo.ancestors = dom.listAncestor(rng.sc, dom.isEditable);\n        styleInfo.range = rng;\n        return styleInfo;\n    };\n    return Style;\n}());\n\nvar Bullet = /** @class */ (function () {\n    function Bullet() {\n    }\n    /**\n     * toggle ordered list\n     */\n    Bullet.prototype.insertOrderedList = function (editable) {\n        this.toggleList('OL', editable);\n    };\n    /**\n     * toggle unordered list\n     */\n    Bullet.prototype.insertUnorderedList = function (editable) {\n        this.toggleList('UL', editable);\n    };\n    /**\n     * indent\n     */\n    Bullet.prototype.indent = function (editable) {\n        var _this = this;\n        var rng = range.create(editable).wrapBodyInlineWithPara();\n        var paras = rng.nodes(dom.isPara, { includeAncestor: true });\n        var clustereds = lists.clusterBy(paras, func.peq2('parentNode'));\n        $$1.each(clustereds, function (idx, paras) {\n            var head = lists.head(paras);\n            if (dom.isLi(head)) {\n                _this.wrapList(paras, head.parentNode.nodeName);\n            }\n            else {\n                $$1.each(paras, function (idx, para) {\n                    $$1(para).css('marginLeft', function (idx, val) {\n                        return (parseInt(val, 10) || 0) + 25;\n                    });\n                });\n            }\n        });\n        rng.select();\n    };\n    /**\n     * outdent\n     */\n    Bullet.prototype.outdent = function (editable) {\n        var _this = this;\n        var rng = range.create(editable).wrapBodyInlineWithPara();\n        var paras = rng.nodes(dom.isPara, { includeAncestor: true });\n        var clustereds = lists.clusterBy(paras, func.peq2('parentNode'));\n        $$1.each(clustereds, function (idx, paras) {\n            var head = lists.head(paras);\n            if (dom.isLi(head)) {\n                _this.releaseList([paras]);\n            }\n            else {\n                $$1.each(paras, function (idx, para) {\n                    $$1(para).css('marginLeft', function (idx, val) {\n                        val = (parseInt(val, 10) || 0);\n                        return val > 25 ? val - 25 : '';\n                    });\n                });\n            }\n        });\n        rng.select();\n    };\n    /**\n     * toggle list\n     *\n     * @param {String} listName - OL or UL\n     */\n    Bullet.prototype.toggleList = function (listName, editable) {\n        var _this = this;\n        var rng = range.create(editable).wrapBodyInlineWithPara();\n        var paras = rng.nodes(dom.isPara, { includeAncestor: true });\n        var bookmark = rng.paraBookmark(paras);\n        var clustereds = lists.clusterBy(paras, func.peq2('parentNode'));\n        // paragraph to list\n        if (lists.find(paras, dom.isPurePara)) {\n            var wrappedParas_1 = [];\n            $$1.each(clustereds, function (idx, paras) {\n                wrappedParas_1 = wrappedParas_1.concat(_this.wrapList(paras, listName));\n            });\n            paras = wrappedParas_1;\n            // list to paragraph or change list style\n        }\n        else {\n            var diffLists = rng.nodes(dom.isList, {\n                includeAncestor: true\n            }).filter(function (listNode) {\n                return !$$1.nodeName(listNode, listName);\n            });\n            if (diffLists.length) {\n                $$1.each(diffLists, function (idx, listNode) {\n                    dom.replace(listNode, listName);\n                });\n            }\n            else {\n                paras = this.releaseList(clustereds, true);\n            }\n        }\n        range.createFromParaBookmark(bookmark, paras).select();\n    };\n    /**\n     * @param {Node[]} paras\n     * @param {String} listName\n     * @return {Node[]}\n     */\n    Bullet.prototype.wrapList = function (paras, listName) {\n        var head = lists.head(paras);\n        var last = lists.last(paras);\n        var prevList = dom.isList(head.previousSibling) && head.previousSibling;\n        var nextList = dom.isList(last.nextSibling) && last.nextSibling;\n        var listNode = prevList || dom.insertAfter(dom.create(listName || 'UL'), last);\n        // P to LI\n        paras = paras.map(function (para) {\n            return dom.isPurePara(para) ? dom.replace(para, 'LI') : para;\n        });\n        // append to list(<ul>, <ol>)\n        dom.appendChildNodes(listNode, paras);\n        if (nextList) {\n            dom.appendChildNodes(listNode, lists.from(nextList.childNodes));\n            dom.remove(nextList);\n        }\n        return paras;\n    };\n    /**\n     * @method releaseList\n     *\n     * @param {Array[]} clustereds\n     * @param {Boolean} isEscapseToBody\n     * @return {Node[]}\n     */\n    Bullet.prototype.releaseList = function (clustereds, isEscapseToBody) {\n        var releasedParas = [];\n        $$1.each(clustereds, function (idx, paras) {\n            var head = lists.head(paras);\n            var last = lists.last(paras);\n            var headList = isEscapseToBody ? dom.lastAncestor(head, dom.isList) : head.parentNode;\n            var lastList = headList.childNodes.length > 1 ? dom.splitTree(headList, {\n                node: last.parentNode,\n                offset: dom.position(last) + 1\n            }, {\n                isSkipPaddingBlankHTML: true\n            }) : null;\n            var middleList = dom.splitTree(headList, {\n                node: head.parentNode,\n                offset: dom.position(head)\n            }, {\n                isSkipPaddingBlankHTML: true\n            });\n            paras = isEscapseToBody ? dom.listDescendant(middleList, dom.isLi)\n                : lists.from(middleList.childNodes).filter(dom.isLi);\n            // LI to P\n            if (isEscapseToBody || !dom.isList(headList.parentNode)) {\n                paras = paras.map(function (para) {\n                    return dom.replace(para, 'P');\n                });\n            }\n            $$1.each(lists.from(paras).reverse(), function (idx, para) {\n                dom.insertAfter(para, headList);\n            });\n            // remove empty lists\n            var rootLists = lists.compact([headList, middleList, lastList]);\n            $$1.each(rootLists, function (idx, rootList) {\n                var listNodes = [rootList].concat(dom.listDescendant(rootList, dom.isList));\n                $$1.each(listNodes.reverse(), function (idx, listNode) {\n                    if (!dom.nodeLength(listNode)) {\n                        dom.remove(listNode, true);\n                    }\n                });\n            });\n            releasedParas = releasedParas.concat(paras);\n        });\n        return releasedParas;\n    };\n    return Bullet;\n}());\n\n/**\n * @class editing.Typing\n *\n * Typing\n *\n */\nvar Typing = /** @class */ (function () {\n    function Typing() {\n        // a Bullet instance to toggle lists off\n        this.bullet = new Bullet();\n    }\n    /**\n     * insert tab\n     *\n     * @param {WrappedRange} rng\n     * @param {Number} tabsize\n     */\n    Typing.prototype.insertTab = function (rng, tabsize) {\n        var tab = dom.createText(new Array(tabsize + 1).join(dom.NBSP_CHAR));\n        rng = rng.deleteContents();\n        rng.insertNode(tab, true);\n        rng = range.create(tab, tabsize);\n        rng.select();\n    };\n    /**\n     * insert paragraph\n     */\n    Typing.prototype.insertParagraph = function (editable) {\n        var rng = range.create(editable);\n        // deleteContents on range.\n        rng = rng.deleteContents();\n        // Wrap range if it needs to be wrapped by paragraph\n        rng = rng.wrapBodyInlineWithPara();\n        // finding paragraph\n        var splitRoot = dom.ancestor(rng.sc, dom.isPara);\n        var nextPara;\n        // on paragraph: split paragraph\n        if (splitRoot) {\n            // if it is an empty line with li\n            if (dom.isEmpty(splitRoot) && dom.isLi(splitRoot)) {\n                // toogle UL/OL and escape\n                this.bullet.toggleList(splitRoot.parentNode.nodeName);\n                return;\n                // if it is an empty line with para on blockquote\n            }\n            else if (dom.isEmpty(splitRoot) && dom.isPara(splitRoot) && dom.isBlockquote(splitRoot.parentNode)) {\n                // escape blockquote\n                dom.insertAfter(splitRoot, splitRoot.parentNode);\n                nextPara = splitRoot;\n                // if new line has content (not a line break)\n            }\n            else {\n                nextPara = dom.splitTree(splitRoot, rng.getStartPoint());\n                var emptyAnchors = dom.listDescendant(splitRoot, dom.isEmptyAnchor);\n                emptyAnchors = emptyAnchors.concat(dom.listDescendant(nextPara, dom.isEmptyAnchor));\n                $$1.each(emptyAnchors, function (idx, anchor) {\n                    dom.remove(anchor);\n                });\n                // replace empty heading, pre or custom-made styleTag with P tag\n                if ((dom.isHeading(nextPara) || dom.isPre(nextPara) || dom.isCustomStyleTag(nextPara)) && dom.isEmpty(nextPara)) {\n                    nextPara = dom.replace(nextPara, 'p');\n                }\n            }\n            // no paragraph: insert empty paragraph\n        }\n        else {\n            var next = rng.sc.childNodes[rng.so];\n            nextPara = $$1(dom.emptyPara)[0];\n            if (next) {\n                rng.sc.insertBefore(nextPara, next);\n            }\n            else {\n                rng.sc.appendChild(nextPara);\n            }\n        }\n        range.create(nextPara, 0).normalize().select().scrollIntoView(editable);\n    };\n    return Typing;\n}());\n\n/**\n * @class Create a virtual table to create what actions to do in change.\n * @param {object} startPoint Cell selected to apply change.\n * @param {enum} where  Where change will be applied Row or Col. Use enum: TableResultAction.where\n * @param {enum} action Action to be applied. Use enum: TableResultAction.requestAction\n * @param {object} domTable Dom element of table to make changes.\n */\nvar TableResultAction = function (startPoint, where, action, domTable) {\n    var _startPoint = { 'colPos': 0, 'rowPos': 0 };\n    var _virtualTable = [];\n    var _actionCellList = [];\n    /// ///////////////////////////////////////////\n    // Private functions\n    /// ///////////////////////////////////////////\n    /**\n     * Set the startPoint of action.\n     */\n    function setStartPoint() {\n        if (!startPoint || !startPoint.tagName || (startPoint.tagName.toLowerCase() !== 'td' && startPoint.tagName.toLowerCase() !== 'th')) {\n            console.error('Impossible to identify start Cell point.', startPoint);\n            return;\n        }\n        _startPoint.colPos = startPoint.cellIndex;\n        if (!startPoint.parentElement || !startPoint.parentElement.tagName || startPoint.parentElement.tagName.toLowerCase() !== 'tr') {\n            console.error('Impossible to identify start Row point.', startPoint);\n            return;\n        }\n        _startPoint.rowPos = startPoint.parentElement.rowIndex;\n    }\n    /**\n     * Define virtual table position info object.\n     *\n     * @param {int} rowIndex Index position in line of virtual table.\n     * @param {int} cellIndex Index position in column of virtual table.\n     * @param {object} baseRow Row affected by this position.\n     * @param {object} baseCell Cell affected by this position.\n     * @param {bool} isSpan Inform if it is an span cell/row.\n     */\n    function setVirtualTablePosition(rowIndex, cellIndex, baseRow, baseCell, isRowSpan, isColSpan, isVirtualCell) {\n        var objPosition = {\n            'baseRow': baseRow,\n            'baseCell': baseCell,\n            'isRowSpan': isRowSpan,\n            'isColSpan': isColSpan,\n            'isVirtual': isVirtualCell\n        };\n        if (!_virtualTable[rowIndex]) {\n            _virtualTable[rowIndex] = [];\n        }\n        _virtualTable[rowIndex][cellIndex] = objPosition;\n    }\n    /**\n     * Create action cell object.\n     *\n     * @param {object} virtualTableCellObj Object of specific position on virtual table.\n     * @param {enum} resultAction Action to be applied in that item.\n     */\n    function getActionCell(virtualTableCellObj, resultAction, virtualRowPosition, virtualColPosition) {\n        return {\n            'baseCell': virtualTableCellObj.baseCell,\n            'action': resultAction,\n            'virtualTable': {\n                'rowIndex': virtualRowPosition,\n                'cellIndex': virtualColPosition\n            }\n        };\n    }\n    /**\n     * Recover free index of row to append Cell.\n     *\n     * @param {int} rowIndex Index of row to find free space.\n     * @param {int} cellIndex Index of cell to find free space in table.\n     */\n    function recoverCellIndex(rowIndex, cellIndex) {\n        if (!_virtualTable[rowIndex]) {\n            return cellIndex;\n        }\n        if (!_virtualTable[rowIndex][cellIndex]) {\n            return cellIndex;\n        }\n        var newCellIndex = cellIndex;\n        while (_virtualTable[rowIndex][newCellIndex]) {\n            newCellIndex++;\n            if (!_virtualTable[rowIndex][newCellIndex]) {\n                return newCellIndex;\n            }\n        }\n    }\n    /**\n     * Recover info about row and cell and add information to virtual table.\n     *\n     * @param {object} row Row to recover information.\n     * @param {object} cell Cell to recover information.\n     */\n    function addCellInfoToVirtual(row, cell) {\n        var cellIndex = recoverCellIndex(row.rowIndex, cell.cellIndex);\n        var cellHasColspan = (cell.colSpan > 1);\n        var cellHasRowspan = (cell.rowSpan > 1);\n        var isThisSelectedCell = (row.rowIndex === _startPoint.rowPos && cell.cellIndex === _startPoint.colPos);\n        setVirtualTablePosition(row.rowIndex, cellIndex, row, cell, cellHasRowspan, cellHasColspan, false);\n        // Add span rows to virtual Table.\n        var rowspanNumber = cell.attributes.rowSpan ? parseInt(cell.attributes.rowSpan.value, 10) : 0;\n        if (rowspanNumber > 1) {\n            for (var rp = 1; rp < rowspanNumber; rp++) {\n                var rowspanIndex = row.rowIndex + rp;\n                adjustStartPoint(rowspanIndex, cellIndex, cell, isThisSelectedCell);\n                setVirtualTablePosition(rowspanIndex, cellIndex, row, cell, true, cellHasColspan, true);\n            }\n        }\n        // Add span cols to virtual table.\n        var colspanNumber = cell.attributes.colSpan ? parseInt(cell.attributes.colSpan.value, 10) : 0;\n        if (colspanNumber > 1) {\n            for (var cp = 1; cp < colspanNumber; cp++) {\n                var cellspanIndex = recoverCellIndex(row.rowIndex, (cellIndex + cp));\n                adjustStartPoint(row.rowIndex, cellspanIndex, cell, isThisSelectedCell);\n                setVirtualTablePosition(row.rowIndex, cellspanIndex, row, cell, cellHasRowspan, true, true);\n            }\n        }\n    }\n    /**\n     * Process validation and adjust of start point if needed\n     *\n     * @param {int} rowIndex\n     * @param {int} cellIndex\n     * @param {object} cell\n     * @param {bool} isSelectedCell\n     */\n    function adjustStartPoint(rowIndex, cellIndex, cell, isSelectedCell) {\n        if (rowIndex === _startPoint.rowPos && _startPoint.colPos >= cell.cellIndex && cell.cellIndex <= cellIndex && !isSelectedCell) {\n            _startPoint.colPos++;\n        }\n    }\n    /**\n     * Create virtual table of cells with all cells, including span cells.\n     */\n    function createVirtualTable() {\n        var rows = domTable.rows;\n        for (var rowIndex = 0; rowIndex < rows.length; rowIndex++) {\n            var cells = rows[rowIndex].cells;\n            for (var cellIndex = 0; cellIndex < cells.length; cellIndex++) {\n                addCellInfoToVirtual(rows[rowIndex], cells[cellIndex]);\n            }\n        }\n    }\n    /**\n     * Get action to be applied on the cell.\n     *\n     * @param {object} cell virtual table cell to apply action\n     */\n    function getDeleteResultActionToCell(cell) {\n        switch (where) {\n            case TableResultAction.where.Column:\n                if (cell.isColSpan) {\n                    return TableResultAction.resultAction.SubtractSpanCount;\n                }\n                break;\n            case TableResultAction.where.Row:\n                if (!cell.isVirtual && cell.isRowSpan) {\n                    return TableResultAction.resultAction.AddCell;\n                }\n                else if (cell.isRowSpan) {\n                    return TableResultAction.resultAction.SubtractSpanCount;\n                }\n                break;\n        }\n        return TableResultAction.resultAction.RemoveCell;\n    }\n    /**\n     * Get action to be applied on the cell.\n     *\n     * @param {object} cell virtual table cell to apply action\n     */\n    function getAddResultActionToCell(cell) {\n        switch (where) {\n            case TableResultAction.where.Column:\n                if (cell.isColSpan) {\n                    return TableResultAction.resultAction.SumSpanCount;\n                }\n                else if (cell.isRowSpan && cell.isVirtual) {\n                    return TableResultAction.resultAction.Ignore;\n                }\n                break;\n            case TableResultAction.where.Row:\n                if (cell.isRowSpan) {\n                    return TableResultAction.resultAction.SumSpanCount;\n                }\n                else if (cell.isColSpan && cell.isVirtual) {\n                    return TableResultAction.resultAction.Ignore;\n                }\n                break;\n        }\n        return TableResultAction.resultAction.AddCell;\n    }\n    function init() {\n        setStartPoint();\n        createVirtualTable();\n    }\n    /// ///////////////////////////////////////////\n    // Public functions\n    /// ///////////////////////////////////////////\n    /**\n     * Recover array os what to do in table.\n     */\n    this.getActionList = function () {\n        var fixedRow = (where === TableResultAction.where.Row) ? _startPoint.rowPos : -1;\n        var fixedCol = (where === TableResultAction.where.Column) ? _startPoint.colPos : -1;\n        var actualPosition = 0;\n        var canContinue = true;\n        while (canContinue) {\n            var rowPosition = (fixedRow >= 0) ? fixedRow : actualPosition;\n            var colPosition = (fixedCol >= 0) ? fixedCol : actualPosition;\n            var row = _virtualTable[rowPosition];\n            if (!row) {\n                canContinue = false;\n                return _actionCellList;\n            }\n            var cell = row[colPosition];\n            if (!cell) {\n                canContinue = false;\n                return _actionCellList;\n            }\n            // Define action to be applied in this cell\n            var resultAction = TableResultAction.resultAction.Ignore;\n            switch (action) {\n                case TableResultAction.requestAction.Add:\n                    resultAction = getAddResultActionToCell(cell);\n                    break;\n                case TableResultAction.requestAction.Delete:\n                    resultAction = getDeleteResultActionToCell(cell);\n                    break;\n            }\n            _actionCellList.push(getActionCell(cell, resultAction, rowPosition, colPosition));\n            actualPosition++;\n        }\n        return _actionCellList;\n    };\n    init();\n};\n/**\n*\n* Where action occours enum.\n*/\nTableResultAction.where = { 'Row': 0, 'Column': 1 };\n/**\n*\n* Requested action to apply enum.\n*/\nTableResultAction.requestAction = { 'Add': 0, 'Delete': 1 };\n/**\n*\n* Result action to be executed enum.\n*/\nTableResultAction.resultAction = { 'Ignore': 0, 'SubtractSpanCount': 1, 'RemoveCell': 2, 'AddCell': 3, 'SumSpanCount': 4 };\n/**\n *\n * @class editing.Table\n *\n * Table\n *\n */\nvar Table = /** @class */ (function () {\n    function Table() {\n    }\n    /**\n     * handle tab key\n     *\n     * @param {WrappedRange} rng\n     * @param {Boolean} isShift\n     */\n    Table.prototype.tab = function (rng, isShift) {\n        var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n        var table = dom.ancestor(cell, dom.isTable);\n        var cells = dom.listDescendant(table, dom.isCell);\n        var nextCell = lists[isShift ? 'prev' : 'next'](cells, cell);\n        if (nextCell) {\n            range.create(nextCell, 0).select();\n        }\n    };\n    /**\n     * Add a new row\n     *\n     * @param {WrappedRange} rng\n     * @param {String} position (top/bottom)\n     * @return {Node}\n     */\n    Table.prototype.addRow = function (rng, position) {\n        var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n        var currentTr = $$1(cell).closest('tr');\n        var trAttributes = this.recoverAttributes(currentTr);\n        var html = $$1('<tr' + trAttributes + '></tr>');\n        var vTable = new TableResultAction(cell, TableResultAction.where.Row, TableResultAction.requestAction.Add, $$1(currentTr).closest('table')[0]);\n        var actions = vTable.getActionList();\n        for (var idCell = 0; idCell < actions.length; idCell++) {\n            var currentCell = actions[idCell];\n            var tdAttributes = this.recoverAttributes(currentCell.baseCell);\n            switch (currentCell.action) {\n                case TableResultAction.resultAction.AddCell:\n                    html.append('<td' + tdAttributes + '>' + dom.blank + '</td>');\n                    break;\n                case TableResultAction.resultAction.SumSpanCount:\n                    if (position === 'top') {\n                        var baseCellTr = currentCell.baseCell.parent;\n                        var isTopFromRowSpan = (!baseCellTr ? 0 : currentCell.baseCell.closest('tr').rowIndex) <= currentTr[0].rowIndex;\n                        if (isTopFromRowSpan) {\n                            var newTd = $$1('<div></div>').append($$1('<td' + tdAttributes + '>' + dom.blank + '</td>').removeAttr('rowspan')).html();\n                            html.append(newTd);\n                            break;\n                        }\n                    }\n                    var rowspanNumber = parseInt(currentCell.baseCell.rowSpan, 10);\n                    rowspanNumber++;\n                    currentCell.baseCell.setAttribute('rowSpan', rowspanNumber);\n                    break;\n            }\n        }\n        if (position === 'top') {\n            currentTr.before(html);\n        }\n        else {\n            var cellHasRowspan = (cell.rowSpan > 1);\n            if (cellHasRowspan) {\n                var lastTrIndex = currentTr[0].rowIndex + (cell.rowSpan - 2);\n                $$1($$1(currentTr).parent().find('tr')[lastTrIndex]).after($$1(html));\n                return;\n            }\n            currentTr.after(html);\n        }\n    };\n    /**\n     * Add a new col\n     *\n     * @param {WrappedRange} rng\n     * @param {String} position (left/right)\n     * @return {Node}\n     */\n    Table.prototype.addCol = function (rng, position) {\n        var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n        var row = $$1(cell).closest('tr');\n        var rowsGroup = $$1(row).siblings();\n        rowsGroup.push(row);\n        var vTable = new TableResultAction(cell, TableResultAction.where.Column, TableResultAction.requestAction.Add, $$1(row).closest('table')[0]);\n        var actions = vTable.getActionList();\n        for (var actionIndex = 0; actionIndex < actions.length; actionIndex++) {\n            var currentCell = actions[actionIndex];\n            var tdAttributes = this.recoverAttributes(currentCell.baseCell);\n            switch (currentCell.action) {\n                case TableResultAction.resultAction.AddCell:\n                    if (position === 'right') {\n                        $$1(currentCell.baseCell).after('<td' + tdAttributes + '>' + dom.blank + '</td>');\n                    }\n                    else {\n                        $$1(currentCell.baseCell).before('<td' + tdAttributes + '>' + dom.blank + '</td>');\n                    }\n                    break;\n                case TableResultAction.resultAction.SumSpanCount:\n                    if (position === 'right') {\n                        var colspanNumber = parseInt(currentCell.baseCell.colSpan, 10);\n                        colspanNumber++;\n                        currentCell.baseCell.setAttribute('colSpan', colspanNumber);\n                    }\n                    else {\n                        $$1(currentCell.baseCell).before('<td' + tdAttributes + '>' + dom.blank + '</td>');\n                    }\n                    break;\n            }\n        }\n    };\n    /*\n    * Copy attributes from element.\n    *\n    * @param {object} Element to recover attributes.\n    * @return {string} Copied string elements.\n    */\n    Table.prototype.recoverAttributes = function (el) {\n        var resultStr = '';\n        if (!el) {\n            return resultStr;\n        }\n        var attrList = el.attributes || [];\n        for (var i = 0; i < attrList.length; i++) {\n            if (attrList[i].name.toLowerCase() === 'id') {\n                continue;\n            }\n            if (attrList[i].specified) {\n                resultStr += ' ' + attrList[i].name + '=\\'' + attrList[i].value + '\\'';\n            }\n        }\n        return resultStr;\n    };\n    /**\n     * Delete current row\n     *\n     * @param {WrappedRange} rng\n     * @return {Node}\n     */\n    Table.prototype.deleteRow = function (rng) {\n        var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n        var row = $$1(cell).closest('tr');\n        var cellPos = row.children('td, th').index($$1(cell));\n        var rowPos = row[0].rowIndex;\n        var vTable = new TableResultAction(cell, TableResultAction.where.Row, TableResultAction.requestAction.Delete, $$1(row).closest('table')[0]);\n        var actions = vTable.getActionList();\n        for (var actionIndex = 0; actionIndex < actions.length; actionIndex++) {\n            if (!actions[actionIndex]) {\n                continue;\n            }\n            var baseCell = actions[actionIndex].baseCell;\n            var virtualPosition = actions[actionIndex].virtualTable;\n            var hasRowspan = (baseCell.rowSpan && baseCell.rowSpan > 1);\n            var rowspanNumber = (hasRowspan) ? parseInt(baseCell.rowSpan, 10) : 0;\n            switch (actions[actionIndex].action) {\n                case TableResultAction.resultAction.Ignore:\n                    continue;\n                case TableResultAction.resultAction.AddCell:\n                    var nextRow = row.next('tr')[0];\n                    if (!nextRow) {\n                        continue;\n                    }\n                    var cloneRow = row[0].cells[cellPos];\n                    if (hasRowspan) {\n                        if (rowspanNumber > 2) {\n                            rowspanNumber--;\n                            nextRow.insertBefore(cloneRow, nextRow.cells[cellPos]);\n                            nextRow.cells[cellPos].setAttribute('rowSpan', rowspanNumber);\n                            nextRow.cells[cellPos].innerHTML = '';\n                        }\n                        else if (rowspanNumber === 2) {\n                            nextRow.insertBefore(cloneRow, nextRow.cells[cellPos]);\n                            nextRow.cells[cellPos].removeAttribute('rowSpan');\n                            nextRow.cells[cellPos].innerHTML = '';\n                        }\n                    }\n                    continue;\n                case TableResultAction.resultAction.SubtractSpanCount:\n                    if (hasRowspan) {\n                        if (rowspanNumber > 2) {\n                            rowspanNumber--;\n                            baseCell.setAttribute('rowSpan', rowspanNumber);\n                            if (virtualPosition.rowIndex !== rowPos && baseCell.cellIndex === cellPos) {\n                                baseCell.innerHTML = '';\n                            }\n                        }\n                        else if (rowspanNumber === 2) {\n                            baseCell.removeAttribute('rowSpan');\n                            if (virtualPosition.rowIndex !== rowPos && baseCell.cellIndex === cellPos) {\n                                baseCell.innerHTML = '';\n                            }\n                        }\n                    }\n                    continue;\n                case TableResultAction.resultAction.RemoveCell:\n                    // Do not need remove cell because row will be deleted.\n                    continue;\n            }\n        }\n        row.remove();\n    };\n    /**\n     * Delete current col\n     *\n     * @param {WrappedRange} rng\n     * @return {Node}\n     */\n    Table.prototype.deleteCol = function (rng) {\n        var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n        var row = $$1(cell).closest('tr');\n        var cellPos = row.children('td, th').index($$1(cell));\n        var vTable = new TableResultAction(cell, TableResultAction.where.Column, TableResultAction.requestAction.Delete, $$1(row).closest('table')[0]);\n        var actions = vTable.getActionList();\n        for (var actionIndex = 0; actionIndex < actions.length; actionIndex++) {\n            if (!actions[actionIndex]) {\n                continue;\n            }\n            switch (actions[actionIndex].action) {\n                case TableResultAction.resultAction.Ignore:\n                    continue;\n                case TableResultAction.resultAction.SubtractSpanCount:\n                    var baseCell = actions[actionIndex].baseCell;\n                    var hasColspan = (baseCell.colSpan && baseCell.colSpan > 1);\n                    if (hasColspan) {\n                        var colspanNumber = (baseCell.colSpan) ? parseInt(baseCell.colSpan, 10) : 0;\n                        if (colspanNumber > 2) {\n                            colspanNumber--;\n                            baseCell.setAttribute('colSpan', colspanNumber);\n                            if (baseCell.cellIndex === cellPos) {\n                                baseCell.innerHTML = '';\n                            }\n                        }\n                        else if (colspanNumber === 2) {\n                            baseCell.removeAttribute('colSpan');\n                            if (baseCell.cellIndex === cellPos) {\n                                baseCell.innerHTML = '';\n                            }\n                        }\n                    }\n                    continue;\n                case TableResultAction.resultAction.RemoveCell:\n                    dom.remove(actions[actionIndex].baseCell, true);\n                    continue;\n            }\n        }\n    };\n    /**\n     * create empty table element\n     *\n     * @param {Number} rowCount\n     * @param {Number} colCount\n     * @return {Node}\n     */\n    Table.prototype.createTable = function (colCount, rowCount, options) {\n        var tds = [];\n        var tdHTML;\n        for (var idxCol = 0; idxCol < colCount; idxCol++) {\n            tds.push('<td>' + dom.blank + '</td>');\n        }\n        tdHTML = tds.join('');\n        var trs = [];\n        var trHTML;\n        for (var idxRow = 0; idxRow < rowCount; idxRow++) {\n            trs.push('<tr>' + tdHTML + '</tr>');\n        }\n        trHTML = trs.join('');\n        var $table = $$1('<table>' + trHTML + '</table>');\n        if (options && options.tableClassName) {\n            $table.addClass(options.tableClassName);\n        }\n        return $table[0];\n    };\n    /**\n     * Delete current table\n     *\n     * @param {WrappedRange} rng\n     * @return {Node}\n     */\n    Table.prototype.deleteTable = function (rng) {\n        var cell = dom.ancestor(rng.commonAncestor(), dom.isCell);\n        $$1(cell).closest('table').remove();\n    };\n    return Table;\n}());\n\nvar KEY_BOGUS = 'bogus';\n/**\n * @class Editor\n */\nvar Editor = /** @class */ (function () {\n    function Editor(context) {\n        var _this = this;\n        this.context = context;\n        this.$note = context.layoutInfo.note;\n        this.$editor = context.layoutInfo.editor;\n        this.$editable = context.layoutInfo.editable;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n        this.editable = this.$editable[0];\n        this.lastRange = null;\n        this.style = new Style();\n        this.table = new Table();\n        this.typing = new Typing();\n        this.bullet = new Bullet();\n        this.history = new History(this.$editable);\n        this.context.memo('help.undo', this.lang.help.undo);\n        this.context.memo('help.redo', this.lang.help.redo);\n        this.context.memo('help.tab', this.lang.help.tab);\n        this.context.memo('help.untab', this.lang.help.untab);\n        this.context.memo('help.insertParagraph', this.lang.help.insertParagraph);\n        this.context.memo('help.insertOrderedList', this.lang.help.insertOrderedList);\n        this.context.memo('help.insertUnorderedList', this.lang.help.insertUnorderedList);\n        this.context.memo('help.indent', this.lang.help.indent);\n        this.context.memo('help.outdent', this.lang.help.outdent);\n        this.context.memo('help.formatPara', this.lang.help.formatPara);\n        this.context.memo('help.insertHorizontalRule', this.lang.help.insertHorizontalRule);\n        this.context.memo('help.fontName', this.lang.help.fontName);\n        // native commands(with execCommand), generate function for execCommand\n        var commands = [\n            'bold', 'italic', 'underline', 'strikethrough', 'superscript', 'subscript',\n            'justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull',\n            'formatBlock', 'removeFormat', 'backColor'\n        ];\n        for (var idx = 0, len = commands.length; idx < len; idx++) {\n            this[commands[idx]] = (function (sCmd) {\n                return function (value) {\n                    _this.beforeCommand();\n                    document.execCommand(sCmd, false, value);\n                    _this.afterCommand(true);\n                };\n            })(commands[idx]);\n            this.context.memo('help.' + commands[idx], this.lang.help[commands[idx]]);\n        }\n        this.fontName = this.wrapCommand(function (value) {\n            return _this.fontStyling('font-family', \"\\'\" + value + \"\\'\");\n        });\n        this.fontSize = this.wrapCommand(function (value) {\n            return _this.fontStyling('font-size', value + 'px');\n        });\n        for (var idx = 1; idx <= 6; idx++) {\n            this['formatH' + idx] = (function (idx) {\n                return function () {\n                    _this.formatBlock('H' + idx);\n                };\n            })(idx);\n            this.context.memo('help.formatH' + idx, this.lang.help['formatH' + idx]);\n        }\n        \n        this.insertParagraph = this.wrapCommand(function () {\n            _this.typing.insertParagraph(_this.editable);\n        });\n        this.insertOrderedList = this.wrapCommand(function () {\n            _this.bullet.insertOrderedList(_this.editable);\n        });\n        this.insertUnorderedList = this.wrapCommand(function () {\n            _this.bullet.insertUnorderedList(_this.editable);\n        });\n        this.indent = this.wrapCommand(function () {\n            _this.bullet.indent(_this.editable);\n        });\n        this.outdent = this.wrapCommand(function () {\n            _this.bullet.outdent(_this.editable);\n        });\n        /**\n         * insertNode\n         * insert node\n         * @param {Node} node\n         */\n        this.insertNode = this.wrapCommand(function (node) {\n            if (_this.isLimited($$1(node).text().length)) {\n                return;\n            }\n            var rng = _this.createRange();\n            rng.insertNode(node);\n            range.createFromNodeAfter(node).select();\n        });\n        /**\n         * insert text\n         * @param {String} text\n         */\n        this.insertText = this.wrapCommand(function (text) {\n            if (_this.isLimited(text.length)) {\n                return;\n            }\n            var rng = _this.createRange();\n            var textNode = rng.insertNode(dom.createText(text));\n            range.create(textNode, dom.nodeLength(textNode)).select();\n        });\n        /**\n         * paste HTML\n         * @param {String} markup\n         */\n        this.pasteHTML = this.wrapCommand(function (markup) {\n            if (_this.isLimited(markup.length)) {\n                return;\n            }\n            var contents = _this.createRange().pasteHTML(markup);\n            range.createFromNodeAfter(lists.last(contents)).select();\n        });\n        /**\n         * formatBlock\n         *\n         * @param {String} tagName\n         */\n        this.formatBlock = this.wrapCommand(function (tagName, $target) {\n            var onApplyCustomStyle = _this.options.callbacks.onApplyCustomStyle;\n            if (onApplyCustomStyle) {\n                onApplyCustomStyle.call(_this, $target, _this.context, _this.onFormatBlock);\n            }\n            else {\n                _this.onFormatBlock(tagName, $target);\n            }\n        });\n        /**\n         * insert horizontal rule\n         */\n        this.insertHorizontalRule = this.wrapCommand(function () {\n            var hrNode = _this.createRange().insertNode(dom.create('HR'));\n            if (hrNode.nextSibling) {\n                range.create(hrNode.nextSibling, 0).normalize().select();\n            }\n        });\n        /**\n         * lineHeight\n         * @param {String} value\n         */\n        this.lineHeight = this.wrapCommand(function (value) {\n            _this.style.stylePara(_this.createRange(), {\n                lineHeight: value\n            });\n        });\n        /**\n         * create link (command)\n         *\n         * @param {Object} linkInfo\n         */\n        this.createLink = this.wrapCommand(function (linkInfo) {\n            var linkUrl = linkInfo.url;\n            var linkText = linkInfo.text;\n            var isNewWindow = linkInfo.isNewWindow;\n            var rng = linkInfo.range || _this.createRange();\n            var isTextChanged = rng.toString() !== linkText;\n            // handle spaced urls from input\n            if (typeof linkUrl === 'string') {\n                linkUrl = linkUrl.trim();\n            }\n            if (_this.options.onCreateLink) {\n                linkUrl = _this.options.onCreateLink(linkUrl);\n            }\n            else {\n                // if url doesn't match an URL schema, set http:// as default\n                linkUrl = /^[A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?/.test(linkUrl)\n                    ? linkUrl : 'http://' + linkUrl;\n            }\n            var anchors = [];\n            if (isTextChanged) {\n                rng = rng.deleteContents();\n                var anchor = rng.insertNode($$1('<A>' + linkText + '</A>')[0]);\n                anchors.push(anchor);\n            }\n            else {\n                anchors = _this.style.styleNodes(rng, {\n                    nodeName: 'A',\n                    expandClosestSibling: true,\n                    onlyPartialContains: true\n                });\n            }\n            $$1.each(anchors, function (idx, anchor) {\n                $$1(anchor).attr('href', linkUrl);\n                if (isNewWindow) {\n                    $$1(anchor).attr('target', '_blank');\n                }\n                else {\n                    $$1(anchor).removeAttr('target');\n                }\n            });\n            var startRange = range.createFromNodeBefore(lists.head(anchors));\n            var startPoint = startRange.getStartPoint();\n            var endRange = range.createFromNodeAfter(lists.last(anchors));\n            var endPoint = endRange.getEndPoint();\n            range.create(startPoint.node, startPoint.offset, endPoint.node, endPoint.offset).select();\n        });\n        /**\n         * setting color\n         *\n         * @param {Object} sObjColor  color code\n         * @param {String} sObjColor.foreColor foreground color\n         * @param {String} sObjColor.backColor background color\n         */\n        this.color = this.wrapCommand(function (colorInfo) {\n            var foreColor = colorInfo.foreColor;\n            var backColor = colorInfo.backColor;\n            if (foreColor) {\n                document.execCommand('foreColor', false, foreColor);\n            }\n            if (backColor) {\n                document.execCommand('backColor', false, backColor);\n            }\n        });\n        /**\n         * Set foreground color\n         *\n         * @param {String} colorCode foreground color code\n         */\n        this.foreColor = this.wrapCommand(function (colorInfo) {\n            document.execCommand('styleWithCSS', false, true);\n            document.execCommand('foreColor', false, colorInfo);\n        });\n        /**\n         * insert Table\n         *\n         * @param {String} dimension of table (ex : \"5x5\")\n         */\n        this.insertTable = this.wrapCommand(function (dim) {\n            var dimension = dim.split('x');\n            var rng = _this.createRange().deleteContents();\n            rng.insertNode(_this.table.createTable(dimension[0], dimension[1], _this.options));\n        });\n        /**\n         * remove media object and Figure Elements if media object is img with Figure.\n         */\n        this.removeMedia = this.wrapCommand(function () {\n            var $target = $$1(_this.restoreTarget()).parent();\n            if ($target.parent('figure').length) {\n                $target.parent('figure').remove();\n            }\n            else {\n                $target = $$1(_this.restoreTarget()).detach();\n            }\n            _this.context.triggerEvent('media.delete', $target, _this.$editable);\n        });\n        /**\n         * float me\n         *\n         * @param {String} value\n         */\n        this.floatMe = this.wrapCommand(function (value) {\n            var $target = $$1(_this.restoreTarget());\n            $target.toggleClass('note-float-left', value === 'left');\n            $target.toggleClass('note-float-right', value === 'right');\n            $target.css('float', value);\n        });\n        /**\n         * resize overlay element\n         * @param {String} value\n         */\n        this.resize = this.wrapCommand(function (value) {\n            var $target = $$1(_this.restoreTarget());\n            $target.css({\n                width: value * 100 + '%',\n                height: ''\n            });\n        });\n    }\n    Editor.prototype.initialize = function () {\n        var _this = this;\n        // bind custom events\n        this.$editable.on('keydown', function (event) {\n            if (event.keyCode === key.code.ENTER) {\n                _this.context.triggerEvent('enter', event);\n            }\n            _this.context.triggerEvent('keydown', event);\n            if (!event.isDefaultPrevented()) {\n                if (_this.options.shortcuts) {\n                    _this.handleKeyMap(event);\n                }\n                else {\n                    _this.preventDefaultEditableShortCuts(event);\n                }\n            }\n            if (_this.isLimited(1, event)) {\n                return false;\n            }\n        }).on('keyup', function (event) {\n            _this.context.triggerEvent('keyup', event);\n        }).on('focus', function (event) {\n            _this.context.triggerEvent('focus', event);\n        }).on('blur', function (event) {\n            _this.context.triggerEvent('blur', event);\n        }).on('mousedown', function (event) {\n            _this.context.triggerEvent('mousedown', event);\n        }).on('mouseup', function (event) {\n            _this.context.triggerEvent('mouseup', event);\n        }).on('scroll', function (event) {\n            _this.context.triggerEvent('scroll', event);\n        }).on('paste', function (event) {\n            _this.context.triggerEvent('paste', event);\n        });\n        // init content before set event\n        this.$editable.html(dom.html(this.$note) || dom.emptyPara);\n        this.$editable.on(env.inputEventName, func.debounce(function () {\n            _this.context.triggerEvent('change', _this.$editable.html());\n        }, 100));\n        this.$editor.on('focusin', function (event) {\n            _this.context.triggerEvent('focusin', event);\n        }).on('focusout', function (event) {\n            _this.context.triggerEvent('focusout', event);\n        });\n        if (!this.options.airMode) {\n            if (this.options.width) {\n                this.$editor.outerWidth(this.options.width);\n            }\n            if (this.options.height) {\n                this.$editable.outerHeight(this.options.height);\n            }\n            if (this.options.maxHeight) {\n                this.$editable.css('max-height', this.options.maxHeight);\n            }\n            if (this.options.minHeight) {\n                this.$editable.css('min-height', this.options.minHeight);\n            }\n        }\n        this.history.recordUndo();\n    };\n    Editor.prototype.destroy = function () {\n        this.$editable.off();\n    };\n    Editor.prototype.handleKeyMap = function (event) {\n        var keyMap = this.options.keyMap[env.isMac ? 'mac' : 'pc'];\n        var keys = [];\n        if (event.metaKey) {\n            keys.push('CMD');\n        }\n        if (event.ctrlKey && !event.altKey) {\n            keys.push('CTRL');\n        }\n        if (event.shiftKey) {\n            keys.push('SHIFT');\n        }\n        var keyName = key.nameFromCode[event.keyCode];\n        if (keyName) {\n            keys.push(keyName);\n        }\n        var eventName = keyMap[keys.join('+')];\n        if (eventName) {\n            if (this.context.invoke(eventName) !== false) {\n                event.preventDefault();\n            }\n        }\n        else if (key.isEdit(event.keyCode)) {\n            this.afterCommand();\n        }\n    };\n    Editor.prototype.preventDefaultEditableShortCuts = function (event) {\n        // B(Bold, 66) / I(Italic, 73) / U(Underline, 85)\n        if ((event.ctrlKey || event.metaKey) &&\n            lists.contains([66, 73, 85], event.keyCode)) {\n            event.preventDefault();\n        }\n    };\n    Editor.prototype.isLimited = function (pad, event) {\n        pad = pad || 0;\n        if (typeof event !== 'undefined') {\n            if (key.isMove(event.keyCode) ||\n                (event.ctrlKey || event.metaKey) ||\n                lists.contains([key.code.BACKSPACE, key.code.DELETE], event.keyCode)) {\n                return false;\n            }\n        }\n        if (this.options.maxTextLength > 0) {\n            if ((this.$editable.text().length + pad) >= this.options.maxTextLength) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * create range\n     * @return {WrappedRange}\n     */\n    Editor.prototype.createRange = function () {\n        this.focus();\n        return range.create(this.editable);\n    };\n    /**\n     * saveRange\n     *\n     * save current range\n     *\n     * @param {Boolean} [thenCollapse=false]\n     */\n    Editor.prototype.saveRange = function (thenCollapse) {\n        this.lastRange = this.createRange();\n        if (thenCollapse) {\n            this.lastRange.collapse().select();\n        }\n    };\n    /**\n     * restoreRange\n     *\n     * restore lately range\n     */\n    Editor.prototype.restoreRange = function () {\n        if (this.lastRange) {\n            this.lastRange.select();\n            this.focus();\n        }\n    };\n    Editor.prototype.saveTarget = function (node) {\n        this.$editable.data('target', node);\n    };\n    Editor.prototype.clearTarget = function () {\n        this.$editable.removeData('target');\n    };\n    Editor.prototype.restoreTarget = function () {\n        return this.$editable.data('target');\n    };\n    /**\n     * currentStyle\n     *\n     * current style\n     * @return {Object|Boolean} unfocus\n     */\n    Editor.prototype.currentStyle = function () {\n        var rng = range.create();\n        if (rng) {\n            rng = rng.normalize();\n        }\n        return rng ? this.style.current(rng) : this.style.fromNode(this.$editable);\n    };\n    /**\n     * style from node\n     *\n     * @param {jQuery} $node\n     * @return {Object}\n     */\n    Editor.prototype.styleFromNode = function ($node) {\n        return this.style.fromNode($node);\n    };\n    /**\n     * undo\n     */\n    Editor.prototype.undo = function () {\n        this.context.triggerEvent('before.command', this.$editable.html());\n        this.history.undo();\n        this.context.triggerEvent('change', this.$editable.html());\n    };\n    /**\n     * redo\n     */\n    Editor.prototype.redo = function () {\n        this.context.triggerEvent('before.command', this.$editable.html());\n        this.history.redo();\n        this.context.triggerEvent('change', this.$editable.html());\n    };\n    /**\n     * before command\n     */\n    Editor.prototype.beforeCommand = function () {\n        this.context.triggerEvent('before.command', this.$editable.html());\n        // keep focus on editable before command execution\n        this.focus();\n    };\n    /**\n     * after command\n     * @param {Boolean} isPreventTrigger\n     */\n    Editor.prototype.afterCommand = function (isPreventTrigger) {\n        this.history.recordUndo();\n        if (!isPreventTrigger) {\n            this.context.triggerEvent('change', this.$editable.html());\n        }\n    };\n    /**\n     * handle tab key\n     */\n    Editor.prototype.tab = function () {\n        var rng = this.createRange();\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.table.tab(rng);\n        }\n        else {\n            if (this.options.tabSize === 0) {\n                return false;\n            }\n            if (!this.isLimited(this.options.tabSize)) {\n                this.beforeCommand();\n                this.typing.insertTab(rng, this.options.tabSize);\n                this.afterCommand();\n            }\n        }\n    };\n    /**\n     * handle shift+tab key\n     */\n    Editor.prototype.untab = function () {\n        var rng = this.createRange();\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.table.tab(rng, true);\n        }\n        else {\n            if (this.options.tabSize === 0) {\n                return false;\n            }\n        }\n    };\n    /**\n     * run given function between beforeCommand and afterCommand\n     */\n    Editor.prototype.wrapCommand = function (fn) {\n        var _this = this;\n        return function () {\n            _this.beforeCommand();\n            fn.apply(_this, arguments);\n            _this.afterCommand();\n        };\n    };\n    /**\n     * insert image\n     *\n     * @param {String} src\n     * @param {String|Function} param\n     * @return {Promise}\n     */\n    Editor.prototype.insertImage = function (src, param) {\n        var _this = this;\n        return createImage(src, param).then(function ($image) {\n            _this.beforeCommand();\n            if (typeof param === 'function') {\n                param($image);\n            }\n            else {\n                if (typeof param === 'string') {\n                    $image.attr('data-filename', param);\n                }\n                $image.css('width', Math.min(_this.$editable.width(), $image.width()));\n            }\n            $image.show();\n            range.create(_this.editable).insertNode($image[0]);\n            range.createFromNodeAfter($image[0]).select();\n            _this.afterCommand();\n        }).fail(function (e) {\n            _this.context.triggerEvent('image.upload.error', e);\n        });\n    };\n    /**\n     * insertImages\n     * @param {File[]} files\n     */\n    Editor.prototype.insertImages = function (files) {\n        var _this = this;\n        $$1.each(files, function (idx, file) {\n            var filename = file.name;\n            if (_this.options.maximumImageFileSize && _this.options.maximumImageFileSize < file.size) {\n                _this.context.triggerEvent('image.upload.error', _this.lang.image.maximumFileSizeError);\n            }\n            else {\n                readFileAsDataURL(file).then(function (dataURL) {\n                    return _this.insertImage(dataURL, filename);\n                }).fail(function () {\n                    _this.context.triggerEvent('image.upload.error');\n                });\n            }\n        });\n    };\n    /**\n     * insertImagesOrCallback\n     * @param {File[]} files\n     */\n    Editor.prototype.insertImagesOrCallback = function (files) {\n        var callbacks = this.options.callbacks;\n        // If onImageUpload this.options setted\n        if (callbacks.onImageUpload) {\n            this.context.triggerEvent('image.upload', files);\n            // else insert Image as dataURL\n        }\n        else {\n            this.insertImages(files);\n        }\n    };\n    /**\n     * return selected plain text\n     * @return {String} text\n     */\n    Editor.prototype.getSelectedText = function () {\n        var rng = this.createRange();\n        // if range on anchor, expand range with anchor\n        if (rng.isOnAnchor()) {\n            rng = range.createFromNode(dom.ancestor(rng.sc, dom.isAnchor));\n        }\n        return rng.toString();\n    };\n    Editor.prototype.onFormatBlock = function (tagName, $target) {\n        // [workaround] for MSIE, IE need `<`\n        tagName = env.isMSIE ? '<' + tagName + '>' : tagName;\n        document.execCommand('FormatBlock', false, tagName);\n        // support custom class\n        if ($target && $target.length) {\n            var className = $target[0].className || '';\n            if (className) {\n                var currentRange = this.createRange();\n                var $parent = $$1([currentRange.sc, currentRange.ec]).closest(tagName);\n                $parent.addClass(className);\n            }\n        }\n    };\n    Editor.prototype.formatPara = function () {\n        this.formatBlock('P');\n    };\n    Editor.prototype.fontStyling = function (target, value) {\n        var rng = this.createRange();\n        if (rng) {\n            var spans = this.style.styleNodes(rng);\n            $$1(spans).css(target, value);\n            // [workaround] added styled bogus span for style\n            //  - also bogus character needed for cursor position\n            if (rng.isCollapsed()) {\n                var firstSpan = lists.head(spans);\n                if (firstSpan && !dom.nodeLength(firstSpan)) {\n                    firstSpan.innerHTML = dom.ZERO_WIDTH_NBSP_CHAR;\n                    range.createFromNodeAfter(firstSpan.firstChild).select();\n                    this.$editable.data(KEY_BOGUS, firstSpan);\n                }\n            }\n        }\n    };\n    /**\n     * unlink\n     *\n     * @type command\n     */\n    Editor.prototype.unlink = function () {\n        var rng = this.createRange();\n        if (rng.isOnAnchor()) {\n            var anchor = dom.ancestor(rng.sc, dom.isAnchor);\n            rng = range.createFromNode(anchor);\n            rng.select();\n            this.beforeCommand();\n            document.execCommand('unlink');\n            this.afterCommand();\n        }\n    };\n    /**\n     * returns link info\n     *\n     * @return {Object}\n     * @return {WrappedRange} return.range\n     * @return {String} return.text\n     * @return {Boolean} [return.isNewWindow=true]\n     * @return {String} [return.url=\"\"]\n     */\n    Editor.prototype.getLinkInfo = function () {\n        var rng = this.createRange().expand(dom.isAnchor);\n        // Get the first anchor on range(for edit).\n        var $anchor = $$1(lists.head(rng.nodes(dom.isAnchor)));\n        var linkInfo = {\n            range: rng,\n            text: rng.toString(),\n            url: $anchor.length ? $anchor.attr('href') : ''\n        };\n        // Define isNewWindow when anchor exists.\n        if ($anchor.length) {\n            linkInfo.isNewWindow = $anchor.attr('target') === '_blank';\n        }\n        return linkInfo;\n    };\n    Editor.prototype.addRow = function (position) {\n        var rng = this.createRange(this.$editable);\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.beforeCommand();\n            this.table.addRow(rng, position);\n            this.afterCommand();\n        }\n    };\n    Editor.prototype.addCol = function (position) {\n        var rng = this.createRange(this.$editable);\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.beforeCommand();\n            this.table.addCol(rng, position);\n            this.afterCommand();\n        }\n    };\n    Editor.prototype.deleteRow = function () {\n        var rng = this.createRange(this.$editable);\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.beforeCommand();\n            this.table.deleteRow(rng);\n            this.afterCommand();\n        }\n    };\n    Editor.prototype.deleteCol = function () {\n        var rng = this.createRange(this.$editable);\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.beforeCommand();\n            this.table.deleteCol(rng);\n            this.afterCommand();\n        }\n    };\n    Editor.prototype.deleteTable = function () {\n        var rng = this.createRange(this.$editable);\n        if (rng.isCollapsed() && rng.isOnCell()) {\n            this.beforeCommand();\n            this.table.deleteTable(rng);\n            this.afterCommand();\n        }\n    };\n    /**\n     * @param {Position} pos\n     * @param {jQuery} $target - target element\n     * @param {Boolean} [bKeepRatio] - keep ratio\n     */\n    Editor.prototype.resizeTo = function (pos, $target, bKeepRatio) {\n        var imageSize;\n        if (bKeepRatio) {\n            var newRatio = pos.y / pos.x;\n            var ratio = $target.data('ratio');\n            imageSize = {\n                width: ratio > newRatio ? pos.x : pos.y / ratio,\n                height: ratio > newRatio ? pos.x * ratio : pos.y\n            };\n        }\n        else {\n            imageSize = {\n                width: pos.x,\n                height: pos.y\n            };\n        }\n        $target.css(imageSize);\n    };\n    /**\n     * returns whether editable area has focus or not.\n     */\n    Editor.prototype.hasFocus = function () {\n        return this.$editable.is(':focus');\n    };\n    /**\n     * set focus\n     */\n    Editor.prototype.focus = function () {\n        // [workaround] Screen will move when page is scolled in IE.\n        //  - do focus when not focused\n        if (!this.hasFocus()) {\n            this.$editable.focus();\n        }\n    };\n    /**\n     * returns whether contents is empty or not.\n     * @return {Boolean}\n     */\n    Editor.prototype.isEmpty = function () {\n        return dom.isEmpty(this.$editable[0]) || dom.emptyPara === this.$editable.html();\n    };\n    /**\n     * Removes all contents and restores the editable instance to an _emptyPara_.\n     */\n    Editor.prototype.empty = function () {\n        this.context.invoke('code', dom.emptyPara);\n    };\n    return Editor;\n}());\n\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(context) {\n        this.context = context;\n        this.$editable = context.layoutInfo.editable;\n    }\n    Clipboard.prototype.initialize = function () {\n        this.$editable.on('paste', this.pasteByEvent.bind(this));\n    };\n    /**\n     * paste by clipboard event\n     *\n     * @param {Event} event\n     */\n    Clipboard.prototype.pasteByEvent = function (event) {\n        var clipboardData = event.originalEvent.clipboardData;\n        if (clipboardData && clipboardData.items && clipboardData.items.length) {\n            var item = lists.head(clipboardData.items);\n            if (item.kind === 'file' && item.type.indexOf('image/') !== -1) {\n                this.context.invoke('editor.insertImagesOrCallback', [item.getAsFile()]);\n            }\n            this.context.invoke('editor.afterCommand');\n        }\n    };\n    return Clipboard;\n}());\n\nvar Dropzone = /** @class */ (function () {\n    function Dropzone(context) {\n        this.context = context;\n        this.$eventListener = $$1(document);\n        this.$editor = context.layoutInfo.editor;\n        this.$editable = context.layoutInfo.editable;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n        this.documentEventHandlers = {};\n        this.$dropzone = $$1([\n            '<div class=\"note-dropzone\">',\n            '  <div class=\"note-dropzone-message\"/>',\n            '</div>'\n        ].join('')).prependTo(this.$editor);\n    }\n    /**\n     * attach Drag and Drop Events\n     */\n    Dropzone.prototype.initialize = function () {\n        if (this.options.disableDragAndDrop) {\n            // prevent default drop event\n            this.documentEventHandlers.onDrop = function (e) {\n                e.preventDefault();\n            };\n            // do not consider outside of dropzone\n            this.$eventListener = this.$dropzone;\n            this.$eventListener.on('drop', this.documentEventHandlers.onDrop);\n        }\n        else {\n            this.attachDragAndDropEvent();\n        }\n    };\n    /**\n     * attach Drag and Drop Events\n     */\n    Dropzone.prototype.attachDragAndDropEvent = function () {\n        var _this = this;\n        var collection = $$1();\n        var $dropzoneMessage = this.$dropzone.find('.note-dropzone-message');\n        this.documentEventHandlers.onDragenter = function (e) {\n            var isCodeview = _this.context.invoke('codeview.isActivated');\n            var hasEditorSize = _this.$editor.width() > 0 && _this.$editor.height() > 0;\n            if (!isCodeview && !collection.length && hasEditorSize) {\n                _this.$editor.addClass('dragover');\n                _this.$dropzone.width(_this.$editor.width());\n                _this.$dropzone.height(_this.$editor.height());\n                $dropzoneMessage.text(_this.lang.image.dragImageHere);\n            }\n            collection = collection.add(e.target);\n        };\n        this.documentEventHandlers.onDragleave = function (e) {\n            collection = collection.not(e.target);\n            if (!collection.length) {\n                _this.$editor.removeClass('dragover');\n            }\n        };\n        this.documentEventHandlers.onDrop = function () {\n            collection = $$1();\n            _this.$editor.removeClass('dragover');\n        };\n        // show dropzone on dragenter when dragging a object to document\n        // -but only if the editor is visible, i.e. has a positive width and height\n        this.$eventListener.on('dragenter', this.documentEventHandlers.onDragenter)\n            .on('dragleave', this.documentEventHandlers.onDragleave)\n            .on('drop', this.documentEventHandlers.onDrop);\n        // change dropzone's message on hover.\n        this.$dropzone.on('dragenter', function () {\n            _this.$dropzone.addClass('hover');\n            $dropzoneMessage.text(_this.lang.image.dropImage);\n        }).on('dragleave', function () {\n            _this.$dropzone.removeClass('hover');\n            $dropzoneMessage.text(_this.lang.image.dragImageHere);\n        });\n        // attach dropImage\n        this.$dropzone.on('drop', function (event) {\n            var dataTransfer = event.originalEvent.dataTransfer;\n            // stop the browser from opening the dropped content\n            event.preventDefault();\n            if (dataTransfer && dataTransfer.files && dataTransfer.files.length) {\n                _this.$editable.focus();\n                _this.context.invoke('editor.insertImagesOrCallback', dataTransfer.files);\n            }\n            else {\n                $$1.each(dataTransfer.types, function (idx, type) {\n                    var content = dataTransfer.getData(type);\n                    if (type.toLowerCase().indexOf('text') > -1) {\n                        _this.context.invoke('editor.pasteHTML', content);\n                    }\n                    else {\n                        $$1(content).each(function (idx, item) {\n                            _this.context.invoke('editor.insertNode', item);\n                        });\n                    }\n                });\n            }\n        }).on('dragover', false); // prevent default dragover event\n    };\n    Dropzone.prototype.destroy = function () {\n        var _this = this;\n        Object.keys(this.documentEventHandlers).forEach(function (key) {\n            _this.$eventListener.off(key.substr(2).toLowerCase(), _this.documentEventHandlers[key]);\n        });\n        this.documentEventHandlers = {};\n    };\n    return Dropzone;\n}());\n\nvar CodeMirror;\nif (env.hasCodeMirror) {\n    if (env.isSupportAmd) {\n        require(['codemirror'], function (cm) {\n            CodeMirror = cm;\n        });\n    }\n    else {\n        CodeMirror = window.CodeMirror;\n    }\n}\n/**\n * @class Codeview\n */\nvar CodeView = /** @class */ (function () {\n    function CodeView(context) {\n        this.context = context;\n        this.$editor = context.layoutInfo.editor;\n        this.$editable = context.layoutInfo.editable;\n        this.$codable = context.layoutInfo.codable;\n        this.options = context.options;\n    }\n    CodeView.prototype.sync = function () {\n        var isCodeview = this.isActivated();\n        if (isCodeview && env.hasCodeMirror) {\n            this.$codable.data('cmEditor').save();\n        }\n    };\n    /**\n     * @return {Boolean}\n     */\n    CodeView.prototype.isActivated = function () {\n        return this.$editor.hasClass('codeview');\n    };\n    /**\n     * toggle codeview\n     */\n    CodeView.prototype.toggle = function () {\n        if (this.isActivated()) {\n            this.deactivate();\n        }\n        else {\n            this.activate();\n        }\n        this.context.triggerEvent('codeview.toggled');\n    };\n    /**\n     * activate code view\n     */\n    CodeView.prototype.activate = function () {\n        var _this = this;\n        this.$codable.val(dom.html(this.$editable, this.options.prettifyHtml));\n        this.$codable.height(this.$editable.height());\n        this.context.invoke('toolbar.updateCodeview', true);\n        this.$editor.addClass('codeview');\n        this.$codable.focus();\n        // activate CodeMirror as codable\n        if (env.hasCodeMirror) {\n            var cmEditor_1 = CodeMirror.fromTextArea(this.$codable[0], this.options.codemirror);\n            // CodeMirror TernServer\n            if (this.options.codemirror.tern) {\n                var server_1 = new CodeMirror.TernServer(this.options.codemirror.tern);\n                cmEditor_1.ternServer = server_1;\n                cmEditor_1.on('cursorActivity', function (cm) {\n                    server_1.updateArgHints(cm);\n                });\n            }\n            cmEditor_1.on('blur', function (event) {\n                _this.context.triggerEvent('blur.codeview', cmEditor_1.getValue(), event);\n            });\n            // CodeMirror hasn't Padding.\n            cmEditor_1.setSize(null, this.$editable.outerHeight());\n            this.$codable.data('cmEditor', cmEditor_1);\n        }\n        else {\n            this.$codable.on('blur', function (event) {\n                _this.context.triggerEvent('blur.codeview', _this.$codable.val(), event);\n            });\n        }\n    };\n    /**\n     * deactivate code view\n     */\n    CodeView.prototype.deactivate = function () {\n        // deactivate CodeMirror as codable\n        if (env.hasCodeMirror) {\n            var cmEditor = this.$codable.data('cmEditor');\n            this.$codable.val(cmEditor.getValue());\n            cmEditor.toTextArea();\n        }\n        var value = dom.value(this.$codable, this.options.prettifyHtml) || dom.emptyPara;\n        var isChange = this.$editable.html() !== value;\n        this.$editable.html(value);\n        this.$editable.height(this.options.height ? this.$codable.height() : 'auto');\n        this.$editor.removeClass('codeview');\n        if (isChange) {\n            this.context.triggerEvent('change', this.$editable.html(), this.$editable);\n        }\n        this.$editable.focus();\n        this.context.invoke('toolbar.updateCodeview', false);\n    };\n    CodeView.prototype.destroy = function () {\n        if (this.isActivated()) {\n            this.deactivate();\n        }\n    };\n    return CodeView;\n}());\n\nvar EDITABLE_PADDING = 24;\nvar Statusbar = /** @class */ (function () {\n    function Statusbar(context) {\n        this.$document = $$1(document);\n        this.$statusbar = context.layoutInfo.statusbar;\n        this.$editable = context.layoutInfo.editable;\n        this.options = context.options;\n    }\n    Statusbar.prototype.initialize = function () {\n        var _this = this;\n        if (this.options.airMode || this.options.disableResizeEditor) {\n            this.destroy();\n            return;\n        }\n        this.$statusbar.on('mousedown', function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n            var editableTop = _this.$editable.offset().top - _this.$document.scrollTop();\n            var onMouseMove = function (event) {\n                var height = event.clientY - (editableTop + EDITABLE_PADDING);\n                height = (_this.options.minheight > 0) ? Math.max(height, _this.options.minheight) : height;\n                height = (_this.options.maxHeight > 0) ? Math.min(height, _this.options.maxHeight) : height;\n                _this.$editable.height(height);\n            };\n            _this.$document.on('mousemove', onMouseMove).one('mouseup', function () {\n                _this.$document.off('mousemove', onMouseMove);\n            });\n        });\n    };\n    Statusbar.prototype.destroy = function () {\n        this.$statusbar.off();\n    };\n    return Statusbar;\n}());\n\nvar Fullscreen = /** @class */ (function () {\n    function Fullscreen(context) {\n        var _this = this;\n        this.context = context;\n        this.$editor = context.layoutInfo.editor;\n        this.$toolbar = context.layoutInfo.toolbar;\n        this.$editable = context.layoutInfo.editable;\n        this.$codable = context.layoutInfo.codable;\n        this.$window = $$1(window);\n        this.$scrollbar = $$1('html, body');\n        this.onResize = function () {\n            _this.resizeTo({\n                h: _this.$window.height() - _this.$toolbar.outerHeight()\n            });\n        };\n    }\n    Fullscreen.prototype.resizeTo = function (size) {\n        this.$editable.css('height', size.h);\n        this.$codable.css('height', size.h);\n        if (this.$codable.data('cmeditor')) {\n            this.$codable.data('cmeditor').setsize(null, size.h);\n        }\n    };\n    /**\n     * toggle fullscreen\n     */\n    Fullscreen.prototype.toggle = function () {\n        this.$editor.toggleClass('fullscreen');\n        if (this.isFullscreen()) {\n            this.$editable.data('orgHeight', this.$editable.css('height'));\n            this.$window.on('resize', this.onResize).trigger('resize');\n            this.$scrollbar.css('overflow', 'hidden');\n        }\n        else {\n            this.$window.off('resize', this.onResize);\n            this.resizeTo({ h: this.$editable.data('orgHeight') });\n            this.$scrollbar.css('overflow', 'visible');\n        }\n        this.context.invoke('toolbar.updateFullscreen', this.isFullscreen());\n    };\n    Fullscreen.prototype.isFullscreen = function () {\n        return this.$editor.hasClass('fullscreen');\n    };\n    return Fullscreen;\n}());\n\nvar Handle = /** @class */ (function () {\n    function Handle(context) {\n        var _this = this;\n        this.context = context;\n        this.$document = $$1(document);\n        this.$editingArea = context.layoutInfo.editingArea;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n        this.events = {\n            'summernote.mousedown': function (we, e) {\n                if (_this.update(e.target)) {\n                    e.preventDefault();\n                }\n            },\n            'summernote.keyup summernote.scroll summernote.change summernote.dialog.shown': function () {\n                _this.update();\n            },\n            'summernote.disable': function () {\n                _this.hide();\n            },\n            'summernote.codeview.toggled': function () {\n                _this.update();\n            }\n        };\n    }\n    Handle.prototype.initialize = function () {\n        var _this = this;\n        this.$handle = $$1([\n            '<div class=\"note-handle\">',\n            '<div class=\"note-control-selection\">',\n            '<div class=\"note-control-selection-bg\"></div>',\n            '<div class=\"note-control-holder note-control-nw\"></div>',\n            '<div class=\"note-control-holder note-control-ne\"></div>',\n            '<div class=\"note-control-holder note-control-sw\"></div>',\n            '<div class=\"',\n            (this.options.disableResizeImage ? 'note-control-holder' : 'note-control-sizing'),\n            ' note-control-se\"></div>',\n            (this.options.disableResizeImage ? '' : '<div class=\"note-control-selection-info\"></div>'),\n            '</div>',\n            '</div>'\n        ].join('')).prependTo(this.$editingArea);\n        this.$handle.on('mousedown', function (event) {\n            if (dom.isControlSizing(event.target)) {\n                event.preventDefault();\n                event.stopPropagation();\n                var $target_1 = _this.$handle.find('.note-control-selection').data('target');\n                var posStart_1 = $target_1.offset();\n                var scrollTop_1 = _this.$document.scrollTop();\n                var onMouseMove_1 = function (event) {\n                    _this.context.invoke('editor.resizeTo', {\n                        x: event.clientX - posStart_1.left,\n                        y: event.clientY - (posStart_1.top - scrollTop_1)\n                    }, $target_1, !event.shiftKey);\n                    _this.update($target_1[0]);\n                };\n                _this.$document\n                    .on('mousemove', onMouseMove_1)\n                    .one('mouseup', function (e) {\n                    e.preventDefault();\n                    _this.$document.off('mousemove', onMouseMove_1);\n                    _this.context.invoke('editor.afterCommand');\n                });\n                if (!$target_1.data('ratio')) {\n                    $target_1.data('ratio', $target_1.height() / $target_1.width());\n                }\n            }\n        });\n        // Listen for scrolling on the handle overlay.\n        this.$handle.on('wheel', function (e) {\n            e.preventDefault();\n            _this.update();\n        });\n    };\n    Handle.prototype.destroy = function () {\n        this.$handle.remove();\n    };\n    Handle.prototype.update = function (target) {\n        if (this.context.isDisabled()) {\n            return false;\n        }\n        var isImage = dom.isImg(target);\n        var $selection = this.$handle.find('.note-control-selection');\n        this.context.invoke('imagePopover.update', target);\n        if (isImage) {\n            var $image = $$1(target);\n            var position = $image.position();\n            var pos = {\n                left: position.left + parseInt($image.css('marginLeft'), 10),\n                top: position.top + parseInt($image.css('marginTop'), 10)\n            };\n            // exclude margin\n            var imageSize = {\n                w: $image.outerWidth(false),\n                h: $image.outerHeight(false)\n            };\n            $selection.css({\n                display: 'block',\n                left: pos.left,\n                top: pos.top,\n                width: imageSize.w,\n                height: imageSize.h\n            }).data('target', $image); // save current image element.\n            var origImageObj = new Image();\n            origImageObj.src = $image.attr('src');\n            var sizingText = imageSize.w + 'x' + imageSize.h + ' (' + this.lang.image.original + ': ' + origImageObj.width + 'x' + origImageObj.height + ')';\n            $selection.find('.note-control-selection-info').text(sizingText);\n            this.context.invoke('editor.saveTarget', target);\n        }\n        else {\n            this.hide();\n        }\n        return isImage;\n    };\n    /**\n     * hide\n     *\n     * @param {jQuery} $handle\n     */\n    Handle.prototype.hide = function () {\n        this.context.invoke('editor.clearTarget');\n        this.$handle.children().hide();\n    };\n    return Handle;\n}());\n\nvar defaultScheme = 'http://';\nvar linkPattern = /^([A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?|mailto:[A-Z0-9._%+-]+@)?(www\\.)?(.+)$/i;\nvar AutoLink = /** @class */ (function () {\n    function AutoLink(context) {\n        var _this = this;\n        this.context = context;\n        this.events = {\n            'summernote.keyup': function (we, e) {\n                if (!e.isDefaultPrevented()) {\n                    _this.handleKeyup(e);\n                }\n            },\n            'summernote.keydown': function (we, e) {\n                _this.handleKeydown(e);\n            }\n        };\n    }\n    AutoLink.prototype.initialize = function () {\n        this.lastWordRange = null;\n    };\n    AutoLink.prototype.destroy = function () {\n        this.lastWordRange = null;\n    };\n    AutoLink.prototype.replace = function () {\n        if (!this.lastWordRange) {\n            return;\n        }\n        var keyword = this.lastWordRange.toString();\n        var match = keyword.match(linkPattern);\n        if (match && (match[1] || match[2])) {\n            var link = match[1] ? keyword : defaultScheme + keyword;\n            var node = $$1('<a />').html(keyword).attr('href', link)[0];\n            this.lastWordRange.insertNode(node);\n            this.lastWordRange = null;\n            this.context.invoke('editor.focus');\n        }\n    };\n    AutoLink.prototype.handleKeydown = function (e) {\n        if (lists.contains([key.code.ENTER, key.code.SPACE], e.keyCode)) {\n            var wordRange = this.context.invoke('editor.createRange').getWordRange();\n            this.lastWordRange = wordRange;\n        }\n    };\n    AutoLink.prototype.handleKeyup = function (e) {\n        if (lists.contains([key.code.ENTER, key.code.SPACE], e.keyCode)) {\n            this.replace();\n        }\n    };\n    return AutoLink;\n}());\n\n/**\n * textarea auto sync.\n */\nvar AutoSync = /** @class */ (function () {\n    function AutoSync(context) {\n        var _this = this;\n        this.$note = context.layoutInfo.note;\n        this.events = {\n            'summernote.change': function () {\n                _this.$note.val(context.invoke('code'));\n            }\n        };\n    }\n    AutoSync.prototype.shouldInitialize = function () {\n        return dom.isTextarea(this.$note[0]);\n    };\n    return AutoSync;\n}());\n\nvar Placeholder = /** @class */ (function () {\n    function Placeholder(context) {\n        var _this = this;\n        this.context = context;\n        this.$editingArea = context.layoutInfo.editingArea;\n        this.options = context.options;\n        this.events = {\n            'summernote.init summernote.change': function () {\n                _this.update();\n            },\n            'summernote.codeview.toggled': function () {\n                _this.update();\n            }\n        };\n    }\n    Placeholder.prototype.shouldInitialize = function () {\n        return !!this.options.placeholder;\n    };\n    Placeholder.prototype.initialize = function () {\n        var _this = this;\n        this.$placeholder = $$1('<div class=\"note-placeholder\">');\n        this.$placeholder.on('click', function () {\n            _this.context.invoke('focus');\n        }).text(this.options.placeholder).prependTo(this.$editingArea);\n        this.update();\n    };\n    Placeholder.prototype.destroy = function () {\n        this.$placeholder.remove();\n    };\n    Placeholder.prototype.update = function () {\n        var isShow = !this.context.invoke('codeview.isActivated') && this.context.invoke('editor.isEmpty');\n        this.$placeholder.toggle(isShow);\n    };\n    return Placeholder;\n}());\n\nvar Buttons = /** @class */ (function () {\n    function Buttons(context) {\n        this.ui = $$1.summernote.ui;\n        this.context = context;\n        this.$toolbar = context.layoutInfo.toolbar;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n        this.invertedKeyMap = func.invertObject(this.options.keyMap[env.isMac ? 'mac' : 'pc']);\n    }\n    Buttons.prototype.representShortcut = function (editorMethod) {\n        var shortcut = this.invertedKeyMap[editorMethod];\n        if (!this.options.shortcuts || !shortcut) {\n            return '';\n        }\n        if (env.isMac) {\n            shortcut = shortcut.replace('CMD', '').replace('SHIFT', '');\n        }\n        shortcut = shortcut.replace('BACKSLASH', '\\\\')\n            .replace('SLASH', '/')\n            .replace('LEFTBRACKET', '[')\n            .replace('RIGHTBRACKET', ']');\n        return ' (' + shortcut + ')';\n    };\n    Buttons.prototype.button = function (o) {\n        if (!this.options.tooltip && o.tooltip) {\n            delete o.tooltip;\n        }\n        o.container = this.options.container;\n        return this.ui.button(o);\n    };\n    Buttons.prototype.initialize = function () {\n        this.addToolbarButtons();\n        this.addImagePopoverButtons();\n        this.addLinkPopoverButtons();\n        this.addTablePopoverButtons();\n        this.fontInstalledMap = {};\n    };\n    Buttons.prototype.destroy = function () {\n        delete this.fontInstalledMap;\n    };\n    Buttons.prototype.isFontInstalled = function (name) {\n        if (!this.fontInstalledMap.hasOwnProperty(name)) {\n            this.fontInstalledMap[name] = env.isFontInstalled(name) ||\n                lists.contains(this.options.fontNamesIgnoreCheck, name);\n        }\n        return this.fontInstalledMap[name];\n    };\n    Buttons.prototype.isFontDeservedToAdd = function (name) {\n        var genericFamilies = ['sans-serif', 'serif', 'monospace', 'cursive', 'fantasy'];\n        name = name.toLowerCase();\n        return ((name !== '') && this.isFontInstalled(name) && ($$1.inArray(name, genericFamilies) === -1));\n    };\n    Buttons.prototype.addToolbarButtons = function () {\n        var _this = this;\n        this.context.memo('button.style', function () {\n            return _this.ui.buttonGroup([\n                _this.button({\n                    className: 'dropdown-toggle',\n                    contents: _this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.magic), _this.options),\n                    tooltip: _this.lang.style.style,\n                    data: {\n                        toggle: 'dropdown'\n                    }\n                }),\n                _this.ui.dropdown({\n                    className: 'dropdown-style',\n                    items: _this.options.styleTags,\n                    template: function (item) {\n                        if (typeof item === 'string') {\n                            item = { tag: item, title: (_this.lang.style.hasOwnProperty(item) ? _this.lang.style[item] : item) };\n                        }\n                        var tag = item.tag;\n                        var title = item.title;\n                        var style = item.style ? ' style=\"' + item.style + '\" ' : '';\n                        var className = item.className ? ' class=\"' + item.className + '\"' : '';\n                        return '<' + tag + style + className + '>' + title + '</' + tag + '>';\n                    },\n                    click: _this.context.createInvokeHandler('editor.formatBlock')\n                })\n            ]).render();\n        });\n        var _loop_1 = function (styleIdx, styleLen) {\n            var item = this_1.options.styleTags[styleIdx];\n            this_1.context.memo('button.style.' + item, function () {\n                return _this.button({\n                    className: 'note-btn-style-' + item,\n                    contents: '<div data-value=\"' + item + '\">' + item.toUpperCase() + '</div>',\n                    tooltip: item.toUpperCase(),\n                    click: _this.context.createInvokeHandler('editor.formatBlock')\n                }).render();\n            });\n        };\n        var this_1 = this;\n        for (var styleIdx = 0, styleLen = this.options.styleTags.length; styleIdx < styleLen; styleIdx++) {\n            _loop_1(styleIdx, styleLen);\n        }\n        this.context.memo('button.bold', function () {\n            return _this.button({\n                className: 'note-btn-bold',\n                contents: _this.ui.icon(_this.options.icons.bold),\n                tooltip: _this.lang.font.bold + _this.representShortcut('bold'),\n                click: _this.context.createInvokeHandlerAndUpdateState('editor.bold')\n            }).render();\n        });\n        this.context.memo('button.italic', function () {\n            return _this.button({\n                className: 'note-btn-italic',\n                contents: _this.ui.icon(_this.options.icons.italic),\n                tooltip: _this.lang.font.italic + _this.representShortcut('italic'),\n                click: _this.context.createInvokeHandlerAndUpdateState('editor.italic')\n            }).render();\n        });\n        this.context.memo('button.underline', function () {\n            return _this.button({\n                className: 'note-btn-underline',\n                contents: _this.ui.icon(_this.options.icons.underline),\n                tooltip: _this.lang.font.underline + _this.representShortcut('underline'),\n                click: _this.context.createInvokeHandlerAndUpdateState('editor.underline')\n            }).render();\n        });\n        this.context.memo('button.clear', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.eraser),\n                tooltip: _this.lang.font.clear + _this.representShortcut('removeFormat'),\n                click: _this.context.createInvokeHandler('editor.removeFormat')\n            }).render();\n        });\n        this.context.memo('button.strikethrough', function () {\n            return _this.button({\n                className: 'note-btn-strikethrough',\n                contents: _this.ui.icon(_this.options.icons.strikethrough),\n                tooltip: _this.lang.font.strikethrough + _this.representShortcut('strikethrough'),\n                click: _this.context.createInvokeHandlerAndUpdateState('editor.strikethrough')\n            }).render();\n        });\n        this.context.memo('button.superscript', function () {\n            return _this.button({\n                className: 'note-btn-superscript',\n                contents: _this.ui.icon(_this.options.icons.superscript),\n                tooltip: _this.lang.font.superscript,\n                click: _this.context.createInvokeHandlerAndUpdateState('editor.superscript')\n            }).render();\n        });\n        this.context.memo('button.subscript', function () {\n            return _this.button({\n                className: 'note-btn-subscript',\n                contents: _this.ui.icon(_this.options.icons.subscript),\n                tooltip: _this.lang.font.subscript,\n                click: _this.context.createInvokeHandlerAndUpdateState('editor.subscript')\n            }).render();\n        });\n        this.context.memo('button.fontname', function () {\n            var styleInfo = _this.context.invoke('editor.currentStyle');\n            // Add 'default' fonts into the fontnames array if not exist\n            $$1.each(styleInfo['font-family'].split(','), function (idx, fontname) {\n                fontname = fontname.trim().replace(/['\"]+/g, '');\n                if (_this.isFontDeservedToAdd(fontname)) {\n                    if ($$1.inArray(fontname, _this.options.fontNames) === -1) {\n                        _this.options.fontNames.push(fontname);\n                    }\n                }\n            });\n            return _this.ui.buttonGroup([\n                _this.button({\n                    className: 'dropdown-toggle',\n                    contents: _this.ui.dropdownButtonContents('<span class=\"note-current-fontname\"/>', _this.options),\n                    tooltip: _this.lang.font.name,\n                    data: {\n                        toggle: 'dropdown'\n                    }\n                }),\n                _this.ui.dropdownCheck({\n                    className: 'dropdown-fontname',\n                    checkClassName: _this.options.icons.menuCheck,\n                    items: _this.options.fontNames.filter(_this.isFontInstalled.bind(_this)),\n                    template: function (item) {\n                        return '<span style=\"font-family: \\'' + item + '\\'\">' + item + '</span>';\n                    },\n                    click: _this.context.createInvokeHandlerAndUpdateState('editor.fontName')\n                })\n            ]).render();\n        });\n        this.context.memo('button.fontsize', function () {\n            return _this.ui.buttonGroup([\n                _this.button({\n                    className: 'dropdown-toggle',\n                    contents: _this.ui.dropdownButtonContents('<span class=\"note-current-fontsize\"/>', _this.options),\n                    tooltip: _this.lang.font.size,\n                    data: {\n                        toggle: 'dropdown'\n                    }\n                }),\n                _this.ui.dropdownCheck({\n                    className: 'dropdown-fontsize',\n                    checkClassName: _this.options.icons.menuCheck,\n                    items: _this.options.fontSizes,\n                    click: _this.context.createInvokeHandlerAndUpdateState('editor.fontSize')\n                })\n            ]).render();\n        });\n        this.context.memo('button.color', function () {\n            return _this.ui.buttonGroup({\n                className: 'note-color',\n                children: [\n                    _this.button({\n                        className: 'note-current-color-button',\n                        contents: _this.ui.icon(_this.options.icons.font + ' note-recent-color'),\n                        tooltip: _this.lang.color.recent,\n                        click: function (e) {\n                            var $button = $$1(e.currentTarget);\n                            _this.context.invoke('editor.color', {\n                                backColor: $button.attr('data-backColor'),\n                                foreColor: $button.attr('data-foreColor')\n                            });\n                        },\n                        callback: function ($button) {\n                            var $recentColor = $button.find('.note-recent-color');\n                            $recentColor.css('background-color', '#FFFF00');\n                            $button.attr('data-backColor', '#FFFF00');\n                        }\n                    }),\n                    _this.button({\n                        className: 'dropdown-toggle',\n                        contents: _this.ui.dropdownButtonContents('', _this.options),\n                        tooltip: _this.lang.color.more,\n                        data: {\n                            toggle: 'dropdown'\n                        }\n                    }),\n                    _this.ui.dropdown({\n                        items: [\n                            '<div class=\"note-palette\">',\n                            '  <div class=\"note-palette-title\">' + _this.lang.color.background + '</div>',\n                            '  <div>',\n                            '    <button type=\"button\" class=\"note-color-reset btn btn-light\" data-event=\"backColor\" data-value=\"inherit\">',\n                            _this.lang.color.transparent,\n                            '    </button>',\n                            '  </div>',\n                            '  <div class=\"note-holder\" data-event=\"backColor\"/>',\n                            '</div>',\n                            '<div class=\"note-palette\">',\n                            '  <div class=\"note-palette-title\">' + _this.lang.color.foreground + '</div>',\n                            '  <div>',\n                            '    <button type=\"button\" class=\"note-color-reset btn btn-light\" data-event=\"removeFormat\" data-value=\"foreColor\">',\n                            _this.lang.color.resetToDefault,\n                            '    </button>',\n                            '  </div>',\n                            '  <div class=\"note-holder\" data-event=\"foreColor\"/>',\n                            '</div>'\n                        ].join(''),\n                        callback: function ($dropdown) {\n                            $dropdown.find('.note-holder').each(function (idx, item) {\n                                var $holder = $$1(item);\n                                $holder.append(_this.ui.palette({\n                                    colors: _this.options.colors,\n                                    eventName: $holder.data('event'),\n                                    container: _this.options.container,\n                                    tooltip: _this.options.tooltip\n                                }).render());\n                            });\n                        },\n                        click: function (event) {\n                            var $button = $$1(event.target);\n                            var eventName = $button.data('event');\n                            var value = $button.data('value');\n                            if (eventName && value) {\n                                var key = eventName === 'backColor' ? 'background-color' : 'color';\n                                var $color = $button.closest('.note-color').find('.note-recent-color');\n                                var $currentButton = $button.closest('.note-color').find('.note-current-color-button');\n                                $color.css(key, value);\n                                $currentButton.attr('data-' + eventName, value);\n                                _this.context.invoke('editor.' + eventName, value);\n                            }\n                        }\n                    })\n                ]\n            }).render();\n        });\n        this.context.memo('button.ul', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.unorderedlist),\n                tooltip: _this.lang.lists.unordered + _this.representShortcut('insertUnorderedList'),\n                click: _this.context.createInvokeHandler('editor.insertUnorderedList')\n            }).render();\n        });\n        this.context.memo('button.ol', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.orderedlist),\n                tooltip: _this.lang.lists.ordered + _this.representShortcut('insertOrderedList'),\n                click: _this.context.createInvokeHandler('editor.insertOrderedList')\n            }).render();\n        });\n        var justifyLeft = this.button({\n            contents: this.ui.icon(this.options.icons.alignLeft),\n            tooltip: this.lang.paragraph.left + this.representShortcut('justifyLeft'),\n            click: this.context.createInvokeHandler('editor.justifyLeft')\n        });\n        var justifyCenter = this.button({\n            contents: this.ui.icon(this.options.icons.alignCenter),\n            tooltip: this.lang.paragraph.center + this.representShortcut('justifyCenter'),\n            click: this.context.createInvokeHandler('editor.justifyCenter')\n        });\n        var justifyRight = this.button({\n            contents: this.ui.icon(this.options.icons.alignRight),\n            tooltip: this.lang.paragraph.right + this.representShortcut('justifyRight'),\n            click: this.context.createInvokeHandler('editor.justifyRight')\n        });\n        var justifyFull = this.button({\n            contents: this.ui.icon(this.options.icons.alignJustify),\n            tooltip: this.lang.paragraph.justify + this.representShortcut('justifyFull'),\n            click: this.context.createInvokeHandler('editor.justifyFull')\n        });\n        var outdent = this.button({\n            contents: this.ui.icon(this.options.icons.outdent),\n            tooltip: this.lang.paragraph.outdent + this.representShortcut('outdent'),\n            click: this.context.createInvokeHandler('editor.outdent')\n        });\n        var indent = this.button({\n            contents: this.ui.icon(this.options.icons.indent),\n            tooltip: this.lang.paragraph.indent + this.representShortcut('indent'),\n            click: this.context.createInvokeHandler('editor.indent')\n        });\n        this.context.memo('button.justifyLeft', func.invoke(justifyLeft, 'render'));\n        this.context.memo('button.justifyCenter', func.invoke(justifyCenter, 'render'));\n        this.context.memo('button.justifyRight', func.invoke(justifyRight, 'render'));\n        this.context.memo('button.justifyFull', func.invoke(justifyFull, 'render'));\n        this.context.memo('button.outdent', func.invoke(outdent, 'render'));\n        this.context.memo('button.indent', func.invoke(indent, 'render'));\n        this.context.memo('button.paragraph', function () {\n            return _this.ui.buttonGroup([\n                _this.button({\n                    className: 'dropdown-toggle',\n                    contents: _this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.alignLeft), _this.options),\n                    tooltip: _this.lang.paragraph.paragraph,\n                    data: {\n                        toggle: 'dropdown'\n                    }\n                }),\n                _this.ui.dropdown([\n                    _this.ui.buttonGroup({\n                        className: 'note-align',\n                        children: [justifyLeft, justifyCenter, justifyRight, justifyFull]\n                    }),\n                    _this.ui.buttonGroup({\n                        className: 'note-list',\n                        children: [outdent, indent]\n                    })\n                ])\n            ]).render();\n        });\n        this.context.memo('button.height', function () {\n            return _this.ui.buttonGroup([\n                _this.button({\n                    className: 'dropdown-toggle',\n                    contents: _this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.textHeight), _this.options),\n                    tooltip: _this.lang.font.height,\n                    data: {\n                        toggle: 'dropdown'\n                    }\n                }),\n                _this.ui.dropdownCheck({\n                    items: _this.options.lineHeights,\n                    checkClassName: _this.options.icons.menuCheck,\n                    className: 'dropdown-line-height',\n                    click: _this.context.createInvokeHandler('editor.lineHeight')\n                })\n            ]).render();\n        });\n        this.context.memo('button.table', function () {\n            return _this.ui.buttonGroup([\n                _this.button({\n                    className: 'dropdown-toggle',\n                    contents: _this.ui.dropdownButtonContents(_this.ui.icon(_this.options.icons.table), _this.options),\n                    tooltip: _this.lang.table.table,\n                    data: {\n                        toggle: 'dropdown'\n                    }\n                }),\n                _this.ui.dropdown({\n                    className: 'note-table',\n                    items: [\n                        '<div class=\"note-dimension-picker\">',\n                        '  <div class=\"note-dimension-picker-mousecatcher\" data-event=\"insertTable\" data-value=\"1x1\"/>',\n                        '  <div class=\"note-dimension-picker-highlighted\"/>',\n                        '  <div class=\"note-dimension-picker-unhighlighted\"/>',\n                        '</div>',\n                        '<div class=\"note-dimension-display\">1 x 1</div>'\n                    ].join('')\n                })\n            ], {\n                callback: function ($node) {\n                    var $catcher = $node.find('.note-dimension-picker-mousecatcher');\n                    $catcher.css({\n                        width: _this.options.insertTableMaxSize.col + 'em',\n                        height: _this.options.insertTableMaxSize.row + 'em'\n                    }).mousedown(_this.context.createInvokeHandler('editor.insertTable'))\n                        .on('mousemove', _this.tableMoveHandler.bind(_this));\n                }\n            }).render();\n        });\n        this.context.memo('button.link', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.link),\n                tooltip: _this.lang.link.link + _this.representShortcut('linkDialog.show'),\n                click: _this.context.createInvokeHandler('linkDialog.show')\n            }).render();\n        });\n        this.context.memo('button.picture', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.picture),\n                tooltip: _this.lang.image.image,\n                click: _this.context.createInvokeHandler('imageDialog.show')\n            }).render();\n        });\n        this.context.memo('button.video', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.video),\n                tooltip: _this.lang.video.video,\n                click: _this.context.createInvokeHandler('videoDialog.show')\n            }).render();\n        });\n        this.context.memo('button.hr', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.minus),\n                tooltip: _this.lang.hr.insert + _this.representShortcut('insertHorizontalRule'),\n                click: _this.context.createInvokeHandler('editor.insertHorizontalRule')\n            }).render();\n        });\n        this.context.memo('button.fullscreen', function () {\n            return _this.button({\n                className: 'btn-fullscreen',\n                contents: _this.ui.icon(_this.options.icons.arrowsAlt),\n                tooltip: _this.options.fullscreen,\n                click: _this.context.createInvokeHandler('fullscreen.toggle')\n            }).render();\n        });\n        this.context.memo('button.codeview', function () {\n            return _this.button({\n                className: 'btn-codeview',\n                contents: _this.ui.icon(_this.options.icons.code),\n                tooltip: _this.options.codeview,\n                click: _this.context.createInvokeHandler('codeview.toggle')\n            }).render();\n        });\n        this.context.memo('button.redo', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.redo),\n                tooltip: _this.lang.history.redo + _this.representShortcut('redo'),\n                click: _this.context.createInvokeHandler('editor.redo')\n            }).render();\n        });\n        this.context.memo('button.undo', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.undo),\n                tooltip: _this.lang.history.undo + _this.representShortcut('undo'),\n                click: _this.context.createInvokeHandler('editor.undo')\n            }).render();\n        });\n        this.context.memo('button.help', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.question),\n                tooltip: _this.options.help,\n                click: _this.context.createInvokeHandler('helpDialog.show')\n            }).render();\n        });\n    };\n    /**\n     * image : [\n     *   ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n     *   ['float', ['floatLeft', 'floatRight', 'floatNone' ]],\n     *   ['remove', ['removeMedia']]\n     * ],\n     */\n    Buttons.prototype.addImagePopoverButtons = function () {\n        var _this = this;\n        // Image Size Buttons\n        this.context.memo('button.imageSize100', function () {\n            return _this.button({\n                contents: '<span class=\"note-fontsize-10\">100%</span>',\n                tooltip: _this.lang.image.resizeFull,\n                click: _this.context.createInvokeHandler('editor.resize', '1')\n            }).render();\n        });\n        this.context.memo('button.imageSize50', function () {\n            return _this.button({\n                contents: '<span class=\"note-fontsize-10\">50%</span>',\n                tooltip: _this.lang.image.resizeHalf,\n                click: _this.context.createInvokeHandler('editor.resize', '0.5')\n            }).render();\n        });\n        this.context.memo('button.imageSize25', function () {\n            return _this.button({\n                contents: '<span class=\"note-fontsize-10\">25%</span>',\n                tooltip: _this.lang.image.resizeQuarter,\n                click: _this.context.createInvokeHandler('editor.resize', '0.25')\n            }).render();\n        });\n        // Float Buttons\n        this.context.memo('button.floatLeft', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.alignLeft),\n                tooltip: _this.lang.image.floatLeft,\n                click: _this.context.createInvokeHandler('editor.floatMe', 'left')\n            }).render();\n        });\n        this.context.memo('button.floatRight', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.alignRight),\n                tooltip: _this.lang.image.floatRight,\n                click: _this.context.createInvokeHandler('editor.floatMe', 'right')\n            }).render();\n        });\n        this.context.memo('button.floatNone', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.alignJustify),\n                tooltip: _this.lang.image.floatNone,\n                click: _this.context.createInvokeHandler('editor.floatMe', 'none')\n            }).render();\n        });\n        // Remove Buttons\n        this.context.memo('button.removeMedia', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.trash),\n                tooltip: _this.lang.image.remove,\n                click: _this.context.createInvokeHandler('editor.removeMedia')\n            }).render();\n        });\n    };\n    Buttons.prototype.addLinkPopoverButtons = function () {\n        var _this = this;\n        this.context.memo('button.linkDialogShow', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.link),\n                tooltip: _this.lang.link.edit,\n                click: _this.context.createInvokeHandler('linkDialog.show')\n            }).render();\n        });\n        this.context.memo('button.unlink', function () {\n            return _this.button({\n                contents: _this.ui.icon(_this.options.icons.unlink),\n                tooltip: _this.lang.link.unlink,\n                click: _this.context.createInvokeHandler('editor.unlink')\n            }).render();\n        });\n    };\n    /**\n     * table : [\n     *  ['add', ['addRowDown', 'addRowUp', 'addColLeft', 'addColRight']],\n     *  ['delete', ['deleteRow', 'deleteCol', 'deleteTable']]\n     * ],\n     */\n    Buttons.prototype.addTablePopoverButtons = function () {\n        var _this = this;\n        this.context.memo('button.addRowUp', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.rowAbove),\n                tooltip: _this.lang.table.addRowAbove,\n                click: _this.context.createInvokeHandler('editor.addRow', 'top')\n            }).render();\n        });\n        this.context.memo('button.addRowDown', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.rowBelow),\n                tooltip: _this.lang.table.addRowBelow,\n                click: _this.context.createInvokeHandler('editor.addRow', 'bottom')\n            }).render();\n        });\n        this.context.memo('button.addColLeft', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.colBefore),\n                tooltip: _this.lang.table.addColLeft,\n                click: _this.context.createInvokeHandler('editor.addCol', 'left')\n            }).render();\n        });\n        this.context.memo('button.addColRight', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.colAfter),\n                tooltip: _this.lang.table.addColRight,\n                click: _this.context.createInvokeHandler('editor.addCol', 'right')\n            }).render();\n        });\n        this.context.memo('button.deleteRow', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.rowRemove),\n                tooltip: _this.lang.table.delRow,\n                click: _this.context.createInvokeHandler('editor.deleteRow')\n            }).render();\n        });\n        this.context.memo('button.deleteCol', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.colRemove),\n                tooltip: _this.lang.table.delCol,\n                click: _this.context.createInvokeHandler('editor.deleteCol')\n            }).render();\n        });\n        this.context.memo('button.deleteTable', function () {\n            return _this.button({\n                className: 'btn-md',\n                contents: _this.ui.icon(_this.options.icons.trash),\n                tooltip: _this.lang.table.delTable,\n                click: _this.context.createInvokeHandler('editor.deleteTable')\n            }).render();\n        });\n    };\n    Buttons.prototype.build = function ($container, groups) {\n        for (var groupIdx = 0, groupLen = groups.length; groupIdx < groupLen; groupIdx++) {\n            var group = groups[groupIdx];\n            var groupName = $$1.isArray(group) ? group[0] : group;\n            var buttons = $$1.isArray(group) ? ((group.length === 1) ? [group[0]] : group[1]) : [group];\n            var $group = this.ui.buttonGroup({\n                className: 'note-' + groupName\n            }).render();\n            for (var idx = 0, len = buttons.length; idx < len; idx++) {\n                var btn = this.context.memo('button.' + buttons[idx]);\n                if (btn) {\n                    $group.append(typeof btn === 'function' ? btn(this.context) : btn);\n                }\n            }\n            $group.appendTo($container);\n        }\n    };\n    /**\n     * @param {jQuery} [$container]\n     */\n    Buttons.prototype.updateCurrentStyle = function ($container) {\n        var _this = this;\n        var $cont = $container || this.$toolbar;\n        var styleInfo = this.context.invoke('editor.currentStyle');\n        this.updateBtnStates($cont, {\n            '.note-btn-bold': function () {\n                return styleInfo['font-bold'] === 'bold';\n            },\n            '.note-btn-italic': function () {\n                return styleInfo['font-italic'] === 'italic';\n            },\n            '.note-btn-underline': function () {\n                return styleInfo['font-underline'] === 'underline';\n            },\n            '.note-btn-subscript': function () {\n                return styleInfo['font-subscript'] === 'subscript';\n            },\n            '.note-btn-superscript': function () {\n                return styleInfo['font-superscript'] === 'superscript';\n            },\n            '.note-btn-strikethrough': function () {\n                return styleInfo['font-strikethrough'] === 'strikethrough';\n            }\n        });\n        if (styleInfo['font-family']) {\n            var fontNames = styleInfo['font-family'].split(',').map(function (name) {\n                return name.replace(/[\\'\\\"]/g, '')\n                    .replace(/\\s+$/, '')\n                    .replace(/^\\s+/, '');\n            });\n            var fontName_1 = lists.find(fontNames, this.isFontInstalled.bind(this));\n            $cont.find('.dropdown-fontname a').each(function (idx, item) {\n                var $item = $$1(item);\n                // always compare string to avoid creating another func.\n                var isChecked = ($item.data('value') + '') === (fontName_1 + '');\n                $item.toggleClass('checked', isChecked);\n            });\n            $cont.find('.note-current-fontname').text(fontName_1).css('font-family', fontName_1);\n        }\n        if (styleInfo['font-size']) {\n            var fontSize_1 = styleInfo['font-size'];\n            $cont.find('.dropdown-fontsize a').each(function (idx, item) {\n                var $item = $$1(item);\n                // always compare with string to avoid creating another func.\n                var isChecked = ($item.data('value') + '') === (fontSize_1 + '');\n                $item.toggleClass('checked', isChecked);\n            });\n            $cont.find('.note-current-fontsize').text(fontSize_1);\n        }\n        if (styleInfo['line-height']) {\n            var lineHeight_1 = styleInfo['line-height'];\n            $cont.find('.dropdown-line-height li a').each(function (idx, item) {\n                // always compare with string to avoid creating another func.\n                var isChecked = ($$1(item).data('value') + '') === (lineHeight_1 + '');\n                _this.className = isChecked ? 'checked' : '';\n            });\n        }\n    };\n    Buttons.prototype.updateBtnStates = function ($container, infos) {\n        var _this = this;\n        $$1.each(infos, function (selector, pred) {\n            _this.ui.toggleBtnActive($container.find(selector), pred());\n        });\n    };\n    Buttons.prototype.tableMoveHandler = function (event) {\n        var PX_PER_EM = 18;\n        var $picker = $$1(event.target.parentNode); // target is mousecatcher\n        var $dimensionDisplay = $picker.next();\n        var $catcher = $picker.find('.note-dimension-picker-mousecatcher');\n        var $highlighted = $picker.find('.note-dimension-picker-highlighted');\n        var $unhighlighted = $picker.find('.note-dimension-picker-unhighlighted');\n        var posOffset;\n        // HTML5 with jQuery - e.offsetX is undefined in Firefox\n        if (event.offsetX === undefined) {\n            var posCatcher = $$1(event.target).offset();\n            posOffset = {\n                x: event.pageX - posCatcher.left,\n                y: event.pageY - posCatcher.top\n            };\n        }\n        else {\n            posOffset = {\n                x: event.offsetX,\n                y: event.offsetY\n            };\n        }\n        var dim = {\n            c: Math.ceil(posOffset.x / PX_PER_EM) || 1,\n            r: Math.ceil(posOffset.y / PX_PER_EM) || 1\n        };\n        $highlighted.css({ width: dim.c + 'em', height: dim.r + 'em' });\n        $catcher.data('value', dim.c + 'x' + dim.r);\n        if (dim.c > 3 && dim.c < this.options.insertTableMaxSize.col) {\n            $unhighlighted.css({ width: dim.c + 1 + 'em' });\n        }\n        if (dim.r > 3 && dim.r < this.options.insertTableMaxSize.row) {\n            $unhighlighted.css({ height: dim.r + 1 + 'em' });\n        }\n        $dimensionDisplay.html(dim.c + ' x ' + dim.r);\n    };\n    return Buttons;\n}());\n\nvar Toolbar = /** @class */ (function () {\n    function Toolbar(context) {\n        this.context = context;\n        this.$window = $$1(window);\n        this.$document = $$1(document);\n        this.ui = $$1.summernote.ui;\n        this.$note = context.layoutInfo.note;\n        this.$editor = context.layoutInfo.editor;\n        this.$toolbar = context.layoutInfo.toolbar;\n        this.options = context.options;\n        this.followScroll = this.followScroll.bind(this);\n    }\n    Toolbar.prototype.shouldInitialize = function () {\n        return !this.options.airMode;\n    };\n    Toolbar.prototype.initialize = function () {\n        var _this = this;\n        this.options.toolbar = this.options.toolbar || [];\n        if (!this.options.toolbar.length) {\n            this.$toolbar.hide();\n        }\n        else {\n            this.context.invoke('buttons.build', this.$toolbar, this.options.toolbar);\n        }\n        if (this.options.toolbarContainer) {\n            this.$toolbar.appendTo(this.options.toolbarContainer);\n        }\n        this.changeContainer(false);\n        this.$note.on('summernote.keyup summernote.mouseup summernote.change', function () {\n            _this.context.invoke('buttons.updateCurrentStyle');\n        });\n        this.context.invoke('buttons.updateCurrentStyle');\n        if (this.options.followingToolbar) {\n            this.$window.on('scroll resize', this.followScroll);\n        }\n    };\n    Toolbar.prototype.destroy = function () {\n        this.$toolbar.children().remove();\n        if (this.options.followingToolbar) {\n            this.$window.off('scroll resize', this.followScroll);\n        }\n    };\n    Toolbar.prototype.followScroll = function () {\n        if (this.$editor.hasClass('fullscreen')) {\n            return false;\n        }\n        var $toolbarWrapper = this.$toolbar.parent('.note-toolbar-wrapper');\n        var editorHeight = this.$editor.outerHeight();\n        var editorWidth = this.$editor.width();\n        var toolbarHeight = this.$toolbar.height();\n        $toolbarWrapper.css({\n            height: toolbarHeight\n        });\n        // check if the web app is currently using another static bar\n        var otherBarHeight = 0;\n        if (this.options.otherStaticBar) {\n            otherBarHeight = $$1(this.options.otherStaticBar).outerHeight();\n        }\n        var currentOffset = this.$document.scrollTop();\n        var editorOffsetTop = this.$editor.offset().top;\n        var editorOffsetBottom = editorOffsetTop + editorHeight;\n        var activateOffset = editorOffsetTop - otherBarHeight;\n        var deactivateOffsetBottom = editorOffsetBottom - otherBarHeight - toolbarHeight;\n        if ((currentOffset > activateOffset) && (currentOffset < deactivateOffsetBottom)) {\n            this.$toolbar.css({\n                position: 'fixed',\n                top: otherBarHeight,\n                width: editorWidth\n            });\n        }\n        else {\n            this.$toolbar.css({\n                position: 'relative',\n                top: 0,\n                width: '100%'\n            });\n        }\n    };\n    Toolbar.prototype.changeContainer = function (isFullscreen) {\n        if (isFullscreen) {\n            this.$toolbar.prependTo(this.$editor);\n        }\n        else {\n            if (this.options.toolbarContainer) {\n                this.$toolbar.appendTo(this.options.toolbarContainer);\n            }\n        }\n    };\n    Toolbar.prototype.updateFullscreen = function (isFullscreen) {\n        this.ui.toggleBtnActive(this.$toolbar.find('.btn-fullscreen'), isFullscreen);\n        this.changeContainer(isFullscreen);\n    };\n    Toolbar.prototype.updateCodeview = function (isCodeview) {\n        this.ui.toggleBtnActive(this.$toolbar.find('.btn-codeview'), isCodeview);\n        if (isCodeview) {\n            this.deactivate();\n        }\n        else {\n            this.activate();\n        }\n    };\n    Toolbar.prototype.activate = function (isIncludeCodeview) {\n        var $btn = this.$toolbar.find('button');\n        if (!isIncludeCodeview) {\n            $btn = $btn.not('.btn-codeview');\n        }\n        this.ui.toggleBtn($btn, true);\n    };\n    Toolbar.prototype.deactivate = function (isIncludeCodeview) {\n        var $btn = this.$toolbar.find('button');\n        if (!isIncludeCodeview) {\n            $btn = $btn.not('.btn-codeview');\n        }\n        this.ui.toggleBtn($btn, false);\n    };\n    return Toolbar;\n}());\n\nvar LinkDialog = /** @class */ (function () {\n    function LinkDialog(context) {\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.$body = $$1(document.body);\n        this.$editor = context.layoutInfo.editor;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n        context.memo('help.linkDialog.show', this.options.langInfo.help['linkDialog.show']);\n    }\n    LinkDialog.prototype.initialize = function () {\n        var $container = this.options.dialogsInBody ? this.$body : this.$editor;\n        var body = [\n            '<div class=\"form-group note-form-group\">',\n            \"<label class=\\\"note-form-label\\\">\" + this.lang.link.textToDisplay + \"</label>\",\n            '<input class=\"note-link-text form-control note-form-control  note-input\" type=\"text\" />',\n            '</div>',\n            '<div class=\"form-group note-form-group\">',\n            \"<label class=\\\"note-form-label\\\">\" + this.lang.link.url + \"</label>\",\n            '<input class=\"note-link-url form-control note-form-control note-input\" type=\"text\" value=\"http://\" />',\n            '</div>',\n            !this.options.disableLinkTarget\n                ? $$1('<div/>').append(this.ui.checkbox({\n                    id: 'sn-checkbox-open-in-new-window',\n                    text: this.lang.link.openInNewWindow,\n                    checked: true\n                }).render()).html()\n                : ''\n        ].join('');\n        var buttonClass = 'btn btn-primary note-btn note-btn-primary note-link-btn';\n        var footer = \"<button type=\\\"submit\\\" href=\\\"#\\\" class=\\\"\" + buttonClass + \"\\\" disabled>\" + this.lang.link.insert + \"</button>\";\n        this.$dialog = this.ui.dialog({\n            className: 'link-dialog',\n            title: this.lang.link.insert,\n            fade: this.options.dialogsFade,\n            body: body,\n            footer: footer\n        }).render().appendTo($container);\n    };\n    LinkDialog.prototype.destroy = function () {\n        this.ui.hideDialog(this.$dialog);\n        this.$dialog.remove();\n    };\n    LinkDialog.prototype.bindEnterKey = function ($input, $btn) {\n        $input.on('keypress', function (event) {\n            if (event.keyCode === key.code.ENTER) {\n                event.preventDefault();\n                $btn.trigger('click');\n            }\n        });\n    };\n    /**\n     * toggle update button\n     */\n    LinkDialog.prototype.toggleLinkBtn = function ($linkBtn, $linkText, $linkUrl) {\n        this.ui.toggleBtn($linkBtn, $linkText.val() && $linkUrl.val());\n    };\n    /**\n     * Show link dialog and set event handlers on dialog controls.\n     *\n     * @param {Object} linkInfo\n     * @return {Promise}\n     */\n    LinkDialog.prototype.showLinkDialog = function (linkInfo) {\n        var _this = this;\n        return $$1.Deferred(function (deferred) {\n            var $linkText = _this.$dialog.find('.note-link-text');\n            var $linkUrl = _this.$dialog.find('.note-link-url');\n            var $linkBtn = _this.$dialog.find('.note-link-btn');\n            var $openInNewWindow = _this.$dialog.find('input[type=checkbox]');\n            _this.ui.onDialogShown(_this.$dialog, function () {\n                _this.context.triggerEvent('dialog.shown');\n                // if no url was given, copy text to url\n                if (!linkInfo.url) {\n                    linkInfo.url = linkInfo.text;\n                }\n                $linkText.val(linkInfo.text);\n                var handleLinkTextUpdate = function () {\n                    _this.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n                    // if linktext was modified by keyup,\n                    // stop cloning text from linkUrl\n                    linkInfo.text = $linkText.val();\n                };\n                $linkText.on('input', handleLinkTextUpdate).on('paste', function () {\n                    setTimeout(handleLinkTextUpdate, 0);\n                });\n                var handleLinkUrlUpdate = function () {\n                    _this.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n                    // display same link on `Text to display` input\n                    // when create a new link\n                    if (!linkInfo.text) {\n                        $linkText.val($linkUrl.val());\n                    }\n                };\n                $linkUrl.on('input', handleLinkUrlUpdate).on('paste', function () {\n                    setTimeout(handleLinkUrlUpdate, 0);\n                }).val(linkInfo.url);\n                if (!env.isSupportTouch) {\n                    $linkUrl.trigger('focus');\n                }\n                _this.toggleLinkBtn($linkBtn, $linkText, $linkUrl);\n                _this.bindEnterKey($linkUrl, $linkBtn);\n                _this.bindEnterKey($linkText, $linkBtn);\n                var isChecked = linkInfo.isNewWindow !== undefined\n                    ? linkInfo.isNewWindow : _this.context.options.linkTargetBlank;\n                $openInNewWindow.prop('checked', isChecked);\n                $linkBtn.one('click', function (event) {\n                    event.preventDefault();\n                    deferred.resolve({\n                        range: linkInfo.range,\n                        url: $linkUrl.val(),\n                        text: $linkText.val(),\n                        isNewWindow: $openInNewWindow.is(':checked')\n                    });\n                    _this.ui.hideDialog(_this.$dialog);\n                });\n            });\n            _this.ui.onDialogHidden(_this.$dialog, function () {\n                // detach events\n                $linkText.off('input paste keypress');\n                $linkUrl.off('input paste keypress');\n                $linkBtn.off('click');\n                if (deferred.state() === 'pending') {\n                    deferred.reject();\n                }\n            });\n            _this.ui.showDialog(_this.$dialog);\n        }).promise();\n    };\n    /**\n     * @param {Object} layoutInfo\n     */\n    LinkDialog.prototype.show = function () {\n        var _this = this;\n        var linkInfo = this.context.invoke('editor.getLinkInfo');\n        this.context.invoke('editor.saveRange');\n        this.showLinkDialog(linkInfo).then(function (linkInfo) {\n            _this.context.invoke('editor.restoreRange');\n            _this.context.invoke('editor.createLink', linkInfo);\n        }).fail(function () {\n            _this.context.invoke('editor.restoreRange');\n        });\n    };\n    return LinkDialog;\n}());\n\nvar LinkPopover = /** @class */ (function () {\n    function LinkPopover(context) {\n        var _this = this;\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.options = context.options;\n        this.events = {\n            'summernote.keyup summernote.mouseup summernote.change summernote.scroll': function () {\n                _this.update();\n            },\n            'summernote.disable summernote.dialog.shown': function () {\n                _this.hide();\n            }\n        };\n    }\n    LinkPopover.prototype.shouldInitialize = function () {\n        return !lists.isEmpty(this.options.popover.link);\n    };\n    LinkPopover.prototype.initialize = function () {\n        this.$popover = this.ui.popover({\n            className: 'note-link-popover',\n            callback: function ($node) {\n                var $content = $node.find('.popover-content,.note-popover-content');\n                $content.prepend('<span><a target=\"_blank\"></a>&nbsp;</span>');\n            }\n        }).render().appendTo(this.options.container);\n        var $content = this.$popover.find('.popover-content,.note-popover-content');\n        this.context.invoke('buttons.build', $content, this.options.popover.link);\n    };\n    LinkPopover.prototype.destroy = function () {\n        this.$popover.remove();\n    };\n    LinkPopover.prototype.update = function () {\n        // Prevent focusing on editable when invoke('code') is executed\n        if (!this.context.invoke('editor.hasFocus')) {\n            this.hide();\n            return;\n        }\n        var rng = this.context.invoke('editor.createRange');\n        if (rng.isCollapsed() && rng.isOnAnchor()) {\n            var anchor = dom.ancestor(rng.sc, dom.isAnchor);\n            var href = $$1(anchor).attr('href');\n            this.$popover.find('a').attr('href', href).html(href);\n            var pos = dom.posFromPlaceholder(anchor);\n            this.$popover.css({\n                display: 'block',\n                left: pos.left,\n                top: pos.top\n            });\n        }\n        else {\n            this.hide();\n        }\n    };\n    LinkPopover.prototype.hide = function () {\n        this.$popover.hide();\n    };\n    return LinkPopover;\n}());\n\nvar ImageDialog = /** @class */ (function () {\n    function ImageDialog(context) {\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.$body = $$1(document.body);\n        this.$editor = context.layoutInfo.editor;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n    }\n    ImageDialog.prototype.initialize = function () {\n        var $container = this.options.dialogsInBody ? this.$body : this.$editor;\n        var imageLimitation = '';\n        if (this.options.maximumImageFileSize) {\n            var unit = Math.floor(Math.log(this.options.maximumImageFileSize) / Math.log(1024));\n            var readableSize = (this.options.maximumImageFileSize / Math.pow(1024, unit)).toFixed(2) * 1 +\n                ' ' + ' KMGTP'[unit] + 'B';\n            imageLimitation = \"<small>\" + (this.lang.image.maximumFileSize + ' : ' + readableSize) + \"</small>\";\n        }\n        var body = [\n            '<div class=\"form-group note-form-group note-group-select-from-files\">',\n            '<label class=\"note-form-label\">' + this.lang.image.selectFromFiles + '</label>',\n            '<input class=\"note-image-input note-form-control note-input\" ',\n            ' type=\"file\" name=\"files\" accept=\"image/*\" multiple=\"multiple\" />',\n            imageLimitation,\n            '</div>',\n            '<div class=\"form-group note-group-image-url\" style=\"overflow:auto;\">',\n            '<label class=\"note-form-label\">' + this.lang.image.url + '</label>',\n            '<input class=\"note-image-url form-control note-form-control note-input ',\n            ' col-md-12\" type=\"text\" />',\n            '</div>'\n        ].join('');\n        var buttonClass = 'btn btn-primary note-btn note-btn-primary note-image-btn';\n        var footer = \"<button type=\\\"submit\\\" href=\\\"#\\\" class=\\\"\" + buttonClass + \"\\\" disabled>\" + this.lang.image.insert + \"</button>\";\n        this.$dialog = this.ui.dialog({\n            title: this.lang.image.insert,\n            fade: this.options.dialogsFade,\n            body: body,\n            footer: footer\n        }).render().appendTo($container);\n    };\n    ImageDialog.prototype.destroy = function () {\n        this.ui.hideDialog(this.$dialog);\n        this.$dialog.remove();\n    };\n    ImageDialog.prototype.bindEnterKey = function ($input, $btn) {\n        $input.on('keypress', function (event) {\n            if (event.keyCode === key.code.ENTER) {\n                event.preventDefault();\n                $btn.trigger('click');\n            }\n        });\n    };\n    ImageDialog.prototype.show = function () {\n        var _this = this;\n        this.context.invoke('editor.saveRange');\n        this.showImageDialog().then(function (data) {\n            // [workaround] hide dialog before restore range for IE range focus\n            _this.ui.hideDialog(_this.$dialog);\n            _this.context.invoke('editor.restoreRange');\n            if (typeof data === 'string') {\n                _this.context.invoke('editor.insertImage', data);\n            }\n            else {\n                _this.context.invoke('editor.insertImagesOrCallback', data);\n            }\n        }).fail(function () {\n            _this.context.invoke('editor.restoreRange');\n        });\n    };\n    /**\n     * show image dialog\n     *\n     * @param {jQuery} $dialog\n     * @return {Promise}\n     */\n    ImageDialog.prototype.showImageDialog = function () {\n        var _this = this;\n        return $$1.Deferred(function (deferred) {\n            var $imageInput = _this.$dialog.find('.note-image-input');\n            var $imageUrl = _this.$dialog.find('.note-image-url');\n            var $imageBtn = _this.$dialog.find('.note-image-btn');\n            _this.ui.onDialogShown(_this.$dialog, function () {\n                _this.context.triggerEvent('dialog.shown');\n                // Cloning imageInput to clear element.\n                $imageInput.replaceWith($imageInput.clone().on('change', function (event) {\n                    deferred.resolve(event.target.files || event.target.value);\n                }).val(''));\n                $imageBtn.click(function (event) {\n                    event.preventDefault();\n                    deferred.resolve($imageUrl.val());\n                });\n                $imageUrl.on('keyup paste', function () {\n                    var url = $imageUrl.val();\n                    _this.ui.toggleBtn($imageBtn, url);\n                }).val('');\n                if (!env.isSupportTouch) {\n                    $imageUrl.trigger('focus');\n                }\n                _this.bindEnterKey($imageUrl, $imageBtn);\n            });\n            _this.ui.onDialogHidden(_this.$dialog, function () {\n                $imageInput.off('change');\n                $imageUrl.off('keyup paste keypress');\n                $imageBtn.off('click');\n                if (deferred.state() === 'pending') {\n                    deferred.reject();\n                }\n            });\n            _this.ui.showDialog(_this.$dialog);\n        });\n    };\n    return ImageDialog;\n}());\n\n/**\n * Image popover module\n *  mouse events that show/hide popover will be handled by Handle.js.\n *  Handle.js will receive the events and invoke 'imagePopover.update'.\n */\nvar ImagePopover = /** @class */ (function () {\n    function ImagePopover(context) {\n        var _this = this;\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.editable = context.layoutInfo.editable[0];\n        this.options = context.options;\n        this.events = {\n            'summernote.disable': function () {\n                _this.hide();\n            }\n        };\n    }\n    ImagePopover.prototype.shouldInitialize = function () {\n        return !lists.isEmpty(this.options.popover.image);\n    };\n    ImagePopover.prototype.initialize = function () {\n        this.$popover = this.ui.popover({\n            className: 'note-image-popover'\n        }).render().appendTo(this.options.container);\n        var $content = this.$popover.find('.popover-content,.note-popover-content');\n        this.context.invoke('buttons.build', $content, this.options.popover.image);\n    };\n    ImagePopover.prototype.destroy = function () {\n        this.$popover.remove();\n    };\n    ImagePopover.prototype.update = function (target) {\n        if (dom.isImg(target)) {\n            var pos = dom.posFromPlaceholder(target);\n            var posEditor = dom.posFromPlaceholder(this.editable);\n            this.$popover.css({\n                display: 'block',\n                left: this.options.popatmouse ? event.pageX - 20 : pos.left,\n                top: this.options.popatmouse ? event.pageY : Math.min(pos.top, posEditor.top)\n            });\n        }\n        else {\n            this.hide();\n        }\n    };\n    ImagePopover.prototype.hide = function () {\n        this.$popover.hide();\n    };\n    return ImagePopover;\n}());\n\nvar TablePopover = /** @class */ (function () {\n    function TablePopover(context) {\n        var _this = this;\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.options = context.options;\n        this.events = {\n            'summernote.mousedown': function (we, e) {\n                _this.update(e.target);\n            },\n            'summernote.keyup summernote.scroll summernote.change': function () {\n                _this.update();\n            },\n            'summernote.disable': function () {\n                _this.hide();\n            }\n        };\n    }\n    TablePopover.prototype.shouldInitialize = function () {\n        return !lists.isEmpty(this.options.popover.table);\n    };\n    TablePopover.prototype.initialize = function () {\n        this.$popover = this.ui.popover({\n            className: 'note-table-popover'\n        }).render().appendTo(this.options.container);\n        var $content = this.$popover.find('.popover-content,.note-popover-content');\n        this.context.invoke('buttons.build', $content, this.options.popover.table);\n        // [workaround] Disable Firefox's default table editor\n        if (env.isFF) {\n            document.execCommand('enableInlineTableEditing', false, false);\n        }\n    };\n    TablePopover.prototype.destroy = function () {\n        this.$popover.remove();\n    };\n    TablePopover.prototype.update = function (target) {\n        if (this.context.isDisabled()) {\n            return false;\n        }\n        var isCell = dom.isCell(target);\n        if (isCell) {\n            var pos = dom.posFromPlaceholder(target);\n            this.$popover.css({\n                display: 'block',\n                left: pos.left,\n                top: pos.top\n            });\n        }\n        else {\n            this.hide();\n        }\n        return isCell;\n    };\n    TablePopover.prototype.hide = function () {\n        this.$popover.hide();\n    };\n    return TablePopover;\n}());\n\nvar VideoDialog = /** @class */ (function () {\n    function VideoDialog(context) {\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.$body = $$1(document.body);\n        this.$editor = context.layoutInfo.editor;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n    }\n    VideoDialog.prototype.initialize = function () {\n        var $container = this.options.dialogsInBody ? this.$body : this.$editor;\n        var body = [\n            '<div class=\"form-group note-form-group row-fluid\">',\n            \"<label class=\\\"note-form-label\\\">\" + this.lang.video.url + \" <small class=\\\"text-muted\\\">\" + this.lang.video.providers + \"</small></label>\",\n            '<input class=\"note-video-url form-control note-form-control note-input\" type=\"text\" />',\n            '</div>'\n        ].join('');\n        var buttonClass = 'btn btn-primary note-btn note-btn-primary note-video-btn';\n        var footer = \"<button type=\\\"submit\\\" href=\\\"#\\\" class=\\\"\" + buttonClass + \"\\\" disabled>\" + this.lang.video.insert + \"</button>\";\n        this.$dialog = this.ui.dialog({\n            title: this.lang.video.insert,\n            fade: this.options.dialogsFade,\n            body: body,\n            footer: footer\n        }).render().appendTo($container);\n    };\n    VideoDialog.prototype.destroy = function () {\n        this.ui.hideDialog(this.$dialog);\n        this.$dialog.remove();\n    };\n    VideoDialog.prototype.bindEnterKey = function ($input, $btn) {\n        $input.on('keypress', function (event) {\n            if (event.keyCode === key.code.ENTER) {\n                event.preventDefault();\n                $btn.trigger('click');\n            }\n        });\n    };\n    VideoDialog.prototype.createVideoNode = function (url) {\n        // video url patterns(youtube, instagram, vimeo, dailymotion, youku, mp4, ogg, webm)\n        var ytRegExp = /^(?:https?:\\/\\/)?(?:www\\.)?(?:youtu\\.be\\/|youtube\\.com\\/(?:embed\\/|v\\/|watch\\?v=|watch\\?.+&v=))((\\w|-){11})(?:\\S+)?$/;\n        var ytMatch = url.match(ytRegExp);\n        var igRegExp = /(?:www\\.|\\/\\/)instagram\\.com\\/p\\/(.[a-zA-Z0-9_-]*)/;\n        var igMatch = url.match(igRegExp);\n        var vRegExp = /\\/\\/vine\\.co\\/v\\/([a-zA-Z0-9]+)/;\n        var vMatch = url.match(vRegExp);\n        var vimRegExp = /\\/\\/(player\\.)?vimeo\\.com\\/([a-z]*\\/)*(\\d+)[?]?.*/;\n        var vimMatch = url.match(vimRegExp);\n        var dmRegExp = /.+dailymotion.com\\/(video|hub)\\/([^_]+)[^#]*(#video=([^_&]+))?/;\n        var dmMatch = url.match(dmRegExp);\n        var youkuRegExp = /\\/\\/v\\.youku\\.com\\/v_show\\/id_(\\w+)=*\\.html/;\n        var youkuMatch = url.match(youkuRegExp);\n        var qqRegExp = /\\/\\/v\\.qq\\.com.*?vid=(.+)/;\n        var qqMatch = url.match(qqRegExp);\n        var qqRegExp2 = /\\/\\/v\\.qq\\.com\\/x?\\/?(page|cover).*?\\/([^\\/]+)\\.html\\??.*/;\n        var qqMatch2 = url.match(qqRegExp2);\n        var mp4RegExp = /^.+.(mp4|m4v)$/;\n        var mp4Match = url.match(mp4RegExp);\n        var oggRegExp = /^.+.(ogg|ogv)$/;\n        var oggMatch = url.match(oggRegExp);\n        var webmRegExp = /^.+.(webm)$/;\n        var webmMatch = url.match(webmRegExp);\n        var $video;\n        if (ytMatch && ytMatch[1].length === 11) {\n            var youtubeId = ytMatch[1];\n            $video = $$1('<iframe>')\n                .attr('frameborder', 0)\n                .attr('src', '//www.youtube.com/embed/' + youtubeId)\n                .attr('width', '640').attr('height', '360');\n        }\n        else if (igMatch && igMatch[0].length) {\n            $video = $$1('<iframe>')\n                .attr('frameborder', 0)\n                .attr('src', 'https://instagram.com/p/' + igMatch[1] + '/embed/')\n                .attr('width', '612').attr('height', '710')\n                .attr('scrolling', 'no')\n                .attr('allowtransparency', 'true');\n        }\n        else if (vMatch && vMatch[0].length) {\n            $video = $$1('<iframe>')\n                .attr('frameborder', 0)\n                .attr('src', vMatch[0] + '/embed/simple')\n                .attr('width', '600').attr('height', '600')\n                .attr('class', 'vine-embed');\n        }\n        else if (vimMatch && vimMatch[3].length) {\n            $video = $$1('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>')\n                .attr('frameborder', 0)\n                .attr('src', '//player.vimeo.com/video/' + vimMatch[3])\n                .attr('width', '640').attr('height', '360');\n        }\n        else if (dmMatch && dmMatch[2].length) {\n            $video = $$1('<iframe>')\n                .attr('frameborder', 0)\n                .attr('src', '//www.dailymotion.com/embed/video/' + dmMatch[2])\n                .attr('width', '640').attr('height', '360');\n        }\n        else if (youkuMatch && youkuMatch[1].length) {\n            $video = $$1('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>')\n                .attr('frameborder', 0)\n                .attr('height', '498')\n                .attr('width', '510')\n                .attr('src', '//player.youku.com/embed/' + youkuMatch[1]);\n        }\n        else if ((qqMatch && qqMatch[1].length) || (qqMatch2 && qqMatch2[2].length)) {\n            var vid = ((qqMatch && qqMatch[1].length) ? qqMatch[1] : qqMatch2[2]);\n            $video = $$1('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>')\n                .attr('frameborder', 0)\n                .attr('height', '310')\n                .attr('width', '500')\n                .attr('src', 'http://v.qq.com/iframe/player.html?vid=' + vid + '&amp;auto=0');\n        }\n        else if (mp4Match || oggMatch || webmMatch) {\n            $video = $$1('<video controls>')\n                .attr('src', url)\n                .attr('width', '640').attr('height', '360');\n        }\n        else {\n            // this is not a known video link. Now what, Cat? Now what?\n            return false;\n        }\n        $video.addClass('note-video-clip');\n        return $video[0];\n    };\n    VideoDialog.prototype.show = function () {\n        var _this = this;\n        var text = this.context.invoke('editor.getSelectedText');\n        this.context.invoke('editor.saveRange');\n        this.showVideoDialog(text).then(function (url) {\n            // [workaround] hide dialog before restore range for IE range focus\n            _this.ui.hideDialog(_this.$dialog);\n            _this.context.invoke('editor.restoreRange');\n            // build node\n            var $node = _this.createVideoNode(url);\n            if ($node) {\n                // insert video node\n                _this.context.invoke('editor.insertNode', $node);\n            }\n        }).fail(function () {\n            _this.context.invoke('editor.restoreRange');\n        });\n    };\n    /**\n     * show image dialog\n     *\n     * @param {jQuery} $dialog\n     * @return {Promise}\n     */\n    VideoDialog.prototype.showVideoDialog = function (text) {\n        var _this = this;\n        return $$1.Deferred(function (deferred) {\n            var $videoUrl = _this.$dialog.find('.note-video-url');\n            var $videoBtn = _this.$dialog.find('.note-video-btn');\n            _this.ui.onDialogShown(_this.$dialog, function () {\n                _this.context.triggerEvent('dialog.shown');\n                $videoUrl.val(text).on('input', function () {\n                    _this.ui.toggleBtn($videoBtn, $videoUrl.val());\n                });\n                if (!env.isSupportTouch) {\n                    $videoUrl.trigger('focus');\n                }\n                $videoBtn.click(function (event) {\n                    event.preventDefault();\n                    deferred.resolve($videoUrl.val());\n                });\n                _this.bindEnterKey($videoUrl, $videoBtn);\n            });\n            _this.ui.onDialogHidden(_this.$dialog, function () {\n                $videoUrl.off('input');\n                $videoBtn.off('click');\n                if (deferred.state() === 'pending') {\n                    deferred.reject();\n                }\n            });\n            _this.ui.showDialog(_this.$dialog);\n        });\n    };\n    return VideoDialog;\n}());\n\nvar HelpDialog = /** @class */ (function () {\n    function HelpDialog(context) {\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.$body = $$1(document.body);\n        this.$editor = context.layoutInfo.editor;\n        this.options = context.options;\n        this.lang = this.options.langInfo;\n    }\n    HelpDialog.prototype.initialize = function () {\n        var $container = this.options.dialogsInBody ? this.$body : this.$editor;\n        var body = [\n            '<p class=\"text-center\">',\n            '<a href=\"http://summernote.org/\" target=\"_blank\">Summernote 0.8.9</a>  ',\n            '<a href=\"https://github.com/summernote/summernote\" target=\"_blank\">Project</a>  ',\n            '<a href=\"https://github.com/summernote/summernote/issues\" target=\"_blank\">Issues</a>',\n            '</p>'\n        ].join('');\n        this.$dialog = this.ui.dialog({\n            title: this.lang.options.help,\n            fade: this.options.dialogsFade,\n            body: this.createShortcutList(),\n            footer: body,\n            callback: function ($node) {\n                $node.find('.modal-body,.note-modal-body').css({\n                    'max-height': 300,\n                    'overflow': 'scroll'\n                });\n            }\n        }).render().appendTo($container);\n    };\n    HelpDialog.prototype.destroy = function () {\n        this.ui.hideDialog(this.$dialog);\n        this.$dialog.remove();\n    };\n    HelpDialog.prototype.createShortcutList = function () {\n        var _this = this;\n        var keyMap = this.options.keyMap[env.isMac ? 'mac' : 'pc'];\n        return Object.keys(keyMap).map(function (key) {\n            var command = keyMap[key];\n            var $row = $$1('<div><div class=\"help-list-item\"/></div>');\n            $row.append($$1('<label><kbd>' + key + '</kdb></label>').css({\n                'width': 180,\n                'margin-right': 10\n            })).append($$1('<span/>').html(_this.context.memo('help.' + command) || command));\n            return $row.html();\n        }).join('');\n    };\n    /**\n     * show help dialog\n     *\n     * @return {Promise}\n     */\n    HelpDialog.prototype.showHelpDialog = function () {\n        var _this = this;\n        return $$1.Deferred(function (deferred) {\n            _this.ui.onDialogShown(_this.$dialog, function () {\n                _this.context.triggerEvent('dialog.shown');\n                deferred.resolve();\n            });\n            _this.ui.showDialog(_this.$dialog);\n        }).promise();\n    };\n    HelpDialog.prototype.show = function () {\n        var _this = this;\n        this.context.invoke('editor.saveRange');\n        this.showHelpDialog().then(function () {\n            _this.context.invoke('editor.restoreRange');\n        });\n    };\n    return HelpDialog;\n}());\n\nvar AIR_MODE_POPOVER_X_OFFSET = 20;\nvar AirPopover = /** @class */ (function () {\n    function AirPopover(context) {\n        var _this = this;\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.options = context.options;\n        this.events = {\n            'summernote.keyup summernote.mouseup summernote.scroll': function () {\n                _this.update();\n            },\n            'summernote.disable summernote.change summernote.dialog.shown': function () {\n                _this.hide();\n            },\n            'summernote.focusout': function (we, e) {\n                // [workaround] Firefox doesn't support relatedTarget on focusout\n                //  - Ignore hide action on focus out in FF.\n                if (env.isFF) {\n                    return;\n                }\n                if (!e.relatedTarget || !dom.ancestor(e.relatedTarget, func.eq(_this.$popover[0]))) {\n                    _this.hide();\n                }\n            }\n        };\n    }\n    AirPopover.prototype.shouldInitialize = function () {\n        return this.options.airMode && !lists.isEmpty(this.options.popover.air);\n    };\n    AirPopover.prototype.initialize = function () {\n        this.$popover = this.ui.popover({\n            className: 'note-air-popover'\n        }).render().appendTo(this.options.container);\n        var $content = this.$popover.find('.popover-content');\n        this.context.invoke('buttons.build', $content, this.options.popover.air);\n    };\n    AirPopover.prototype.destroy = function () {\n        this.$popover.remove();\n    };\n    AirPopover.prototype.update = function () {\n        var styleInfo = this.context.invoke('editor.currentStyle');\n        if (styleInfo.range && !styleInfo.range.isCollapsed()) {\n            var rect = lists.last(styleInfo.range.getClientRects());\n            if (rect) {\n                var bnd = func.rect2bnd(rect);\n                this.$popover.css({\n                    display: 'block',\n                    left: Math.max(bnd.left + bnd.width / 2, 0) - AIR_MODE_POPOVER_X_OFFSET,\n                    top: bnd.top + bnd.height\n                });\n                this.context.invoke('buttons.updateCurrentStyle', this.$popover);\n            }\n        }\n        else {\n            this.hide();\n        }\n    };\n    AirPopover.prototype.hide = function () {\n        this.$popover.hide();\n    };\n    return AirPopover;\n}());\n\nvar POPOVER_DIST = 5;\nvar HintPopover = /** @class */ (function () {\n    function HintPopover(context) {\n        var _this = this;\n        this.context = context;\n        this.ui = $$1.summernote.ui;\n        this.$editable = context.layoutInfo.editable;\n        this.options = context.options;\n        this.hint = this.options.hint || [];\n        this.direction = this.options.hintDirection || 'bottom';\n        this.hints = $$1.isArray(this.hint) ? this.hint : [this.hint];\n        this.events = {\n            'summernote.keyup': function (we, e) {\n                if (!e.isDefaultPrevented()) {\n                    _this.handleKeyup(e);\n                }\n            },\n            'summernote.keydown': function (we, e) {\n                _this.handleKeydown(e);\n            },\n            'summernote.disable summernote.dialog.shown': function () {\n                _this.hide();\n            }\n        };\n    }\n    HintPopover.prototype.shouldInitialize = function () {\n        return this.hints.length > 0;\n    };\n    HintPopover.prototype.initialize = function () {\n        var _this = this;\n        this.lastWordRange = null;\n        this.$popover = this.ui.popover({\n            className: 'note-hint-popover',\n            hideArrow: true,\n            direction: ''\n        }).render().appendTo(this.options.container);\n        this.$popover.hide();\n        this.$content = this.$popover.find('.popover-content,.note-popover-content');\n        this.$content.on('click', '.note-hint-item', function () {\n            _this.$content.find('.active').removeClass('active');\n            $$1(_this).addClass('active');\n            _this.replace();\n        });\n    };\n    HintPopover.prototype.destroy = function () {\n        this.$popover.remove();\n    };\n    HintPopover.prototype.selectItem = function ($item) {\n        this.$content.find('.active').removeClass('active');\n        $item.addClass('active');\n        this.$content[0].scrollTop = $item[0].offsetTop - (this.$content.innerHeight() / 2);\n    };\n    HintPopover.prototype.moveDown = function () {\n        var $current = this.$content.find('.note-hint-item.active');\n        var $next = $current.next();\n        if ($next.length) {\n            this.selectItem($next);\n        }\n        else {\n            var $nextGroup = $current.parent().next();\n            if (!$nextGroup.length) {\n                $nextGroup = this.$content.find('.note-hint-group').first();\n            }\n            this.selectItem($nextGroup.find('.note-hint-item').first());\n        }\n    };\n    HintPopover.prototype.moveUp = function () {\n        var $current = this.$content.find('.note-hint-item.active');\n        var $prev = $current.prev();\n        if ($prev.length) {\n            this.selectItem($prev);\n        }\n        else {\n            var $prevGroup = $current.parent().prev();\n            if (!$prevGroup.length) {\n                $prevGroup = this.$content.find('.note-hint-group').last();\n            }\n            this.selectItem($prevGroup.find('.note-hint-item').last());\n        }\n    };\n    HintPopover.prototype.replace = function () {\n        var $item = this.$content.find('.note-hint-item.active');\n        if ($item.length) {\n            var node = this.nodeFromItem($item);\n            // XXX: consider to move codes to editor for recording redo/undo.\n            this.lastWordRange.insertNode(node);\n            range.createFromNode(node).collapse().select();\n            this.lastWordRange = null;\n            this.hide();\n            this.context.triggerEvent('change', this.$editable.html(), this.$editable[0]);\n            this.context.invoke('editor.focus');\n        }\n    };\n    HintPopover.prototype.nodeFromItem = function ($item) {\n        var hint = this.hints[$item.data('index')];\n        var item = $item.data('item');\n        var node = hint.content ? hint.content(item) : item;\n        if (typeof node === 'string') {\n            node = dom.createText(node);\n        }\n        return node;\n    };\n    HintPopover.prototype.createItemTemplates = function (hintIdx, items) {\n        var hint = this.hints[hintIdx];\n        return items.map(function (item, idx) {\n            var $item = $$1('<div class=\"note-hint-item\"/>');\n            $item.append(hint.template ? hint.template(item) : item + '');\n            $item.data({\n                'index': hintIdx,\n                'item': item\n            });\n            return $item;\n        });\n    };\n    HintPopover.prototype.handleKeydown = function (e) {\n        if (!this.$popover.is(':visible')) {\n            return;\n        }\n        if (e.keyCode === key.code.ENTER) {\n            e.preventDefault();\n            this.replace();\n        }\n        else if (e.keyCode === key.code.UP) {\n            e.preventDefault();\n            this.moveUp();\n        }\n        else if (e.keyCode === key.code.DOWN) {\n            e.preventDefault();\n            this.moveDown();\n        }\n    };\n    HintPopover.prototype.searchKeyword = function (index, keyword, callback) {\n        var hint = this.hints[index];\n        if (hint && hint.match.test(keyword) && hint.search) {\n            var matches = hint.match.exec(keyword);\n            hint.search(matches[1], callback);\n        }\n        else {\n            callback();\n        }\n    };\n    HintPopover.prototype.createGroup = function (idx, keyword) {\n        var _this = this;\n        var $group = $$1('<div class=\"note-hint-group note-hint-group-' + idx + '\"/>');\n        this.searchKeyword(idx, keyword, function (items) {\n            items = items || [];\n            if (items.length) {\n                $group.html(_this.createItemTemplates(idx, items));\n                _this.show();\n            }\n        });\n        return $group;\n    };\n    HintPopover.prototype.handleKeyup = function (e) {\n        var _this = this;\n        if (!lists.contains([key.code.ENTER, key.code.UP, key.code.DOWN], e.keyCode)) {\n            var wordRange = this.context.invoke('editor.createRange').getWordRange();\n            var keyword_1 = wordRange.toString();\n            if (this.hints.length && keyword_1) {\n                this.$content.empty();\n                var bnd = func.rect2bnd(lists.last(wordRange.getClientRects()));\n                if (bnd) {\n                    this.$popover.hide();\n                    this.lastWordRange = wordRange;\n                    this.hints.forEach(function (hint, idx) {\n                        if (hint.match.test(keyword_1)) {\n                            _this.createGroup(idx, keyword_1).appendTo(_this.$content);\n                        }\n                    });\n                    // select first .note-hint-item\n                    this.$content.find('.note-hint-item:first').addClass('active');\n                    // set position for popover after group is created\n                    if (this.direction === 'top') {\n                        this.$popover.css({\n                            left: bnd.left,\n                            top: bnd.top - this.$popover.outerHeight() - POPOVER_DIST\n                        });\n                    }\n                    else {\n                        this.$popover.css({\n                            left: bnd.left,\n                            top: bnd.top + bnd.height + POPOVER_DIST\n                        });\n                    }\n                }\n            }\n            else {\n                this.hide();\n            }\n        }\n    };\n    HintPopover.prototype.show = function () {\n        this.$popover.show();\n    };\n    HintPopover.prototype.hide = function () {\n        this.$popover.hide();\n    };\n    return HintPopover;\n}());\n\nvar Context = /** @class */ (function () {\n    /**\n     * @param {jQuery} $note\n     * @param {Object} options\n     */\n    function Context($note, options) {\n        this.ui = $$1.summernote.ui;\n        this.$note = $note;\n        this.memos = {};\n        this.modules = {};\n        this.layoutInfo = {};\n        this.options = options;\n        this.initialize();\n    }\n    /**\n     * create layout and initialize modules and other resources\n     */\n    Context.prototype.initialize = function () {\n        this.layoutInfo = this.ui.createLayout(this.$note, this.options);\n        this._initialize();\n        this.$note.hide();\n        return this;\n    };\n    /**\n     * destroy modules and other resources and remove layout\n     */\n    Context.prototype.destroy = function () {\n        this._destroy();\n        this.$note.removeData('summernote');\n        this.ui.removeLayout(this.$note, this.layoutInfo);\n    };\n    /**\n     * destory modules and other resources and initialize it again\n     */\n    Context.prototype.reset = function () {\n        var disabled = this.isDisabled();\n        this.code(dom.emptyPara);\n        this._destroy();\n        this._initialize();\n        if (disabled) {\n            this.disable();\n        }\n    };\n    Context.prototype._initialize = function () {\n        var _this = this;\n        // add optional buttons\n        var buttons = $$1.extend({}, this.options.buttons);\n        Object.keys(buttons).forEach(function (key) {\n            _this.memo('button.' + key, buttons[key]);\n        });\n        var modules = $$1.extend({}, this.options.modules, $$1.summernote.plugins || {});\n        // add and initialize modules\n        Object.keys(modules).forEach(function (key) {\n            _this.module(key, modules[key], true);\n        });\n        Object.keys(this.modules).forEach(function (key) {\n            _this.initializeModule(key);\n        });\n    };\n    Context.prototype._destroy = function () {\n        var _this = this;\n        // destroy modules with reversed order\n        Object.keys(this.modules).reverse().forEach(function (key) {\n            _this.removeModule(key);\n        });\n        Object.keys(this.memos).forEach(function (key) {\n            _this.removeMemo(key);\n        });\n        // trigger custom onDestroy callback\n        this.triggerEvent('destroy', this);\n    };\n    Context.prototype.code = function (html) {\n        var isActivated = this.invoke('codeview.isActivated');\n        if (html === undefined) {\n            this.invoke('codeview.sync');\n            return isActivated ? this.layoutInfo.codable.val() : this.layoutInfo.editable.html();\n        }\n        else {\n            if (isActivated) {\n                this.layoutInfo.codable.val(html);\n            }\n            else {\n                this.layoutInfo.editable.html(html);\n            }\n            this.$note.val(html);\n            this.triggerEvent('change', html);\n        }\n    };\n    Context.prototype.isDisabled = function () {\n        return this.layoutInfo.editable.attr('contenteditable') === 'false';\n    };\n    Context.prototype.enable = function () {\n        this.layoutInfo.editable.attr('contenteditable', true);\n        this.invoke('toolbar.activate', true);\n        this.triggerEvent('disable', false);\n    };\n    Context.prototype.disable = function () {\n        // close codeview if codeview is opend\n        if (this.invoke('codeview.isActivated')) {\n            this.invoke('codeview.deactivate');\n        }\n        this.layoutInfo.editable.attr('contenteditable', false);\n        this.invoke('toolbar.deactivate', true);\n        this.triggerEvent('disable', true);\n    };\n    Context.prototype.triggerEvent = function () {\n        var namespace = lists.head(arguments);\n        var args = lists.tail(lists.from(arguments));\n        var callback = this.options.callbacks[func.namespaceToCamel(namespace, 'on')];\n        if (callback) {\n            callback.apply(this.$note[0], args);\n        }\n        this.$note.trigger('summernote.' + namespace, args);\n    };\n    Context.prototype.initializeModule = function (key) {\n        var module = this.modules[key];\n        module.shouldInitialize = module.shouldInitialize || func.ok;\n        if (!module.shouldInitialize()) {\n            return;\n        }\n        // initialize module\n        if (module.initialize) {\n            module.initialize();\n        }\n        // attach events\n        if (module.events) {\n            dom.attachEvents(this.$note, module.events);\n        }\n    };\n    Context.prototype.module = function (key, ModuleClass, withoutIntialize) {\n        if (arguments.length === 1) {\n            return this.modules[key];\n        }\n        this.modules[key] = new ModuleClass(this);\n        if (!withoutIntialize) {\n            this.initializeModule(key);\n        }\n    };\n    Context.prototype.removeModule = function (key) {\n        var module = this.modules[key];\n        if (module.shouldInitialize()) {\n            if (module.events) {\n                dom.detachEvents(this.$note, module.events);\n            }\n            if (module.destroy) {\n                module.destroy();\n            }\n        }\n        delete this.modules[key];\n    };\n    Context.prototype.memo = function (key, obj) {\n        if (arguments.length === 1) {\n            return this.memos[key];\n        }\n        this.memos[key] = obj;\n    };\n    Context.prototype.removeMemo = function (key) {\n        if (this.memos[key] && this.memos[key].destroy) {\n            this.memos[key].destroy();\n        }\n        delete this.memos[key];\n    };\n    /**\n     * Some buttons need to change their visual style immediately once they get pressed\n     */\n    Context.prototype.createInvokeHandlerAndUpdateState = function (namespace, value) {\n        var _this = this;\n        return function (event) {\n            _this.createInvokeHandler(namespace, value)(event);\n            _this.invoke('buttons.updateCurrentStyle');\n        };\n    };\n    Context.prototype.createInvokeHandler = function (namespace, value) {\n        var _this = this;\n        return function (event) {\n            event.preventDefault();\n            var $target = $$1(event.target);\n            _this.invoke(namespace, value || $target.closest('[data-value]').data('value'), $target);\n        };\n    };\n    Context.prototype.invoke = function () {\n        var namespace = lists.head(arguments);\n        var args = lists.tail(lists.from(arguments));\n        var splits = namespace.split('.');\n        var hasSeparator = splits.length > 1;\n        var moduleName = hasSeparator && lists.head(splits);\n        var methodName = hasSeparator ? lists.last(splits) : lists.head(splits);\n        var module = this.modules[moduleName || 'editor'];\n        if (!moduleName && this[methodName]) {\n            return this[methodName].apply(this, args);\n        }\n        else if (module && module[methodName] && module.shouldInitialize()) {\n            return module[methodName].apply(module, args);\n        }\n    };\n    return Context;\n}());\n\n$$1.fn.extend({\n    /**\n     * Summernote API\n     *\n     * @param {Object|String}\n     * @return {this}\n     */\n    summernote: function () {\n        var type = $$1.type(lists.head(arguments));\n        var isExternalAPICalled = type === 'string';\n        var hasInitOptions = type === 'object';\n        var options = $$1.extend({}, $$1.summernote.options, hasInitOptions ? lists.head(arguments) : {});\n        // Update options\n        options.langInfo = $$1.extend(true, {}, $$1.summernote.lang['en-US'], $$1.summernote.lang[options.lang]);\n        options.icons = $$1.extend(true, {}, $$1.summernote.options.icons, options.icons);\n        options.tooltip = options.tooltip === 'auto' ? !env.isSupportTouch : options.tooltip;\n        this.each(function (idx, note) {\n            var $note = $$1(note);\n            if (!$note.data('summernote')) {\n                var context = new Context($note, options);\n                $note.data('summernote', context);\n                $note.data('summernote').triggerEvent('init', context.layoutInfo);\n            }\n        });\n        var $note = this.first();\n        if ($note.length) {\n            var context = $note.data('summernote');\n            if (isExternalAPICalled) {\n                return context.invoke.apply(context, lists.from(arguments));\n            }\n            else if (options.focus) {\n                context.invoke('editor.focus');\n            }\n        }\n        return this;\n    }\n});\n\n$$1.summernote = $$1.extend($$1.summernote, {\n    version: '0.8.9',\n    ui: ui,\n    dom: dom,\n    plugins: {},\n    options: {\n        modules: {\n            'editor': Editor,\n            'clipboard': Clipboard,\n            'dropzone': Dropzone,\n            'codeview': CodeView,\n            'statusbar': Statusbar,\n            'fullscreen': Fullscreen,\n            'handle': Handle,\n            // FIXME: HintPopover must be front of autolink\n            //  - Script error about range when Enter key is pressed on hint popover\n            'hintPopover': HintPopover,\n            'autoLink': AutoLink,\n            'autoSync': AutoSync,\n            'placeholder': Placeholder,\n            'buttons': Buttons,\n            'toolbar': Toolbar,\n            'linkDialog': LinkDialog,\n            'linkPopover': LinkPopover,\n            'imageDialog': ImageDialog,\n            'imagePopover': ImagePopover,\n            'tablePopover': TablePopover,\n            'videoDialog': VideoDialog,\n            'helpDialog': HelpDialog,\n            'airPopover': AirPopover\n        },\n        buttons: {},\n        lang: 'en-US',\n        followingToolbar: true,\n        otherStaticBar: '',\n        // toolbar\n        toolbar: [\n            ['style', ['style']],\n            ['font', ['bold', 'underline', 'clear']],\n            ['fontname', ['fontname']],\n            ['color', ['color']],\n            ['para', ['ul', 'ol', 'paragraph']],\n            ['table', ['table']],\n            ['insert', ['link', 'picture', 'video']],\n            ['view', ['fullscreen', 'codeview', 'help']]\n        ],\n        // popover\n        popatmouse: true,\n        popover: {\n            image: [\n                ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n                ['float', ['floatLeft', 'floatRight', 'floatNone']],\n                ['remove', ['removeMedia']]\n            ],\n            link: [\n                ['link', ['linkDialogShow', 'unlink']]\n            ],\n            table: [\n                ['add', ['addRowDown', 'addRowUp', 'addColLeft', 'addColRight']],\n                ['delete', ['deleteRow', 'deleteCol', 'deleteTable']]\n            ],\n            air: [\n                ['color', ['color']],\n                ['font', ['bold', 'underline', 'clear']],\n                ['para', ['ul', 'paragraph']],\n                ['table', ['table']],\n                ['insert', ['link', 'picture']]\n            ]\n        },\n        // air mode: inline editor\n        airMode: false,\n        width: null,\n        height: null,\n        linkTargetBlank: true,\n        focus: false,\n        tabSize: 4,\n        styleWithSpan: true,\n        shortcuts: true,\n        textareaAutoSync: true,\n        hintDirection: 'bottom',\n        tooltip: 'auto',\n        container: 'body',\n        maxTextLength: 0,\n        styleTags: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n        fontNames: [\n            'Arial', 'Arial Black', 'Comic Sans MS', 'Courier New',\n            'Helvetica Neue', 'Helvetica', 'Impact', 'Lucida Grande',\n            'Tahoma', 'Times New Roman', 'Verdana'\n        ],\n        fontSizes: ['8', '9', '10', '11', '12', '14', '18', '24', '36'],\n        // pallete colors(n x n)\n        colors: [\n            ['#000000', '#424242', '#636363', '#9C9C94', '#CEC6CE', '#EFEFEF', '#F7F7F7', '#FFFFFF'],\n            ['#FF0000', '#FF9C00', '#FFFF00', '#00FF00', '#00FFFF', '#0000FF', '#9C00FF', '#FF00FF'],\n            ['#F7C6CE', '#FFE7CE', '#FFEFC6', '#D6EFD6', '#CEDEE7', '#CEE7F7', '#D6D6E7', '#E7D6DE'],\n            ['#E79C9C', '#FFC69C', '#FFE79C', '#B5D6A5', '#A5C6CE', '#9CC6EF', '#B5A5D6', '#D6A5BD'],\n            ['#E76363', '#F7AD6B', '#FFD663', '#94BD7B', '#73A5AD', '#6BADDE', '#8C7BC6', '#C67BA5'],\n            ['#CE0000', '#E79439', '#EFC631', '#6BA54A', '#4A7B8C', '#3984C6', '#634AA5', '#A54A7B'],\n            ['#9C0000', '#B56308', '#BD9400', '#397B21', '#104A5A', '#085294', '#311873', '#731842'],\n            ['#630000', '#7B3900', '#846300', '#295218', '#083139', '#003163', '#21104A', '#4A1031']\n        ],\n        lineHeights: ['1.0', '1.2', '1.4', '1.5', '1.6', '1.8', '2.0', '3.0'],\n        tableClassName: 'table table-bordered',\n        insertTableMaxSize: {\n            col: 10,\n            row: 10\n        },\n        dialogsInBody: false,\n        dialogsFade: false,\n        maximumImageFileSize: null,\n        callbacks: {\n            onInit: null,\n            onFocus: null,\n            onBlur: null,\n            onBlurCodeview: null,\n            onEnter: null,\n            onKeyup: null,\n            onKeydown: null,\n            onImageUpload: null,\n            onImageUploadError: null\n        },\n        codemirror: {\n            mode: 'text/html',\n            htmlMode: true,\n            lineNumbers: true\n        },\n        keyMap: {\n            pc: {\n                'ENTER': 'insertParagraph',\n                'CTRL+Z': 'undo',\n                'CTRL+Y': 'redo',\n                'TAB': 'tab',\n                'SHIFT+TAB': 'untab',\n                'CTRL+B': 'bold',\n                'CTRL+I': 'italic',\n                'CTRL+U': 'underline',\n                'CTRL+SHIFT+S': 'strikethrough',\n                'CTRL+BACKSLASH': 'removeFormat',\n                'CTRL+SHIFT+L': 'justifyLeft',\n                'CTRL+SHIFT+E': 'justifyCenter',\n                'CTRL+SHIFT+R': 'justifyRight',\n                'CTRL+SHIFT+J': 'justifyFull',\n                'CTRL+SHIFT+NUM7': 'insertUnorderedList',\n                'CTRL+SHIFT+NUM8': 'insertOrderedList',\n                'CTRL+LEFTBRACKET': 'outdent',\n                'CTRL+RIGHTBRACKET': 'indent',\n                'CTRL+NUM0': 'formatPara',\n                'CTRL+NUM1': 'formatH1',\n                'CTRL+NUM2': 'formatH2',\n                'CTRL+NUM3': 'formatH3',\n                'CTRL+NUM4': 'formatH4',\n                'CTRL+NUM5': 'formatH5',\n                'CTRL+NUM6': 'formatH6',\n                'CTRL+ENTER': 'insertHorizontalRule',\n                'CTRL+K': 'linkDialog.show'\n            },\n            mac: {\n                'ENTER': 'insertParagraph',\n                'CMD+Z': 'undo',\n                'CMD+SHIFT+Z': 'redo',\n                'TAB': 'tab',\n                'SHIFT+TAB': 'untab',\n                'CMD+B': 'bold',\n                'CMD+I': 'italic',\n                'CMD+U': 'underline',\n                'CMD+SHIFT+S': 'strikethrough',\n                'CMD+BACKSLASH': 'removeFormat',\n                'CMD+SHIFT+L': 'justifyLeft',\n                'CMD+SHIFT+E': 'justifyCenter',\n                'CMD+SHIFT+R': 'justifyRight',\n                'CMD+SHIFT+J': 'justifyFull',\n                'CMD+SHIFT+NUM7': 'insertUnorderedList',\n                'CMD+SHIFT+NUM8': 'insertOrderedList',\n                'CMD+LEFTBRACKET': 'outdent',\n                'CMD+RIGHTBRACKET': 'indent',\n                'CMD+NUM0': 'formatPara',\n                'CMD+NUM1': 'formatH1',\n                'CMD+NUM2': 'formatH2',\n                'CMD+NUM3': 'formatH3',\n                'CMD+NUM4': 'formatH4',\n                'CMD+NUM5': 'formatH5',\n                'CMD+NUM6': 'formatH6',\n                'CMD+ENTER': 'insertHorizontalRule',\n                'CMD+K': 'linkDialog.show'\n            }\n        },\n        icons: {\n            'align': 'note-icon-align',\n            'alignCenter': 'note-icon-align-center',\n            'alignJustify': 'note-icon-align-justify',\n            'alignLeft': 'note-icon-align-left',\n            'alignRight': 'note-icon-align-right',\n            'rowBelow': 'note-icon-row-below',\n            'colBefore': 'note-icon-col-before',\n            'colAfter': 'note-icon-col-after',\n            'rowAbove': 'note-icon-row-above',\n            'rowRemove': 'note-icon-row-remove',\n            'colRemove': 'note-icon-col-remove',\n            'indent': 'note-icon-align-indent',\n            'outdent': 'note-icon-align-outdent',\n            'arrowsAlt': 'note-icon-arrows-alt',\n            'bold': 'note-icon-bold',\n            'caret': 'note-icon-caret',\n            'circle': 'note-icon-circle',\n            'close': 'note-icon-close',\n            'code': 'note-icon-code',\n            'eraser': 'note-icon-eraser',\n            'font': 'note-icon-font',\n            'frame': 'note-icon-frame',\n            'italic': 'note-icon-italic',\n            'link': 'note-icon-link',\n            'unlink': 'note-icon-chain-broken',\n            'magic': 'note-icon-magic',\n            'menuCheck': 'note-icon-menu-check',\n            'minus': 'note-icon-minus',\n            'orderedlist': 'note-icon-orderedlist',\n            'pencil': 'note-icon-pencil',\n            'picture': 'note-icon-picture',\n            'question': 'note-icon-question',\n            'redo': 'note-icon-redo',\n            'square': 'note-icon-square',\n            'strikethrough': 'note-icon-strikethrough',\n            'subscript': 'note-icon-subscript',\n            'superscript': 'note-icon-superscript',\n            'table': 'note-icon-table',\n            'textHeight': 'note-icon-text-height',\n            'trash': 'note-icon-trash',\n            'underline': 'note-icon-underline',\n            'undo': 'note-icon-undo',\n            'unorderedlist': 'note-icon-unorderedlist',\n            'video': 'note-icon-video'\n        }\n    }\n});\n\n})));\n//# sourceMappingURL=summernote.js.map\n"]}